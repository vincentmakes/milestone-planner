var au=e=>{throw TypeError(e)};var el=(e,t,n)=>t.has(e)||au("Cannot "+n);var W=(e,t,n)=>(el(e,t,"read from private field"),n?n.call(e):t.get(e)),pe=(e,t,n)=>t.has(e)?au("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),ie=(e,t,n,s)=>(el(e,t,"write to private field"),s?s.call(e,n):t.set(e,n),n),dt=(e,t,n)=>(el(e,t,"access private method"),n);var li=(e,t,n,s)=>({set _(r){ie(e,t,r,n)},get _(){return W(e,t,s)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();function $g(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _h={exports:{}},$o={},yh={exports:{}},me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kr=Symbol.for("react.element"),Eg=Symbol.for("react.portal"),Tg=Symbol.for("react.fragment"),Pg=Symbol.for("react.strict_mode"),Mg=Symbol.for("react.profiler"),Ig=Symbol.for("react.provider"),Lg=Symbol.for("react.context"),Ag=Symbol.for("react.forward_ref"),Rg=Symbol.for("react.suspense"),Bg=Symbol.for("react.memo"),Fg=Symbol.for("react.lazy"),ru=Symbol.iterator;function Og(e){return e===null||typeof e!="object"?null:(e=ru&&e[ru]||e["@@iterator"],typeof e=="function"?e:null)}var vh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},xh=Object.assign,wh={};function Ka(e,t,n){this.props=e,this.context=t,this.refs=wh,this.updater=n||vh}Ka.prototype.isReactComponent={};Ka.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ka.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function jh(){}jh.prototype=Ka.prototype;function Kc(e,t,n){this.props=e,this.context=t,this.refs=wh,this.updater=n||vh}var Zc=Kc.prototype=new jh;Zc.constructor=Kc;xh(Zc,Ka.prototype);Zc.isPureReactComponent=!0;var iu=Array.isArray,Sh=Object.prototype.hasOwnProperty,Jc={current:null},kh={key:!0,ref:!0,__self:!0,__source:!0};function Nh(e,t,n){var s,r={},i=null,o=null;if(t!=null)for(s in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)Sh.call(t,s)&&!kh.hasOwnProperty(s)&&(r[s]=t[s]);var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];r.children=c}if(e&&e.defaultProps)for(s in l=e.defaultProps,l)r[s]===void 0&&(r[s]=l[s]);return{$$typeof:Kr,type:e,key:i,ref:o,props:r,_owner:Jc.current}}function Hg(e,t){return{$$typeof:Kr,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ed(e){return typeof e=="object"&&e!==null&&e.$$typeof===Kr}function qg(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var ou=/\/+/g;function tl(e,t){return typeof e=="object"&&e!==null&&e.key!=null?qg(""+e.key):t.toString(36)}function Ri(e,t,n,s,r){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Kr:case Eg:o=!0}}if(o)return o=e,r=r(o),e=s===""?"."+tl(o,0):s,iu(r)?(n="",e!=null&&(n=e.replace(ou,"$&/")+"/"),Ri(r,t,n,"",function(d){return d})):r!=null&&(ed(r)&&(r=Hg(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(ou,"$&/")+"/")+e)),t.push(r)),1;if(o=0,s=s===""?".":s+":",iu(e))for(var l=0;l<e.length;l++){i=e[l];var c=s+tl(i,l);o+=Ri(i,t,n,c,r)}else if(c=Og(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=s+tl(i,l++),o+=Ri(i,t,n,c,r);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function ci(e,t,n){if(e==null)return e;var s=[],r=0;return Ri(e,s,"","",function(i){return t.call(n,i,r++)}),s}function zg(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var kt={current:null},Bi={transition:null},Wg={ReactCurrentDispatcher:kt,ReactCurrentBatchConfig:Bi,ReactCurrentOwner:Jc};function bh(){throw Error("act(...) is not supported in production builds of React.")}me.Children={map:ci,forEach:function(e,t,n){ci(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return ci(e,function(){t++}),t},toArray:function(e){return ci(e,function(t){return t})||[]},only:function(e){if(!ed(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};me.Component=Ka;me.Fragment=Tg;me.Profiler=Mg;me.PureComponent=Kc;me.StrictMode=Pg;me.Suspense=Rg;me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Wg;me.act=bh;me.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=xh({},e.props),r=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=Jc.current),t.key!==void 0&&(r=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Sh.call(t,c)&&!kh.hasOwnProperty(c)&&(s[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];s.children=l}return{$$typeof:Kr,type:e.type,key:r,ref:i,props:s,_owner:o}};me.createContext=function(e){return e={$$typeof:Lg,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Ig,_context:e},e.Consumer=e};me.createElement=Nh;me.createFactory=function(e){var t=Nh.bind(null,e);return t.type=e,t};me.createRef=function(){return{current:null}};me.forwardRef=function(e){return{$$typeof:Ag,render:e}};me.isValidElement=ed;me.lazy=function(e){return{$$typeof:Fg,_payload:{_status:-1,_result:e},_init:zg}};me.memo=function(e,t){return{$$typeof:Bg,type:e,compare:t===void 0?null:t}};me.startTransition=function(e){var t=Bi.transition;Bi.transition={};try{e()}finally{Bi.transition=t}};me.unstable_act=bh;me.useCallback=function(e,t){return kt.current.useCallback(e,t)};me.useContext=function(e){return kt.current.useContext(e)};me.useDebugValue=function(){};me.useDeferredValue=function(e){return kt.current.useDeferredValue(e)};me.useEffect=function(e,t){return kt.current.useEffect(e,t)};me.useId=function(){return kt.current.useId()};me.useImperativeHandle=function(e,t,n){return kt.current.useImperativeHandle(e,t,n)};me.useInsertionEffect=function(e,t){return kt.current.useInsertionEffect(e,t)};me.useLayoutEffect=function(e,t){return kt.current.useLayoutEffect(e,t)};me.useMemo=function(e,t){return kt.current.useMemo(e,t)};me.useReducer=function(e,t,n){return kt.current.useReducer(e,t,n)};me.useRef=function(e){return kt.current.useRef(e)};me.useState=function(e){return kt.current.useState(e)};me.useSyncExternalStore=function(e,t,n){return kt.current.useSyncExternalStore(e,t,n)};me.useTransition=function(){return kt.current.useTransition()};me.version="18.3.1";yh.exports=me;var g=yh.exports;const di=$g(g);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ug=g,Vg=Symbol.for("react.element"),Gg=Symbol.for("react.fragment"),Qg=Object.prototype.hasOwnProperty,Yg=Ug.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Xg={key:!0,ref:!0,__self:!0,__source:!0};function Ch(e,t,n){var s,r={},i=null,o=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(s in t)Qg.call(t,s)&&!Xg.hasOwnProperty(s)&&(r[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)r[s]===void 0&&(r[s]=t[s]);return{$$typeof:Vg,type:e,key:i,ref:o,props:r,_owner:Yg.current}}$o.Fragment=Gg;$o.jsx=Ch;$o.jsxs=Ch;_h.exports=$o;var a=_h.exports,Dh={exports:{}},zt={},$h={exports:{}},Eh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(C,R){var A=C.length;C.push(R);e:for(;0<A;){var H=A-1>>>1,z=C[H];if(0<r(z,R))C[H]=R,C[A]=z,A=H;else break e}}function n(C){return C.length===0?null:C[0]}function s(C){if(C.length===0)return null;var R=C[0],A=C.pop();if(A!==R){C[0]=A;e:for(var H=0,z=C.length,K=z>>>1;H<K;){var Q=2*(H+1)-1,Y=C[Q],J=Q+1,ne=C[J];if(0>r(Y,A))J<z&&0>r(ne,Y)?(C[H]=ne,C[J]=A,H=J):(C[H]=Y,C[Q]=A,H=Q);else if(J<z&&0>r(ne,A))C[H]=ne,C[J]=A,H=J;else break e}}return R}function r(C,R){var A=C.sortIndex-R.sortIndex;return A!==0?A:C.id-R.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],d=[],f=1,h=null,p=3,_=!1,v=!1,u=!1,y=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(C){for(var R=n(d);R!==null;){if(R.callback===null)s(d);else if(R.startTime<=C)s(d),R.sortIndex=R.expirationTime,t(c,R);else break;R=n(d)}}function b(C){if(u=!1,w(C),!v)if(n(c)!==null)v=!0,M(S);else{var R=n(d);R!==null&&B(b,R.startTime-C)}}function S(C,R){v=!1,u&&(u=!1,m(L),L=-1),_=!0;var A=p;try{for(w(R),h=n(c);h!==null&&(!(h.expirationTime>R)||C&&!$());){var H=h.callback;if(typeof H=="function"){h.callback=null,p=h.priorityLevel;var z=H(h.expirationTime<=R);R=e.unstable_now(),typeof z=="function"?h.callback=z:h===n(c)&&s(c),w(R)}else s(c);h=n(c)}if(h!==null)var K=!0;else{var Q=n(d);Q!==null&&B(b,Q.startTime-R),K=!1}return K}finally{h=null,p=A,_=!1}}var N=!1,D=null,L=-1,T=5,j=-1;function $(){return!(e.unstable_now()-j<T)}function P(){if(D!==null){var C=e.unstable_now();j=C;var R=!0;try{R=D(!0,C)}finally{R?k():(N=!1,D=null)}}else N=!1}var k;if(typeof x=="function")k=function(){x(P)};else if(typeof MessageChannel<"u"){var E=new MessageChannel,I=E.port2;E.port1.onmessage=P,k=function(){I.postMessage(null)}}else k=function(){y(P,0)};function M(C){D=C,N||(N=!0,k())}function B(C,R){L=y(function(){C(e.unstable_now())},R)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(C){C.callback=null},e.unstable_continueExecution=function(){v||_||(v=!0,M(S))},e.unstable_forceFrameRate=function(C){0>C||125<C?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<C?Math.floor(1e3/C):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(C){switch(p){case 1:case 2:case 3:var R=3;break;default:R=p}var A=p;p=R;try{return C()}finally{p=A}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(C,R){switch(C){case 1:case 2:case 3:case 4:case 5:break;default:C=3}var A=p;p=C;try{return R()}finally{p=A}},e.unstable_scheduleCallback=function(C,R,A){var H=e.unstable_now();switch(typeof A=="object"&&A!==null?(A=A.delay,A=typeof A=="number"&&0<A?H+A:H):A=H,C){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=A+z,C={id:f++,callback:R,priorityLevel:C,startTime:A,expirationTime:z,sortIndex:-1},A>H?(C.sortIndex=A,t(d,C),n(c)===null&&C===n(d)&&(u?(m(L),L=-1):u=!0,B(b,A-H))):(C.sortIndex=z,t(c,C),v||_||(v=!0,M(S))),C},e.unstable_shouldYield=$,e.unstable_wrapCallback=function(C){var R=p;return function(){var A=p;p=R;try{return C.apply(this,arguments)}finally{p=A}}}})(Eh);$h.exports=Eh;var Kg=$h.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zg=g,Ht=Kg;function U(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Th=new Set,$r={};function aa(e,t){qa(e,t),qa(e+"Capture",t)}function qa(e,t){for($r[e]=t,e=0;e<t.length;e++)Th.add(t[e])}var zn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wl=Object.prototype.hasOwnProperty,Jg=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,lu={},cu={};function e_(e){return Wl.call(cu,e)?!0:Wl.call(lu,e)?!1:Jg.test(e)?cu[e]=!0:(lu[e]=!0,!1)}function t_(e,t,n,s){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function n_(e,t,n,s){if(t===null||typeof t>"u"||t_(e,t,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Nt(e,t,n,s,r,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var ct={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ct[e]=new Nt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ct[t]=new Nt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ct[e]=new Nt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ct[e]=new Nt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ct[e]=new Nt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ct[e]=new Nt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ct[e]=new Nt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ct[e]=new Nt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ct[e]=new Nt(e,5,!1,e.toLowerCase(),null,!1,!1)});var td=/[\-:]([a-z])/g;function nd(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(td,nd);ct[t]=new Nt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(td,nd);ct[t]=new Nt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(td,nd);ct[t]=new Nt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ct[e]=new Nt(e,1,!1,e.toLowerCase(),null,!1,!1)});ct.xlinkHref=new Nt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ct[e]=new Nt(e,1,!1,e.toLowerCase(),null,!0,!0)});function sd(e,t,n,s){var r=ct.hasOwnProperty(t)?ct[t]:null;(r!==null?r.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(n_(t,n,r,s)&&(n=null),s||r===null?e_(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=n===null?r.type===3?!1:"":n:(t=r.attributeName,s=r.attributeNamespace,n===null?e.removeAttribute(t):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?e.setAttributeNS(s,t,n):e.setAttribute(t,n))))}var Qn=Zg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ui=Symbol.for("react.element"),pa=Symbol.for("react.portal"),ga=Symbol.for("react.fragment"),ad=Symbol.for("react.strict_mode"),Ul=Symbol.for("react.profiler"),Ph=Symbol.for("react.provider"),Mh=Symbol.for("react.context"),rd=Symbol.for("react.forward_ref"),Vl=Symbol.for("react.suspense"),Gl=Symbol.for("react.suspense_list"),id=Symbol.for("react.memo"),ns=Symbol.for("react.lazy"),Ih=Symbol.for("react.offscreen"),du=Symbol.iterator;function er(e){return e===null||typeof e!="object"?null:(e=du&&e[du]||e["@@iterator"],typeof e=="function"?e:null)}var Be=Object.assign,nl;function gr(e){if(nl===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);nl=t&&t[1]||""}return`
`+nl+e}var sl=!1;function al(e,t){if(!e||sl)return"";sl=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var s=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){s=d}e.call(t.prototype)}else{try{throw Error()}catch(d){s=d}e()}}catch(d){if(d&&s&&typeof d.stack=="string"){for(var r=d.stack.split(`
`),i=s.stack.split(`
`),o=r.length-1,l=i.length-1;1<=o&&0<=l&&r[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(r[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||r[o]!==i[l]){var c=`
`+r[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{sl=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?gr(e):""}function s_(e){switch(e.tag){case 5:return gr(e.type);case 16:return gr("Lazy");case 13:return gr("Suspense");case 19:return gr("SuspenseList");case 0:case 2:case 15:return e=al(e.type,!1),e;case 11:return e=al(e.type.render,!1),e;case 1:return e=al(e.type,!0),e;default:return""}}function Ql(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ga:return"Fragment";case pa:return"Portal";case Ul:return"Profiler";case ad:return"StrictMode";case Vl:return"Suspense";case Gl:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Mh:return(e.displayName||"Context")+".Consumer";case Ph:return(e._context.displayName||"Context")+".Provider";case rd:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case id:return t=e.displayName||null,t!==null?t:Ql(e.type)||"Memo";case ns:t=e._payload,e=e._init;try{return Ql(e(t))}catch{}}return null}function a_(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ql(t);case 8:return t===ad?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function bs(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Lh(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function r_(e){var t=Lh(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function fi(e){e._valueTracker||(e._valueTracker=r_(e))}function Ah(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=Lh(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function Yi(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Yl(e,t){var n=t.checked;return Be({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function uu(e,t){var n=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;n=bs(t.value!=null?t.value:n),e._wrapperState={initialChecked:s,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Rh(e,t){t=t.checked,t!=null&&sd(e,"checked",t,!1)}function Xl(e,t){Rh(e,t);var n=bs(t.value),s=t.type;if(n!=null)s==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Kl(e,t.type,n):t.hasOwnProperty("defaultValue")&&Kl(e,t.type,bs(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function fu(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Kl(e,t,n){(t!=="number"||Yi(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var _r=Array.isArray;function Da(e,t,n,s){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&s&&(e[n].defaultSelected=!0)}else{for(n=""+bs(n),t=null,r=0;r<e.length;r++){if(e[r].value===n){e[r].selected=!0,s&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function Zl(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(U(91));return Be({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function hu(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(U(92));if(_r(n)){if(1<n.length)throw Error(U(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:bs(n)}}function Bh(e,t){var n=bs(t.value),s=bs(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),s!=null&&(e.defaultValue=""+s)}function mu(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Fh(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Jl(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Fh(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var hi,Oh=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,s,r){MSApp.execUnsafeLocalFunction(function(){return e(t,n,s,r)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(hi=hi||document.createElement("div"),hi.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=hi.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Er(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var xr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},i_=["Webkit","ms","Moz","O"];Object.keys(xr).forEach(function(e){i_.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),xr[t]=xr[e]})});function Hh(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||xr.hasOwnProperty(e)&&xr[e]?(""+t).trim():t+"px"}function qh(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=Hh(n,t[n],s);n==="float"&&(n="cssFloat"),s?e.setProperty(n,r):e[n]=r}}var o_=Be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ec(e,t){if(t){if(o_[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(U(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(U(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(U(61))}if(t.style!=null&&typeof t.style!="object")throw Error(U(62))}}function tc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var nc=null;function od(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var sc=null,$a=null,Ea=null;function pu(e){if(e=ei(e)){if(typeof sc!="function")throw Error(U(280));var t=e.stateNode;t&&(t=Io(t),sc(e.stateNode,e.type,t))}}function zh(e){$a?Ea?Ea.push(e):Ea=[e]:$a=e}function Wh(){if($a){var e=$a,t=Ea;if(Ea=$a=null,pu(e),t)for(e=0;e<t.length;e++)pu(t[e])}}function Uh(e,t){return e(t)}function Vh(){}var rl=!1;function Gh(e,t,n){if(rl)return e(t,n);rl=!0;try{return Uh(e,t,n)}finally{rl=!1,($a!==null||Ea!==null)&&(Vh(),Wh())}}function Tr(e,t){var n=e.stateNode;if(n===null)return null;var s=Io(n);if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(U(231,t,typeof n));return n}var ac=!1;if(zn)try{var tr={};Object.defineProperty(tr,"passive",{get:function(){ac=!0}}),window.addEventListener("test",tr,tr),window.removeEventListener("test",tr,tr)}catch{ac=!1}function l_(e,t,n,s,r,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(f){this.onError(f)}}var wr=!1,Xi=null,Ki=!1,rc=null,c_={onError:function(e){wr=!0,Xi=e}};function d_(e,t,n,s,r,i,o,l,c){wr=!1,Xi=null,l_.apply(c_,arguments)}function u_(e,t,n,s,r,i,o,l,c){if(d_.apply(this,arguments),wr){if(wr){var d=Xi;wr=!1,Xi=null}else throw Error(U(198));Ki||(Ki=!0,rc=d)}}function ra(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Qh(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function gu(e){if(ra(e)!==e)throw Error(U(188))}function f_(e){var t=e.alternate;if(!t){if(t=ra(e),t===null)throw Error(U(188));return t!==e?null:e}for(var n=e,s=t;;){var r=n.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return gu(r),e;if(i===s)return gu(r),t;i=i.sibling}throw Error(U(188))}if(n.return!==s.return)n=r,s=i;else{for(var o=!1,l=r.child;l;){if(l===n){o=!0,n=r,s=i;break}if(l===s){o=!0,s=r,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,s=r;break}if(l===s){o=!0,s=i,n=r;break}l=l.sibling}if(!o)throw Error(U(189))}}if(n.alternate!==s)throw Error(U(190))}if(n.tag!==3)throw Error(U(188));return n.stateNode.current===n?e:t}function Yh(e){return e=f_(e),e!==null?Xh(e):null}function Xh(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Xh(e);if(t!==null)return t;e=e.sibling}return null}var Kh=Ht.unstable_scheduleCallback,_u=Ht.unstable_cancelCallback,h_=Ht.unstable_shouldYield,m_=Ht.unstable_requestPaint,Ue=Ht.unstable_now,p_=Ht.unstable_getCurrentPriorityLevel,ld=Ht.unstable_ImmediatePriority,Zh=Ht.unstable_UserBlockingPriority,Zi=Ht.unstable_NormalPriority,g_=Ht.unstable_LowPriority,Jh=Ht.unstable_IdlePriority,Eo=null,Pn=null;function __(e){if(Pn&&typeof Pn.onCommitFiberRoot=="function")try{Pn.onCommitFiberRoot(Eo,e,void 0,(e.current.flags&128)===128)}catch{}}var gn=Math.clz32?Math.clz32:x_,y_=Math.log,v_=Math.LN2;function x_(e){return e>>>=0,e===0?32:31-(y_(e)/v_|0)|0}var mi=64,pi=4194304;function yr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ji(e,t){var n=e.pendingLanes;if(n===0)return 0;var s=0,r=e.suspendedLanes,i=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~r;l!==0?s=yr(l):(i&=o,i!==0&&(s=yr(i)))}else o=n&~r,o!==0?s=yr(o):i!==0&&(s=yr(i));if(s===0)return 0;if(t!==0&&t!==s&&!(t&r)&&(r=s&-s,i=t&-t,r>=i||r===16&&(i&4194240)!==0))return t;if(s&4&&(s|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)n=31-gn(t),r=1<<n,s|=e[n],t&=~r;return s}function w_(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function j_(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,r=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-gn(i),l=1<<o,c=r[o];c===-1?(!(l&n)||l&s)&&(r[o]=w_(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function ic(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function em(){var e=mi;return mi<<=1,!(mi&4194240)&&(mi=64),e}function il(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Zr(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-gn(t),e[t]=n}function S_(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-gn(n),i=1<<r;t[r]=0,s[r]=-1,e[r]=-1,n&=~i}}function cd(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-gn(n),r=1<<s;r&t|e[s]&t&&(e[s]|=t),n&=~r}}var je=0;function tm(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var nm,dd,sm,am,rm,oc=!1,gi=[],gs=null,_s=null,ys=null,Pr=new Map,Mr=new Map,rs=[],k_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function yu(e,t){switch(e){case"focusin":case"focusout":gs=null;break;case"dragenter":case"dragleave":_s=null;break;case"mouseover":case"mouseout":ys=null;break;case"pointerover":case"pointerout":Pr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mr.delete(t.pointerId)}}function nr(e,t,n,s,r,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},t!==null&&(t=ei(t),t!==null&&dd(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function N_(e,t,n,s,r){switch(t){case"focusin":return gs=nr(gs,e,t,n,s,r),!0;case"dragenter":return _s=nr(_s,e,t,n,s,r),!0;case"mouseover":return ys=nr(ys,e,t,n,s,r),!0;case"pointerover":var i=r.pointerId;return Pr.set(i,nr(Pr.get(i)||null,e,t,n,s,r)),!0;case"gotpointercapture":return i=r.pointerId,Mr.set(i,nr(Mr.get(i)||null,e,t,n,s,r)),!0}return!1}function im(e){var t=Hs(e.target);if(t!==null){var n=ra(t);if(n!==null){if(t=n.tag,t===13){if(t=Qh(n),t!==null){e.blockedOn=t,rm(e.priority,function(){sm(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Fi(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=lc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);nc=s,n.target.dispatchEvent(s),nc=null}else return t=ei(n),t!==null&&dd(t),e.blockedOn=n,!1;t.shift()}return!0}function vu(e,t,n){Fi(e)&&n.delete(t)}function b_(){oc=!1,gs!==null&&Fi(gs)&&(gs=null),_s!==null&&Fi(_s)&&(_s=null),ys!==null&&Fi(ys)&&(ys=null),Pr.forEach(vu),Mr.forEach(vu)}function sr(e,t){e.blockedOn===t&&(e.blockedOn=null,oc||(oc=!0,Ht.unstable_scheduleCallback(Ht.unstable_NormalPriority,b_)))}function Ir(e){function t(r){return sr(r,e)}if(0<gi.length){sr(gi[0],e);for(var n=1;n<gi.length;n++){var s=gi[n];s.blockedOn===e&&(s.blockedOn=null)}}for(gs!==null&&sr(gs,e),_s!==null&&sr(_s,e),ys!==null&&sr(ys,e),Pr.forEach(t),Mr.forEach(t),n=0;n<rs.length;n++)s=rs[n],s.blockedOn===e&&(s.blockedOn=null);for(;0<rs.length&&(n=rs[0],n.blockedOn===null);)im(n),n.blockedOn===null&&rs.shift()}var Ta=Qn.ReactCurrentBatchConfig,eo=!0;function C_(e,t,n,s){var r=je,i=Ta.transition;Ta.transition=null;try{je=1,ud(e,t,n,s)}finally{je=r,Ta.transition=i}}function D_(e,t,n,s){var r=je,i=Ta.transition;Ta.transition=null;try{je=4,ud(e,t,n,s)}finally{je=r,Ta.transition=i}}function ud(e,t,n,s){if(eo){var r=lc(e,t,n,s);if(r===null)gl(e,t,s,to,n),yu(e,s);else if(N_(r,e,t,n,s))s.stopPropagation();else if(yu(e,s),t&4&&-1<k_.indexOf(e)){for(;r!==null;){var i=ei(r);if(i!==null&&nm(i),i=lc(e,t,n,s),i===null&&gl(e,t,s,to,n),i===r)break;r=i}r!==null&&s.stopPropagation()}else gl(e,t,s,null,n)}}var to=null;function lc(e,t,n,s){if(to=null,e=od(s),e=Hs(e),e!==null)if(t=ra(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Qh(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return to=e,null}function om(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(p_()){case ld:return 1;case Zh:return 4;case Zi:case g_:return 16;case Jh:return 536870912;default:return 16}default:return 16}}var ms=null,fd=null,Oi=null;function lm(){if(Oi)return Oi;var e,t=fd,n=t.length,s,r="value"in ms?ms.value:ms.textContent,i=r.length;for(e=0;e<n&&t[e]===r[e];e++);var o=n-e;for(s=1;s<=o&&t[n-s]===r[i-s];s++);return Oi=r.slice(e,1<s?1-s:void 0)}function Hi(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function _i(){return!0}function xu(){return!1}function Wt(e){function t(n,s,r,i,o){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?_i:xu,this.isPropagationStopped=xu,this}return Be(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=_i)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=_i)},persist:function(){},isPersistent:_i}),t}var Za={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hd=Wt(Za),Jr=Be({},Za,{view:0,detail:0}),$_=Wt(Jr),ol,ll,ar,To=Be({},Jr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:md,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ar&&(ar&&e.type==="mousemove"?(ol=e.screenX-ar.screenX,ll=e.screenY-ar.screenY):ll=ol=0,ar=e),ol)},movementY:function(e){return"movementY"in e?e.movementY:ll}}),wu=Wt(To),E_=Be({},To,{dataTransfer:0}),T_=Wt(E_),P_=Be({},Jr,{relatedTarget:0}),cl=Wt(P_),M_=Be({},Za,{animationName:0,elapsedTime:0,pseudoElement:0}),I_=Wt(M_),L_=Be({},Za,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),A_=Wt(L_),R_=Be({},Za,{data:0}),ju=Wt(R_),B_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},F_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},O_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function H_(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=O_[e])?!!t[e]:!1}function md(){return H_}var q_=Be({},Jr,{key:function(e){if(e.key){var t=B_[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Hi(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?F_[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:md,charCode:function(e){return e.type==="keypress"?Hi(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Hi(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),z_=Wt(q_),W_=Be({},To,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Su=Wt(W_),U_=Be({},Jr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:md}),V_=Wt(U_),G_=Be({},Za,{propertyName:0,elapsedTime:0,pseudoElement:0}),Q_=Wt(G_),Y_=Be({},To,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),X_=Wt(Y_),K_=[9,13,27,32],pd=zn&&"CompositionEvent"in window,jr=null;zn&&"documentMode"in document&&(jr=document.documentMode);var Z_=zn&&"TextEvent"in window&&!jr,cm=zn&&(!pd||jr&&8<jr&&11>=jr),ku=" ",Nu=!1;function dm(e,t){switch(e){case"keyup":return K_.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function um(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var _a=!1;function J_(e,t){switch(e){case"compositionend":return um(t);case"keypress":return t.which!==32?null:(Nu=!0,ku);case"textInput":return e=t.data,e===ku&&Nu?null:e;default:return null}}function ey(e,t){if(_a)return e==="compositionend"||!pd&&dm(e,t)?(e=lm(),Oi=fd=ms=null,_a=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return cm&&t.locale!=="ko"?null:t.data;default:return null}}var ty={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!ty[e.type]:t==="textarea"}function fm(e,t,n,s){zh(s),t=no(t,"onChange"),0<t.length&&(n=new hd("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var Sr=null,Lr=null;function ny(e){Sm(e,0)}function Po(e){var t=xa(e);if(Ah(t))return e}function sy(e,t){if(e==="change")return t}var hm=!1;if(zn){var dl;if(zn){var ul="oninput"in document;if(!ul){var Cu=document.createElement("div");Cu.setAttribute("oninput","return;"),ul=typeof Cu.oninput=="function"}dl=ul}else dl=!1;hm=dl&&(!document.documentMode||9<document.documentMode)}function Du(){Sr&&(Sr.detachEvent("onpropertychange",mm),Lr=Sr=null)}function mm(e){if(e.propertyName==="value"&&Po(Lr)){var t=[];fm(t,Lr,e,od(e)),Gh(ny,t)}}function ay(e,t,n){e==="focusin"?(Du(),Sr=t,Lr=n,Sr.attachEvent("onpropertychange",mm)):e==="focusout"&&Du()}function ry(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Po(Lr)}function iy(e,t){if(e==="click")return Po(t)}function oy(e,t){if(e==="input"||e==="change")return Po(t)}function ly(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var yn=typeof Object.is=="function"?Object.is:ly;function Ar(e,t){if(yn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!Wl.call(t,r)||!yn(e[r],t[r]))return!1}return!0}function $u(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Eu(e,t){var n=$u(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=$u(n)}}function pm(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?pm(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function gm(){for(var e=window,t=Yi();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Yi(e.document)}return t}function gd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function cy(e){var t=gm(),n=e.focusedElem,s=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&pm(n.ownerDocument.documentElement,n)){if(s!==null&&gd(n)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var r=n.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!e.extend&&i>s&&(r=s,s=i,i=r),r=Eu(n,i);var o=Eu(n,s);r&&o&&(e.rangeCount!==1||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(r.node,r.offset),e.removeAllRanges(),i>s?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var dy=zn&&"documentMode"in document&&11>=document.documentMode,ya=null,cc=null,kr=null,dc=!1;function Tu(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;dc||ya==null||ya!==Yi(s)||(s=ya,"selectionStart"in s&&gd(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),kr&&Ar(kr,s)||(kr=s,s=no(cc,"onSelect"),0<s.length&&(t=new hd("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=ya)))}function yi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var va={animationend:yi("Animation","AnimationEnd"),animationiteration:yi("Animation","AnimationIteration"),animationstart:yi("Animation","AnimationStart"),transitionend:yi("Transition","TransitionEnd")},fl={},_m={};zn&&(_m=document.createElement("div").style,"AnimationEvent"in window||(delete va.animationend.animation,delete va.animationiteration.animation,delete va.animationstart.animation),"TransitionEvent"in window||delete va.transitionend.transition);function Mo(e){if(fl[e])return fl[e];if(!va[e])return e;var t=va[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in _m)return fl[e]=t[n];return e}var ym=Mo("animationend"),vm=Mo("animationiteration"),xm=Mo("animationstart"),wm=Mo("transitionend"),jm=new Map,Pu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $s(e,t){jm.set(e,t),aa(t,[e])}for(var hl=0;hl<Pu.length;hl++){var ml=Pu[hl],uy=ml.toLowerCase(),fy=ml[0].toUpperCase()+ml.slice(1);$s(uy,"on"+fy)}$s(ym,"onAnimationEnd");$s(vm,"onAnimationIteration");$s(xm,"onAnimationStart");$s("dblclick","onDoubleClick");$s("focusin","onFocus");$s("focusout","onBlur");$s(wm,"onTransitionEnd");qa("onMouseEnter",["mouseout","mouseover"]);qa("onMouseLeave",["mouseout","mouseover"]);qa("onPointerEnter",["pointerout","pointerover"]);qa("onPointerLeave",["pointerout","pointerover"]);aa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));aa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));aa("onBeforeInput",["compositionend","keypress","textInput","paste"]);aa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));aa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));aa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hy=new Set("cancel close invalid load scroll toggle".split(" ").concat(vr));function Mu(e,t,n){var s=e.type||"unknown-event";e.currentTarget=n,u_(s,t,void 0,e),e.currentTarget=null}function Sm(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],r=s.event;s=s.listeners;e:{var i=void 0;if(t)for(var o=s.length-1;0<=o;o--){var l=s[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&r.isPropagationStopped())break e;Mu(r,l,d),i=c}else for(o=0;o<s.length;o++){if(l=s[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&r.isPropagationStopped())break e;Mu(r,l,d),i=c}}}if(Ki)throw e=rc,Ki=!1,rc=null,e}function $e(e,t){var n=t[pc];n===void 0&&(n=t[pc]=new Set);var s=e+"__bubble";n.has(s)||(km(t,e,2,!1),n.add(s))}function pl(e,t,n){var s=0;t&&(s|=4),km(n,e,s,t)}var vi="_reactListening"+Math.random().toString(36).slice(2);function Rr(e){if(!e[vi]){e[vi]=!0,Th.forEach(function(n){n!=="selectionchange"&&(hy.has(n)||pl(n,!1,e),pl(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[vi]||(t[vi]=!0,pl("selectionchange",!1,t))}}function km(e,t,n,s){switch(om(t)){case 1:var r=C_;break;case 4:r=D_;break;default:r=ud}n=r.bind(null,t,n,e),r=void 0,!ac||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),s?r!==void 0?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):r!==void 0?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function gl(e,t,n,s,r){var i=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var l=s.stateNode.containerInfo;if(l===r||l.nodeType===8&&l.parentNode===r)break;if(o===4)for(o=s.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===r||c.nodeType===8&&c.parentNode===r))return;o=o.return}for(;l!==null;){if(o=Hs(l),o===null)return;if(c=o.tag,c===5||c===6){s=i=o;continue e}l=l.parentNode}}s=s.return}Gh(function(){var d=i,f=od(n),h=[];e:{var p=jm.get(e);if(p!==void 0){var _=hd,v=e;switch(e){case"keypress":if(Hi(n)===0)break e;case"keydown":case"keyup":_=z_;break;case"focusin":v="focus",_=cl;break;case"focusout":v="blur",_=cl;break;case"beforeblur":case"afterblur":_=cl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=wu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=T_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=V_;break;case ym:case vm:case xm:_=I_;break;case wm:_=Q_;break;case"scroll":_=$_;break;case"wheel":_=X_;break;case"copy":case"cut":case"paste":_=A_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=Su}var u=(t&4)!==0,y=!u&&e==="scroll",m=u?p!==null?p+"Capture":null:p;u=[];for(var x=d,w;x!==null;){w=x;var b=w.stateNode;if(w.tag===5&&b!==null&&(w=b,m!==null&&(b=Tr(x,m),b!=null&&u.push(Br(x,b,w)))),y)break;x=x.return}0<u.length&&(p=new _(p,v,null,n,f),h.push({event:p,listeners:u}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",_=e==="mouseout"||e==="pointerout",p&&n!==nc&&(v=n.relatedTarget||n.fromElement)&&(Hs(v)||v[Wn]))break e;if((_||p)&&(p=f.window===f?f:(p=f.ownerDocument)?p.defaultView||p.parentWindow:window,_?(v=n.relatedTarget||n.toElement,_=d,v=v?Hs(v):null,v!==null&&(y=ra(v),v!==y||v.tag!==5&&v.tag!==6)&&(v=null)):(_=null,v=d),_!==v)){if(u=wu,b="onMouseLeave",m="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(u=Su,b="onPointerLeave",m="onPointerEnter",x="pointer"),y=_==null?p:xa(_),w=v==null?p:xa(v),p=new u(b,x+"leave",_,n,f),p.target=y,p.relatedTarget=w,b=null,Hs(f)===d&&(u=new u(m,x+"enter",v,n,f),u.target=w,u.relatedTarget=y,b=u),y=b,_&&v)t:{for(u=_,m=v,x=0,w=u;w;w=ca(w))x++;for(w=0,b=m;b;b=ca(b))w++;for(;0<x-w;)u=ca(u),x--;for(;0<w-x;)m=ca(m),w--;for(;x--;){if(u===m||m!==null&&u===m.alternate)break t;u=ca(u),m=ca(m)}u=null}else u=null;_!==null&&Iu(h,p,_,u,!1),v!==null&&y!==null&&Iu(h,y,v,u,!0)}}e:{if(p=d?xa(d):window,_=p.nodeName&&p.nodeName.toLowerCase(),_==="select"||_==="input"&&p.type==="file")var S=sy;else if(bu(p))if(hm)S=oy;else{S=ry;var N=ay}else(_=p.nodeName)&&_.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(S=iy);if(S&&(S=S(e,d))){fm(h,S,n,f);break e}N&&N(e,p,d),e==="focusout"&&(N=p._wrapperState)&&N.controlled&&p.type==="number"&&Kl(p,"number",p.value)}switch(N=d?xa(d):window,e){case"focusin":(bu(N)||N.contentEditable==="true")&&(ya=N,cc=d,kr=null);break;case"focusout":kr=cc=ya=null;break;case"mousedown":dc=!0;break;case"contextmenu":case"mouseup":case"dragend":dc=!1,Tu(h,n,f);break;case"selectionchange":if(dy)break;case"keydown":case"keyup":Tu(h,n,f)}var D;if(pd)e:{switch(e){case"compositionstart":var L="onCompositionStart";break e;case"compositionend":L="onCompositionEnd";break e;case"compositionupdate":L="onCompositionUpdate";break e}L=void 0}else _a?dm(e,n)&&(L="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(L="onCompositionStart");L&&(cm&&n.locale!=="ko"&&(_a||L!=="onCompositionStart"?L==="onCompositionEnd"&&_a&&(D=lm()):(ms=f,fd="value"in ms?ms.value:ms.textContent,_a=!0)),N=no(d,L),0<N.length&&(L=new ju(L,e,null,n,f),h.push({event:L,listeners:N}),D?L.data=D:(D=um(n),D!==null&&(L.data=D)))),(D=Z_?J_(e,n):ey(e,n))&&(d=no(d,"onBeforeInput"),0<d.length&&(f=new ju("onBeforeInput","beforeinput",null,n,f),h.push({event:f,listeners:d}),f.data=D))}Sm(h,t)})}function Br(e,t,n){return{instance:e,listener:t,currentTarget:n}}function no(e,t){for(var n=t+"Capture",s=[];e!==null;){var r=e,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=Tr(e,n),i!=null&&s.unshift(Br(e,i,r)),i=Tr(e,t),i!=null&&s.push(Br(e,i,r))),e=e.return}return s}function ca(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Iu(e,t,n,s,r){for(var i=t._reactName,o=[];n!==null&&n!==s;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===s)break;l.tag===5&&d!==null&&(l=d,r?(c=Tr(n,i),c!=null&&o.unshift(Br(n,c,l))):r||(c=Tr(n,i),c!=null&&o.push(Br(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var my=/\r\n?/g,py=/\u0000|\uFFFD/g;function Lu(e){return(typeof e=="string"?e:""+e).replace(my,`
`).replace(py,"")}function xi(e,t,n){if(t=Lu(t),Lu(e)!==t&&n)throw Error(U(425))}function so(){}var uc=null,fc=null;function hc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var mc=typeof setTimeout=="function"?setTimeout:void 0,gy=typeof clearTimeout=="function"?clearTimeout:void 0,Au=typeof Promise=="function"?Promise:void 0,_y=typeof queueMicrotask=="function"?queueMicrotask:typeof Au<"u"?function(e){return Au.resolve(null).then(e).catch(yy)}:mc;function yy(e){setTimeout(function(){throw e})}function _l(e,t){var n=t,s=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){e.removeChild(r),Ir(t);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);Ir(t)}function vs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Ru(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Ja=Math.random().toString(36).slice(2),Dn="__reactFiber$"+Ja,Fr="__reactProps$"+Ja,Wn="__reactContainer$"+Ja,pc="__reactEvents$"+Ja,vy="__reactListeners$"+Ja,xy="__reactHandles$"+Ja;function Hs(e){var t=e[Dn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Wn]||n[Dn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Ru(e);e!==null;){if(n=e[Dn])return n;e=Ru(e)}return t}e=n,n=e.parentNode}return null}function ei(e){return e=e[Dn]||e[Wn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function xa(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(U(33))}function Io(e){return e[Fr]||null}var gc=[],wa=-1;function Es(e){return{current:e}}function Te(e){0>wa||(e.current=gc[wa],gc[wa]=null,wa--)}function Ne(e,t){wa++,gc[wa]=e.current,e.current=t}var Cs={},gt=Es(Cs),Et=Es(!1),Js=Cs;function za(e,t){var n=e.type.contextTypes;if(!n)return Cs;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in n)r[i]=t[i];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function Tt(e){return e=e.childContextTypes,e!=null}function ao(){Te(Et),Te(gt)}function Bu(e,t,n){if(gt.current!==Cs)throw Error(U(168));Ne(gt,t),Ne(Et,n)}function Nm(e,t,n){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in t))throw Error(U(108,a_(e)||"Unknown",r));return Be({},n,s)}function ro(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Cs,Js=gt.current,Ne(gt,e),Ne(Et,Et.current),!0}function Fu(e,t,n){var s=e.stateNode;if(!s)throw Error(U(169));n?(e=Nm(e,t,Js),s.__reactInternalMemoizedMergedChildContext=e,Te(Et),Te(gt),Ne(gt,e)):Te(Et),Ne(Et,n)}var Rn=null,Lo=!1,yl=!1;function bm(e){Rn===null?Rn=[e]:Rn.push(e)}function wy(e){Lo=!0,bm(e)}function Ts(){if(!yl&&Rn!==null){yl=!0;var e=0,t=je;try{var n=Rn;for(je=1;e<n.length;e++){var s=n[e];do s=s(!0);while(s!==null)}Rn=null,Lo=!1}catch(r){throw Rn!==null&&(Rn=Rn.slice(e+1)),Kh(ld,Ts),r}finally{je=t,yl=!1}}return null}var ja=[],Sa=0,io=null,oo=0,Zt=[],Jt=0,ea=null,Fn=1,On="";function Bs(e,t){ja[Sa++]=oo,ja[Sa++]=io,io=e,oo=t}function Cm(e,t,n){Zt[Jt++]=Fn,Zt[Jt++]=On,Zt[Jt++]=ea,ea=e;var s=Fn;e=On;var r=32-gn(s)-1;s&=~(1<<r),n+=1;var i=32-gn(t)+r;if(30<i){var o=r-r%5;i=(s&(1<<o)-1).toString(32),s>>=o,r-=o,Fn=1<<32-gn(t)+r|n<<r|s,On=i+e}else Fn=1<<i|n<<r|s,On=e}function _d(e){e.return!==null&&(Bs(e,1),Cm(e,1,0))}function yd(e){for(;e===io;)io=ja[--Sa],ja[Sa]=null,oo=ja[--Sa],ja[Sa]=null;for(;e===ea;)ea=Zt[--Jt],Zt[Jt]=null,On=Zt[--Jt],Zt[Jt]=null,Fn=Zt[--Jt],Zt[Jt]=null}var Ot=null,Ft=null,Me=!1,pn=null;function Dm(e,t){var n=en(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Ou(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ot=e,Ft=vs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ot=e,Ft=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=ea!==null?{id:Fn,overflow:On}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=en(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Ot=e,Ft=null,!0):!1;default:return!1}}function _c(e){return(e.mode&1)!==0&&(e.flags&128)===0}function yc(e){if(Me){var t=Ft;if(t){var n=t;if(!Ou(e,t)){if(_c(e))throw Error(U(418));t=vs(n.nextSibling);var s=Ot;t&&Ou(e,t)?Dm(s,n):(e.flags=e.flags&-4097|2,Me=!1,Ot=e)}}else{if(_c(e))throw Error(U(418));e.flags=e.flags&-4097|2,Me=!1,Ot=e}}}function Hu(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ot=e}function wi(e){if(e!==Ot)return!1;if(!Me)return Hu(e),Me=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!hc(e.type,e.memoizedProps)),t&&(t=Ft)){if(_c(e))throw $m(),Error(U(418));for(;t;)Dm(e,t),t=vs(t.nextSibling)}if(Hu(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(U(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Ft=vs(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Ft=null}}else Ft=Ot?vs(e.stateNode.nextSibling):null;return!0}function $m(){for(var e=Ft;e;)e=vs(e.nextSibling)}function Wa(){Ft=Ot=null,Me=!1}function vd(e){pn===null?pn=[e]:pn.push(e)}var jy=Qn.ReactCurrentBatchConfig;function rr(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(U(309));var s=n.stateNode}if(!s)throw Error(U(147,e));var r=s,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=r.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(U(284));if(!n._owner)throw Error(U(290,e))}return e}function ji(e,t){throw e=Object.prototype.toString.call(t),Error(U(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function qu(e){var t=e._init;return t(e._payload)}function Em(e){function t(m,x){if(e){var w=m.deletions;w===null?(m.deletions=[x],m.flags|=16):w.push(x)}}function n(m,x){if(!e)return null;for(;x!==null;)t(m,x),x=x.sibling;return null}function s(m,x){for(m=new Map;x!==null;)x.key!==null?m.set(x.key,x):m.set(x.index,x),x=x.sibling;return m}function r(m,x){return m=Ss(m,x),m.index=0,m.sibling=null,m}function i(m,x,w){return m.index=w,e?(w=m.alternate,w!==null?(w=w.index,w<x?(m.flags|=2,x):w):(m.flags|=2,x)):(m.flags|=1048576,x)}function o(m){return e&&m.alternate===null&&(m.flags|=2),m}function l(m,x,w,b){return x===null||x.tag!==6?(x=Nl(w,m.mode,b),x.return=m,x):(x=r(x,w),x.return=m,x)}function c(m,x,w,b){var S=w.type;return S===ga?f(m,x,w.props.children,b,w.key):x!==null&&(x.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===ns&&qu(S)===x.type)?(b=r(x,w.props),b.ref=rr(m,x,w),b.return=m,b):(b=Qi(w.type,w.key,w.props,null,m.mode,b),b.ref=rr(m,x,w),b.return=m,b)}function d(m,x,w,b){return x===null||x.tag!==4||x.stateNode.containerInfo!==w.containerInfo||x.stateNode.implementation!==w.implementation?(x=bl(w,m.mode,b),x.return=m,x):(x=r(x,w.children||[]),x.return=m,x)}function f(m,x,w,b,S){return x===null||x.tag!==7?(x=Zs(w,m.mode,b,S),x.return=m,x):(x=r(x,w),x.return=m,x)}function h(m,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Nl(""+x,m.mode,w),x.return=m,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case ui:return w=Qi(x.type,x.key,x.props,null,m.mode,w),w.ref=rr(m,null,x),w.return=m,w;case pa:return x=bl(x,m.mode,w),x.return=m,x;case ns:var b=x._init;return h(m,b(x._payload),w)}if(_r(x)||er(x))return x=Zs(x,m.mode,w,null),x.return=m,x;ji(m,x)}return null}function p(m,x,w,b){var S=x!==null?x.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return S!==null?null:l(m,x,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ui:return w.key===S?c(m,x,w,b):null;case pa:return w.key===S?d(m,x,w,b):null;case ns:return S=w._init,p(m,x,S(w._payload),b)}if(_r(w)||er(w))return S!==null?null:f(m,x,w,b,null);ji(m,w)}return null}function _(m,x,w,b,S){if(typeof b=="string"&&b!==""||typeof b=="number")return m=m.get(w)||null,l(x,m,""+b,S);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ui:return m=m.get(b.key===null?w:b.key)||null,c(x,m,b,S);case pa:return m=m.get(b.key===null?w:b.key)||null,d(x,m,b,S);case ns:var N=b._init;return _(m,x,w,N(b._payload),S)}if(_r(b)||er(b))return m=m.get(w)||null,f(x,m,b,S,null);ji(x,b)}return null}function v(m,x,w,b){for(var S=null,N=null,D=x,L=x=0,T=null;D!==null&&L<w.length;L++){D.index>L?(T=D,D=null):T=D.sibling;var j=p(m,D,w[L],b);if(j===null){D===null&&(D=T);break}e&&D&&j.alternate===null&&t(m,D),x=i(j,x,L),N===null?S=j:N.sibling=j,N=j,D=T}if(L===w.length)return n(m,D),Me&&Bs(m,L),S;if(D===null){for(;L<w.length;L++)D=h(m,w[L],b),D!==null&&(x=i(D,x,L),N===null?S=D:N.sibling=D,N=D);return Me&&Bs(m,L),S}for(D=s(m,D);L<w.length;L++)T=_(D,m,L,w[L],b),T!==null&&(e&&T.alternate!==null&&D.delete(T.key===null?L:T.key),x=i(T,x,L),N===null?S=T:N.sibling=T,N=T);return e&&D.forEach(function($){return t(m,$)}),Me&&Bs(m,L),S}function u(m,x,w,b){var S=er(w);if(typeof S!="function")throw Error(U(150));if(w=S.call(w),w==null)throw Error(U(151));for(var N=S=null,D=x,L=x=0,T=null,j=w.next();D!==null&&!j.done;L++,j=w.next()){D.index>L?(T=D,D=null):T=D.sibling;var $=p(m,D,j.value,b);if($===null){D===null&&(D=T);break}e&&D&&$.alternate===null&&t(m,D),x=i($,x,L),N===null?S=$:N.sibling=$,N=$,D=T}if(j.done)return n(m,D),Me&&Bs(m,L),S;if(D===null){for(;!j.done;L++,j=w.next())j=h(m,j.value,b),j!==null&&(x=i(j,x,L),N===null?S=j:N.sibling=j,N=j);return Me&&Bs(m,L),S}for(D=s(m,D);!j.done;L++,j=w.next())j=_(D,m,L,j.value,b),j!==null&&(e&&j.alternate!==null&&D.delete(j.key===null?L:j.key),x=i(j,x,L),N===null?S=j:N.sibling=j,N=j);return e&&D.forEach(function(P){return t(m,P)}),Me&&Bs(m,L),S}function y(m,x,w,b){if(typeof w=="object"&&w!==null&&w.type===ga&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case ui:e:{for(var S=w.key,N=x;N!==null;){if(N.key===S){if(S=w.type,S===ga){if(N.tag===7){n(m,N.sibling),x=r(N,w.props.children),x.return=m,m=x;break e}}else if(N.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===ns&&qu(S)===N.type){n(m,N.sibling),x=r(N,w.props),x.ref=rr(m,N,w),x.return=m,m=x;break e}n(m,N);break}else t(m,N);N=N.sibling}w.type===ga?(x=Zs(w.props.children,m.mode,b,w.key),x.return=m,m=x):(b=Qi(w.type,w.key,w.props,null,m.mode,b),b.ref=rr(m,x,w),b.return=m,m=b)}return o(m);case pa:e:{for(N=w.key;x!==null;){if(x.key===N)if(x.tag===4&&x.stateNode.containerInfo===w.containerInfo&&x.stateNode.implementation===w.implementation){n(m,x.sibling),x=r(x,w.children||[]),x.return=m,m=x;break e}else{n(m,x);break}else t(m,x);x=x.sibling}x=bl(w,m.mode,b),x.return=m,m=x}return o(m);case ns:return N=w._init,y(m,x,N(w._payload),b)}if(_r(w))return v(m,x,w,b);if(er(w))return u(m,x,w,b);ji(m,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,x!==null&&x.tag===6?(n(m,x.sibling),x=r(x,w),x.return=m,m=x):(n(m,x),x=Nl(w,m.mode,b),x.return=m,m=x),o(m)):n(m,x)}return y}var Ua=Em(!0),Tm=Em(!1),lo=Es(null),co=null,ka=null,xd=null;function wd(){xd=ka=co=null}function jd(e){var t=lo.current;Te(lo),e._currentValue=t}function vc(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function Pa(e,t){co=e,xd=ka=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&($t=!0),e.firstContext=null)}function nn(e){var t=e._currentValue;if(xd!==e)if(e={context:e,memoizedValue:t,next:null},ka===null){if(co===null)throw Error(U(308));ka=e,co.dependencies={lanes:0,firstContext:e}}else ka=ka.next=e;return t}var qs=null;function Sd(e){qs===null?qs=[e]:qs.push(e)}function Pm(e,t,n,s){var r=t.interleaved;return r===null?(n.next=n,Sd(t)):(n.next=r.next,r.next=n),t.interleaved=n,Un(e,s)}function Un(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var ss=!1;function kd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mm(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Hn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function xs(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,_e&2){var r=s.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),s.pending=t,Un(e,n)}return r=s.interleaved,r===null?(t.next=t,Sd(s)):(t.next=r.next,r.next=t),s.interleaved=t,Un(e,n)}function qi(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,cd(e,n)}}function zu(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?r=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?r=i=t:i=i.next=t}else r=i=t;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function uo(e,t,n,s){var r=e.updateQueue;ss=!1;var i=r.firstBaseUpdate,o=r.lastBaseUpdate,l=r.shared.pending;if(l!==null){r.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var f=e.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=d:l.next=d,f.lastBaseUpdate=c))}if(i!==null){var h=r.baseState;o=0,f=d=c=null,l=i;do{var p=l.lane,_=l.eventTime;if((s&p)===p){f!==null&&(f=f.next={eventTime:_,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=e,u=l;switch(p=t,_=n,u.tag){case 1:if(v=u.payload,typeof v=="function"){h=v.call(_,h,p);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=u.payload,p=typeof v=="function"?v.call(_,h,p):v,p==null)break e;h=Be({},h,p);break e;case 2:ss=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=r.effects,p===null?r.effects=[l]:p.push(l))}else _={eventTime:_,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(d=f=_,c=h):f=f.next=_,o|=p;if(l=l.next,l===null){if(l=r.shared.pending,l===null)break;p=l,l=p.next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}while(!0);if(f===null&&(c=h),r.baseState=c,r.firstBaseUpdate=d,r.lastBaseUpdate=f,t=r.shared.interleaved,t!==null){r=t;do o|=r.lane,r=r.next;while(r!==t)}else i===null&&(r.shared.lanes=0);na|=o,e.lanes=o,e.memoizedState=h}}function Wu(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(U(191,r));r.call(s)}}}var ti={},Mn=Es(ti),Or=Es(ti),Hr=Es(ti);function zs(e){if(e===ti)throw Error(U(174));return e}function Nd(e,t){switch(Ne(Hr,t),Ne(Or,e),Ne(Mn,ti),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Jl(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Jl(t,e)}Te(Mn),Ne(Mn,t)}function Va(){Te(Mn),Te(Or),Te(Hr)}function Im(e){zs(Hr.current);var t=zs(Mn.current),n=Jl(t,e.type);t!==n&&(Ne(Or,e),Ne(Mn,n))}function bd(e){Or.current===e&&(Te(Mn),Te(Or))}var Ae=Es(0);function fo(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var vl=[];function Cd(){for(var e=0;e<vl.length;e++)vl[e]._workInProgressVersionPrimary=null;vl.length=0}var zi=Qn.ReactCurrentDispatcher,xl=Qn.ReactCurrentBatchConfig,ta=0,Re=null,Qe=null,tt=null,ho=!1,Nr=!1,qr=0,Sy=0;function ut(){throw Error(U(321))}function Dd(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!yn(e[n],t[n]))return!1;return!0}function $d(e,t,n,s,r,i){if(ta=i,Re=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,zi.current=e===null||e.memoizedState===null?Cy:Dy,e=n(s,r),Nr){i=0;do{if(Nr=!1,qr=0,25<=i)throw Error(U(301));i+=1,tt=Qe=null,t.updateQueue=null,zi.current=$y,e=n(s,r)}while(Nr)}if(zi.current=mo,t=Qe!==null&&Qe.next!==null,ta=0,tt=Qe=Re=null,ho=!1,t)throw Error(U(300));return e}function Ed(){var e=qr!==0;return qr=0,e}function Sn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return tt===null?Re.memoizedState=tt=e:tt=tt.next=e,tt}function sn(){if(Qe===null){var e=Re.alternate;e=e!==null?e.memoizedState:null}else e=Qe.next;var t=tt===null?Re.memoizedState:tt.next;if(t!==null)tt=t,Qe=e;else{if(e===null)throw Error(U(310));Qe=e,e={memoizedState:Qe.memoizedState,baseState:Qe.baseState,baseQueue:Qe.baseQueue,queue:Qe.queue,next:null},tt===null?Re.memoizedState=tt=e:tt=tt.next=e}return tt}function zr(e,t){return typeof t=="function"?t(e):t}function wl(e){var t=sn(),n=t.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=e;var s=Qe,r=s.baseQueue,i=n.pending;if(i!==null){if(r!==null){var o=r.next;r.next=i.next,i.next=o}s.baseQueue=r=i,n.pending=null}if(r!==null){i=r.next,s=s.baseState;var l=o=null,c=null,d=i;do{var f=d.lane;if((ta&f)===f)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),s=d.hasEagerState?d.eagerState:e(s,d.action);else{var h={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=h,o=s):c=c.next=h,Re.lanes|=f,na|=f}d=d.next}while(d!==null&&d!==i);c===null?o=s:c.next=l,yn(s,t.memoizedState)||($t=!0),t.memoizedState=s,t.baseState=o,t.baseQueue=c,n.lastRenderedState=s}if(e=n.interleaved,e!==null){r=e;do i=r.lane,Re.lanes|=i,na|=i,r=r.next;while(r!==e)}else r===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function jl(e){var t=sn(),n=t.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=e;var s=n.dispatch,r=n.pending,i=t.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do i=e(i,o.action),o=o.next;while(o!==r);yn(i,t.memoizedState)||($t=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,s]}function Lm(){}function Am(e,t){var n=Re,s=sn(),r=t(),i=!yn(s.memoizedState,r);if(i&&(s.memoizedState=r,$t=!0),s=s.queue,Td(Fm.bind(null,n,s,e),[e]),s.getSnapshot!==t||i||tt!==null&&tt.memoizedState.tag&1){if(n.flags|=2048,Wr(9,Bm.bind(null,n,s,r,t),void 0,null),nt===null)throw Error(U(349));ta&30||Rm(n,t,r)}return r}function Rm(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Re.updateQueue,t===null?(t={lastEffect:null,stores:null},Re.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Bm(e,t,n,s){t.value=n,t.getSnapshot=s,Om(t)&&Hm(e)}function Fm(e,t,n){return n(function(){Om(t)&&Hm(e)})}function Om(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!yn(e,n)}catch{return!0}}function Hm(e){var t=Un(e,1);t!==null&&_n(t,e,1,-1)}function Uu(e){var t=Sn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zr,lastRenderedState:e},t.queue=e,e=e.dispatch=by.bind(null,Re,e),[t.memoizedState,e]}function Wr(e,t,n,s){return e={tag:e,create:t,destroy:n,deps:s,next:null},t=Re.updateQueue,t===null?(t={lastEffect:null,stores:null},Re.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e)),e}function qm(){return sn().memoizedState}function Wi(e,t,n,s){var r=Sn();Re.flags|=e,r.memoizedState=Wr(1|t,n,void 0,s===void 0?null:s)}function Ao(e,t,n,s){var r=sn();s=s===void 0?null:s;var i=void 0;if(Qe!==null){var o=Qe.memoizedState;if(i=o.destroy,s!==null&&Dd(s,o.deps)){r.memoizedState=Wr(t,n,i,s);return}}Re.flags|=e,r.memoizedState=Wr(1|t,n,i,s)}function Vu(e,t){return Wi(8390656,8,e,t)}function Td(e,t){return Ao(2048,8,e,t)}function zm(e,t){return Ao(4,2,e,t)}function Wm(e,t){return Ao(4,4,e,t)}function Um(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Vm(e,t,n){return n=n!=null?n.concat([e]):null,Ao(4,4,Um.bind(null,t,e),n)}function Pd(){}function Gm(e,t){var n=sn();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&Dd(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function Qm(e,t){var n=sn();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&Dd(t,s[1])?s[0]:(e=e(),n.memoizedState=[e,t],e)}function Ym(e,t,n){return ta&21?(yn(n,t)||(n=em(),Re.lanes|=n,na|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,$t=!0),e.memoizedState=n)}function ky(e,t){var n=je;je=n!==0&&4>n?n:4,e(!0);var s=xl.transition;xl.transition={};try{e(!1),t()}finally{je=n,xl.transition=s}}function Xm(){return sn().memoizedState}function Ny(e,t,n){var s=js(e);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},Km(e))Zm(t,n);else if(n=Pm(e,t,n,s),n!==null){var r=St();_n(n,e,s,r),Jm(n,t,s)}}function by(e,t,n){var s=js(e),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(Km(e))Zm(t,r);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,n);if(r.hasEagerState=!0,r.eagerState=l,yn(l,o)){var c=t.interleaved;c===null?(r.next=r,Sd(t)):(r.next=c.next,c.next=r),t.interleaved=r;return}}catch{}finally{}n=Pm(e,t,r,s),n!==null&&(r=St(),_n(n,e,s,r),Jm(n,t,s))}}function Km(e){var t=e.alternate;return e===Re||t!==null&&t===Re}function Zm(e,t){Nr=ho=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Jm(e,t,n){if(n&4194240){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,cd(e,n)}}var mo={readContext:nn,useCallback:ut,useContext:ut,useEffect:ut,useImperativeHandle:ut,useInsertionEffect:ut,useLayoutEffect:ut,useMemo:ut,useReducer:ut,useRef:ut,useState:ut,useDebugValue:ut,useDeferredValue:ut,useTransition:ut,useMutableSource:ut,useSyncExternalStore:ut,useId:ut,unstable_isNewReconciler:!1},Cy={readContext:nn,useCallback:function(e,t){return Sn().memoizedState=[e,t===void 0?null:t],e},useContext:nn,useEffect:Vu,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Wi(4194308,4,Um.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Wi(4194308,4,e,t)},useInsertionEffect:function(e,t){return Wi(4,2,e,t)},useMemo:function(e,t){var n=Sn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var s=Sn();return t=n!==void 0?n(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=Ny.bind(null,Re,e),[s.memoizedState,e]},useRef:function(e){var t=Sn();return e={current:e},t.memoizedState=e},useState:Uu,useDebugValue:Pd,useDeferredValue:function(e){return Sn().memoizedState=e},useTransition:function(){var e=Uu(!1),t=e[0];return e=ky.bind(null,e[1]),Sn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var s=Re,r=Sn();if(Me){if(n===void 0)throw Error(U(407));n=n()}else{if(n=t(),nt===null)throw Error(U(349));ta&30||Rm(s,t,n)}r.memoizedState=n;var i={value:n,getSnapshot:t};return r.queue=i,Vu(Fm.bind(null,s,i,e),[e]),s.flags|=2048,Wr(9,Bm.bind(null,s,i,n,t),void 0,null),n},useId:function(){var e=Sn(),t=nt.identifierPrefix;if(Me){var n=On,s=Fn;n=(s&~(1<<32-gn(s)-1)).toString(32)+n,t=":"+t+"R"+n,n=qr++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Sy++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Dy={readContext:nn,useCallback:Gm,useContext:nn,useEffect:Td,useImperativeHandle:Vm,useInsertionEffect:zm,useLayoutEffect:Wm,useMemo:Qm,useReducer:wl,useRef:qm,useState:function(){return wl(zr)},useDebugValue:Pd,useDeferredValue:function(e){var t=sn();return Ym(t,Qe.memoizedState,e)},useTransition:function(){var e=wl(zr)[0],t=sn().memoizedState;return[e,t]},useMutableSource:Lm,useSyncExternalStore:Am,useId:Xm,unstable_isNewReconciler:!1},$y={readContext:nn,useCallback:Gm,useContext:nn,useEffect:Td,useImperativeHandle:Vm,useInsertionEffect:zm,useLayoutEffect:Wm,useMemo:Qm,useReducer:jl,useRef:qm,useState:function(){return jl(zr)},useDebugValue:Pd,useDeferredValue:function(e){var t=sn();return Qe===null?t.memoizedState=e:Ym(t,Qe.memoizedState,e)},useTransition:function(){var e=jl(zr)[0],t=sn().memoizedState;return[e,t]},useMutableSource:Lm,useSyncExternalStore:Am,useId:Xm,unstable_isNewReconciler:!1};function dn(e,t){if(e&&e.defaultProps){t=Be({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function xc(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:Be({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Ro={isMounted:function(e){return(e=e._reactInternals)?ra(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var s=St(),r=js(e),i=Hn(s,r);i.payload=t,n!=null&&(i.callback=n),t=xs(e,i,r),t!==null&&(_n(t,e,r,s),qi(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=St(),r=js(e),i=Hn(s,r);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=xs(e,i,r),t!==null&&(_n(t,e,r,s),qi(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=St(),s=js(e),r=Hn(n,s);r.tag=2,t!=null&&(r.callback=t),t=xs(e,r,s),t!==null&&(_n(t,e,s,n),qi(t,e,s))}};function Gu(e,t,n,s,r,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,i,o):t.prototype&&t.prototype.isPureReactComponent?!Ar(n,s)||!Ar(r,i):!0}function ep(e,t,n){var s=!1,r=Cs,i=t.contextType;return typeof i=="object"&&i!==null?i=nn(i):(r=Tt(t)?Js:gt.current,s=t.contextTypes,i=(s=s!=null)?za(e,r):Cs),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ro,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=i),t}function Qu(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&Ro.enqueueReplaceState(t,t.state,null)}function wc(e,t,n,s){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},kd(e);var i=t.contextType;typeof i=="object"&&i!==null?r.context=nn(i):(i=Tt(t)?Js:gt.current,r.context=za(e,i)),r.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(xc(e,t,i,n),r.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(t=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),t!==r.state&&Ro.enqueueReplaceState(r,r.state,null),uo(e,n,r,s),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308)}function Ga(e,t){try{var n="",s=t;do n+=s_(s),s=s.return;while(s);var r=n}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:r,digest:null}}function Sl(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function jc(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Ey=typeof WeakMap=="function"?WeakMap:Map;function tp(e,t,n){n=Hn(-1,n),n.tag=3,n.payload={element:null};var s=t.value;return n.callback=function(){go||(go=!0,Pc=s),jc(e,t)},n}function np(e,t,n){n=Hn(-1,n),n.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var r=t.value;n.payload=function(){return s(r)},n.callback=function(){jc(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){jc(e,t),typeof s!="function"&&(ws===null?ws=new Set([this]):ws.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function Yu(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new Ey;var r=new Set;s.set(t,r)}else r=s.get(t),r===void 0&&(r=new Set,s.set(t,r));r.has(n)||(r.add(n),e=Wy.bind(null,e,t,n),t.then(e,e))}function Xu(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Ku(e,t,n,s,r){return e.mode&1?(e.flags|=65536,e.lanes=r,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Hn(-1,1),t.tag=2,xs(n,t,1))),n.lanes|=1),e)}var Ty=Qn.ReactCurrentOwner,$t=!1;function wt(e,t,n,s){t.child=e===null?Tm(t,null,n,s):Ua(t,e.child,n,s)}function Zu(e,t,n,s,r){n=n.render;var i=t.ref;return Pa(t,r),s=$d(e,t,n,s,i,r),n=Ed(),e!==null&&!$t?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Vn(e,t,r)):(Me&&n&&_d(t),t.flags|=1,wt(e,t,s,r),t.child)}function Ju(e,t,n,s,r){if(e===null){var i=n.type;return typeof i=="function"&&!Od(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,sp(e,t,i,s,r)):(e=Qi(n.type,null,s,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&r)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ar,n(o,s)&&e.ref===t.ref)return Vn(e,t,r)}return t.flags|=1,e=Ss(i,s),e.ref=t.ref,e.return=t,t.child=e}function sp(e,t,n,s,r){if(e!==null){var i=e.memoizedProps;if(Ar(i,s)&&e.ref===t.ref)if($t=!1,t.pendingProps=s=i,(e.lanes&r)!==0)e.flags&131072&&($t=!0);else return t.lanes=e.lanes,Vn(e,t,r)}return Sc(e,t,n,s,r)}function ap(e,t,n){var s=t.pendingProps,r=s.children,i=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ne(ba,Bt),Bt|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ne(ba,Bt),Bt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:n,Ne(ba,Bt),Bt|=s}else i!==null?(s=i.baseLanes|n,t.memoizedState=null):s=n,Ne(ba,Bt),Bt|=s;return wt(e,t,r,n),t.child}function rp(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Sc(e,t,n,s,r){var i=Tt(n)?Js:gt.current;return i=za(t,i),Pa(t,r),n=$d(e,t,n,s,i,r),s=Ed(),e!==null&&!$t?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Vn(e,t,r)):(Me&&s&&_d(t),t.flags|=1,wt(e,t,n,r),t.child)}function ef(e,t,n,s,r){if(Tt(n)){var i=!0;ro(t)}else i=!1;if(Pa(t,r),t.stateNode===null)Ui(e,t),ep(t,n,s),wc(t,n,s,r),s=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=nn(d):(d=Tt(n)?Js:gt.current,d=za(t,d));var f=n.getDerivedStateFromProps,h=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==s||c!==d)&&Qu(t,o,s,d),ss=!1;var p=t.memoizedState;o.state=p,uo(t,s,o,r),c=t.memoizedState,l!==s||p!==c||Et.current||ss?(typeof f=="function"&&(xc(t,n,f,s),c=t.memoizedState),(l=ss||Gu(t,n,l,s,p,c,d))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=c),o.props=s,o.state=c,o.context=d,s=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{o=t.stateNode,Mm(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:dn(t.type,l),o.props=d,h=t.pendingProps,p=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=nn(c):(c=Tt(n)?Js:gt.current,c=za(t,c));var _=n.getDerivedStateFromProps;(f=typeof _=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||p!==c)&&Qu(t,o,s,c),ss=!1,p=t.memoizedState,o.state=p,uo(t,s,o,r);var v=t.memoizedState;l!==h||p!==v||Et.current||ss?(typeof _=="function"&&(xc(t,n,_,s),v=t.memoizedState),(d=ss||Gu(t,n,d,s,p,v,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,v,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,v,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=v),o.props=s,o.state=v,o.context=c,s=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),s=!1)}return kc(e,t,n,s,i,r)}function kc(e,t,n,s,r,i){rp(e,t);var o=(t.flags&128)!==0;if(!s&&!o)return r&&Fu(t,n,!1),Vn(e,t,i);s=t.stateNode,Ty.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&o?(t.child=Ua(t,e.child,null,i),t.child=Ua(t,null,l,i)):wt(e,t,l,i),t.memoizedState=s.state,r&&Fu(t,n,!0),t.child}function ip(e){var t=e.stateNode;t.pendingContext?Bu(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Bu(e,t.context,!1),Nd(e,t.containerInfo)}function tf(e,t,n,s,r){return Wa(),vd(r),t.flags|=256,wt(e,t,n,s),t.child}var Nc={dehydrated:null,treeContext:null,retryLane:0};function bc(e){return{baseLanes:e,cachePool:null,transitions:null}}function op(e,t,n){var s=t.pendingProps,r=Ae.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(r&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(r|=1),Ne(Ae,r&1),e===null)return yc(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=s.children,e=s.fallback,i?(s=t.mode,i=t.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Oo(o,s,0,null),e=Zs(e,s,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=bc(n),t.memoizedState=Nc,e):Md(t,o));if(r=e.memoizedState,r!==null&&(l=r.dehydrated,l!==null))return Py(e,t,o,s,l,r,n);if(i){i=s.fallback,o=t.mode,r=e.child,l=r.sibling;var c={mode:"hidden",children:s.children};return!(o&1)&&t.child!==r?(s=t.child,s.childLanes=0,s.pendingProps=c,t.deletions=null):(s=Ss(r,c),s.subtreeFlags=r.subtreeFlags&14680064),l!==null?i=Ss(l,i):(i=Zs(i,o,n,null),i.flags|=2),i.return=t,s.return=t,s.sibling=i,t.child=s,s=i,i=t.child,o=e.child.memoizedState,o=o===null?bc(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~n,t.memoizedState=Nc,s}return i=e.child,e=i.sibling,s=Ss(i,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=n),s.return=t,s.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function Md(e,t){return t=Oo({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Si(e,t,n,s){return s!==null&&vd(s),Ua(t,e.child,null,n),e=Md(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Py(e,t,n,s,r,i,o){if(n)return t.flags&256?(t.flags&=-257,s=Sl(Error(U(422))),Si(e,t,o,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=s.fallback,r=t.mode,s=Oo({mode:"visible",children:s.children},r,0,null),i=Zs(i,r,o,null),i.flags|=2,s.return=t,i.return=t,s.sibling=i,t.child=s,t.mode&1&&Ua(t,e.child,null,o),t.child.memoizedState=bc(o),t.memoizedState=Nc,i);if(!(t.mode&1))return Si(e,t,o,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var l=s.dgst;return s=l,i=Error(U(419)),s=Sl(i,s,void 0),Si(e,t,o,s)}if(l=(o&e.childLanes)!==0,$t||l){if(s=nt,s!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|o)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,Un(e,r),_n(s,e,r,-1))}return Fd(),s=Sl(Error(U(421))),Si(e,t,o,s)}return r.data==="$?"?(t.flags|=128,t.child=e.child,t=Uy.bind(null,e),r._reactRetry=t,null):(e=i.treeContext,Ft=vs(r.nextSibling),Ot=t,Me=!0,pn=null,e!==null&&(Zt[Jt++]=Fn,Zt[Jt++]=On,Zt[Jt++]=ea,Fn=e.id,On=e.overflow,ea=t),t=Md(t,s.children),t.flags|=4096,t)}function nf(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),vc(e.return,t,n)}function kl(e,t,n,s,r){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=n,i.tailMode=r)}function lp(e,t,n){var s=t.pendingProps,r=s.revealOrder,i=s.tail;if(wt(e,t,s.children,n),s=Ae.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&nf(e,n,t);else if(e.tag===19)nf(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(Ne(Ae,s),!(t.mode&1))t.memoizedState=null;else switch(r){case"forwards":for(n=t.child,r=null;n!==null;)e=n.alternate,e!==null&&fo(e)===null&&(r=n),n=n.sibling;n=r,n===null?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),kl(t,!1,r,n,i);break;case"backwards":for(n=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&fo(e)===null){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}kl(t,!0,n,null,i);break;case"together":kl(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ui(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Vn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),na|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(U(153));if(t.child!==null){for(e=t.child,n=Ss(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Ss(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function My(e,t,n){switch(t.tag){case 3:ip(t),Wa();break;case 5:Im(t);break;case 1:Tt(t.type)&&ro(t);break;case 4:Nd(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,r=t.memoizedProps.value;Ne(lo,s._currentValue),s._currentValue=r;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(Ne(Ae,Ae.current&1),t.flags|=128,null):n&t.child.childLanes?op(e,t,n):(Ne(Ae,Ae.current&1),e=Vn(e,t,n),e!==null?e.sibling:null);Ne(Ae,Ae.current&1);break;case 19:if(s=(n&t.childLanes)!==0,e.flags&128){if(s)return lp(e,t,n);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Ne(Ae,Ae.current),s)break;return null;case 22:case 23:return t.lanes=0,ap(e,t,n)}return Vn(e,t,n)}var cp,Cc,dp,up;cp=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Cc=function(){};dp=function(e,t,n,s){var r=e.memoizedProps;if(r!==s){e=t.stateNode,zs(Mn.current);var i=null;switch(n){case"input":r=Yl(e,r),s=Yl(e,s),i=[];break;case"select":r=Be({},r,{value:void 0}),s=Be({},s,{value:void 0}),i=[];break;case"textarea":r=Zl(e,r),s=Zl(e,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=so)}ec(n,s);var o;n=null;for(d in r)if(!s.hasOwnProperty(d)&&r.hasOwnProperty(d)&&r[d]!=null)if(d==="style"){var l=r[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&($r.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in s){var c=s[d];if(l=r!=null?r[d]:void 0,s.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&($r.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&$e("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};up=function(e,t,n,s){n!==s&&(t.flags|=4)};function ir(e,t){if(!Me)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function ft(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var r=e.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function Iy(e,t,n){var s=t.pendingProps;switch(yd(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ft(t),null;case 1:return Tt(t.type)&&ao(),ft(t),null;case 3:return s=t.stateNode,Va(),Te(Et),Te(gt),Cd(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(wi(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,pn!==null&&(Lc(pn),pn=null))),Cc(e,t),ft(t),null;case 5:bd(t);var r=zs(Hr.current);if(n=t.type,e!==null&&t.stateNode!=null)dp(e,t,n,s,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(U(166));return ft(t),null}if(e=zs(Mn.current),wi(t)){s=t.stateNode,n=t.type;var i=t.memoizedProps;switch(s[Dn]=t,s[Fr]=i,e=(t.mode&1)!==0,n){case"dialog":$e("cancel",s),$e("close",s);break;case"iframe":case"object":case"embed":$e("load",s);break;case"video":case"audio":for(r=0;r<vr.length;r++)$e(vr[r],s);break;case"source":$e("error",s);break;case"img":case"image":case"link":$e("error",s),$e("load",s);break;case"details":$e("toggle",s);break;case"input":uu(s,i),$e("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},$e("invalid",s);break;case"textarea":hu(s,i),$e("invalid",s)}ec(n,i),r=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?s.textContent!==l&&(i.suppressHydrationWarning!==!0&&xi(s.textContent,l,e),r=["children",l]):typeof l=="number"&&s.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&xi(s.textContent,l,e),r=["children",""+l]):$r.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&$e("scroll",s)}switch(n){case"input":fi(s),fu(s,i,!0);break;case"textarea":fi(s),mu(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=so)}s=r,t.updateQueue=s,s!==null&&(t.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Fh(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=o.createElement(n,{is:s.is}):(e=o.createElement(n),n==="select"&&(o=e,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):e=o.createElementNS(e,n),e[Dn]=t,e[Fr]=s,cp(e,t,!1,!1),t.stateNode=e;e:{switch(o=tc(n,s),n){case"dialog":$e("cancel",e),$e("close",e),r=s;break;case"iframe":case"object":case"embed":$e("load",e),r=s;break;case"video":case"audio":for(r=0;r<vr.length;r++)$e(vr[r],e);r=s;break;case"source":$e("error",e),r=s;break;case"img":case"image":case"link":$e("error",e),$e("load",e),r=s;break;case"details":$e("toggle",e),r=s;break;case"input":uu(e,s),r=Yl(e,s),$e("invalid",e);break;case"option":r=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},r=Be({},s,{value:void 0}),$e("invalid",e);break;case"textarea":hu(e,s),r=Zl(e,s),$e("invalid",e);break;default:r=s}ec(n,r),l=r;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?qh(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Oh(e,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Er(e,c):typeof c=="number"&&Er(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&($r.hasOwnProperty(i)?c!=null&&i==="onScroll"&&$e("scroll",e):c!=null&&sd(e,i,c,o))}switch(n){case"input":fi(e),fu(e,s,!1);break;case"textarea":fi(e),mu(e);break;case"option":s.value!=null&&e.setAttribute("value",""+bs(s.value));break;case"select":e.multiple=!!s.multiple,i=s.value,i!=null?Da(e,!!s.multiple,i,!1):s.defaultValue!=null&&Da(e,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(e.onclick=so)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ft(t),null;case 6:if(e&&t.stateNode!=null)up(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(U(166));if(n=zs(Hr.current),zs(Mn.current),wi(t)){if(s=t.stateNode,n=t.memoizedProps,s[Dn]=t,(i=s.nodeValue!==n)&&(e=Ot,e!==null))switch(e.tag){case 3:xi(s.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&xi(s.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Dn]=t,t.stateNode=s}return ft(t),null;case 13:if(Te(Ae),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Me&&Ft!==null&&t.mode&1&&!(t.flags&128))$m(),Wa(),t.flags|=98560,i=!1;else if(i=wi(t),s!==null&&s.dehydrated!==null){if(e===null){if(!i)throw Error(U(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(U(317));i[Dn]=t}else Wa(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ft(t),i=!1}else pn!==null&&(Lc(pn),pn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||Ae.current&1?Ye===0&&(Ye=3):Fd())),t.updateQueue!==null&&(t.flags|=4),ft(t),null);case 4:return Va(),Cc(e,t),e===null&&Rr(t.stateNode.containerInfo),ft(t),null;case 10:return jd(t.type._context),ft(t),null;case 17:return Tt(t.type)&&ao(),ft(t),null;case 19:if(Te(Ae),i=t.memoizedState,i===null)return ft(t),null;if(s=(t.flags&128)!==0,o=i.rendering,o===null)if(s)ir(i,!1);else{if(Ye!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=fo(e),o!==null){for(t.flags|=128,ir(i,!1),s=o.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=n,n=t.child;n!==null;)i=n,e=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ne(Ae,Ae.current&1|2),t.child}e=e.sibling}i.tail!==null&&Ue()>Qa&&(t.flags|=128,s=!0,ir(i,!1),t.lanes=4194304)}else{if(!s)if(e=fo(o),e!==null){if(t.flags|=128,s=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),ir(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Me)return ft(t),null}else 2*Ue()-i.renderingStartTime>Qa&&n!==1073741824&&(t.flags|=128,s=!0,ir(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(n=i.last,n!==null?n.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ue(),t.sibling=null,n=Ae.current,Ne(Ae,s?n&1|2:n&1),t):(ft(t),null);case 22:case 23:return Bd(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?Bt&1073741824&&(ft(t),t.subtreeFlags&6&&(t.flags|=8192)):ft(t),null;case 24:return null;case 25:return null}throw Error(U(156,t.tag))}function Ly(e,t){switch(yd(t),t.tag){case 1:return Tt(t.type)&&ao(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Va(),Te(Et),Te(gt),Cd(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return bd(t),null;case 13:if(Te(Ae),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(U(340));Wa()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Te(Ae),null;case 4:return Va(),null;case 10:return jd(t.type._context),null;case 22:case 23:return Bd(),null;case 24:return null;default:return null}}var ki=!1,pt=!1,Ay=typeof WeakSet=="function"?WeakSet:Set,ee=null;function Na(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){qe(e,t,s)}else n.current=null}function Dc(e,t,n){try{n()}catch(s){qe(e,t,s)}}var sf=!1;function Ry(e,t){if(uc=eo,e=gm(),gd(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,d=0,f=0,h=e,p=null;t:for(;;){for(var _;h!==n||r!==0&&h.nodeType!==3||(l=o+r),h!==i||s!==0&&h.nodeType!==3||(c=o+s),h.nodeType===3&&(o+=h.nodeValue.length),(_=h.firstChild)!==null;)p=h,h=_;for(;;){if(h===e)break t;if(p===n&&++d===r&&(l=o),p===i&&++f===s&&(c=o),(_=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=_}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(fc={focusedElem:e,selectionRange:n},eo=!1,ee=t;ee!==null;)if(t=ee,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ee=e;else for(;ee!==null;){t=ee;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var u=v.memoizedProps,y=v.memoizedState,m=t.stateNode,x=m.getSnapshotBeforeUpdate(t.elementType===t.type?u:dn(t.type,u),y);m.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(b){qe(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,ee=e;break}ee=t.return}return v=sf,sf=!1,v}function br(e,t,n){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&e)===e){var i=r.destroy;r.destroy=void 0,i!==void 0&&Dc(t,n,i)}r=r.next}while(r!==s)}}function Bo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var s=n.create;n.destroy=s()}n=n.next}while(n!==t)}}function $c(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function fp(e){var t=e.alternate;t!==null&&(e.alternate=null,fp(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Dn],delete t[Fr],delete t[pc],delete t[vy],delete t[xy])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function hp(e){return e.tag===5||e.tag===3||e.tag===4}function af(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||hp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ec(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=so));else if(s!==4&&(e=e.child,e!==null))for(Ec(e,t,n),e=e.sibling;e!==null;)Ec(e,t,n),e=e.sibling}function Tc(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Tc(e,t,n),e=e.sibling;e!==null;)Tc(e,t,n),e=e.sibling}var ot=null,mn=!1;function Yn(e,t,n){for(n=n.child;n!==null;)mp(e,t,n),n=n.sibling}function mp(e,t,n){if(Pn&&typeof Pn.onCommitFiberUnmount=="function")try{Pn.onCommitFiberUnmount(Eo,n)}catch{}switch(n.tag){case 5:pt||Na(n,t);case 6:var s=ot,r=mn;ot=null,Yn(e,t,n),ot=s,mn=r,ot!==null&&(mn?(e=ot,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):ot.removeChild(n.stateNode));break;case 18:ot!==null&&(mn?(e=ot,n=n.stateNode,e.nodeType===8?_l(e.parentNode,n):e.nodeType===1&&_l(e,n),Ir(e)):_l(ot,n.stateNode));break;case 4:s=ot,r=mn,ot=n.stateNode.containerInfo,mn=!0,Yn(e,t,n),ot=s,mn=r;break;case 0:case 11:case 14:case 15:if(!pt&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Dc(n,t,o),r=r.next}while(r!==s)}Yn(e,t,n);break;case 1:if(!pt&&(Na(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(l){qe(n,t,l)}Yn(e,t,n);break;case 21:Yn(e,t,n);break;case 22:n.mode&1?(pt=(s=pt)||n.memoizedState!==null,Yn(e,t,n),pt=s):Yn(e,t,n);break;default:Yn(e,t,n)}}function rf(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Ay),t.forEach(function(s){var r=Vy.bind(null,e,s);n.has(s)||(n.add(s),s.then(r,r))})}}function rn(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:ot=l.stateNode,mn=!1;break e;case 3:ot=l.stateNode.containerInfo,mn=!0;break e;case 4:ot=l.stateNode.containerInfo,mn=!0;break e}l=l.return}if(ot===null)throw Error(U(160));mp(i,o,r),ot=null,mn=!1;var c=r.alternate;c!==null&&(c.return=null),r.return=null}catch(d){qe(r,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)pp(t,e),t=t.sibling}function pp(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(rn(t,e),vn(e),s&4){try{br(3,e,e.return),Bo(3,e)}catch(u){qe(e,e.return,u)}try{br(5,e,e.return)}catch(u){qe(e,e.return,u)}}break;case 1:rn(t,e),vn(e),s&512&&n!==null&&Na(n,n.return);break;case 5:if(rn(t,e),vn(e),s&512&&n!==null&&Na(n,n.return),e.flags&32){var r=e.stateNode;try{Er(r,"")}catch(u){qe(e,e.return,u)}}if(s&4&&(r=e.stateNode,r!=null)){var i=e.memoizedProps,o=n!==null?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Rh(r,i),tc(l,o);var d=tc(l,i);for(o=0;o<c.length;o+=2){var f=c[o],h=c[o+1];f==="style"?qh(r,h):f==="dangerouslySetInnerHTML"?Oh(r,h):f==="children"?Er(r,h):sd(r,f,h,d)}switch(l){case"input":Xl(r,i);break;case"textarea":Bh(r,i);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var _=i.value;_!=null?Da(r,!!i.multiple,_,!1):p!==!!i.multiple&&(i.defaultValue!=null?Da(r,!!i.multiple,i.defaultValue,!0):Da(r,!!i.multiple,i.multiple?[]:"",!1))}r[Fr]=i}catch(u){qe(e,e.return,u)}}break;case 6:if(rn(t,e),vn(e),s&4){if(e.stateNode===null)throw Error(U(162));r=e.stateNode,i=e.memoizedProps;try{r.nodeValue=i}catch(u){qe(e,e.return,u)}}break;case 3:if(rn(t,e),vn(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{Ir(t.containerInfo)}catch(u){qe(e,e.return,u)}break;case 4:rn(t,e),vn(e);break;case 13:rn(t,e),vn(e),r=e.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(Ad=Ue())),s&4&&rf(e);break;case 22:if(f=n!==null&&n.memoizedState!==null,e.mode&1?(pt=(d=pt)||f,rn(t,e),pt=d):rn(t,e),vn(e),s&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!f&&e.mode&1)for(ee=e,f=e.child;f!==null;){for(h=ee=f;ee!==null;){switch(p=ee,_=p.child,p.tag){case 0:case 11:case 14:case 15:br(4,p,p.return);break;case 1:Na(p,p.return);var v=p.stateNode;if(typeof v.componentWillUnmount=="function"){s=p,n=p.return;try{t=s,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(u){qe(s,n,u)}}break;case 5:Na(p,p.return);break;case 22:if(p.memoizedState!==null){lf(h);continue}}_!==null?(_.return=p,ee=_):lf(h)}f=f.sibling}e:for(f=null,h=e;;){if(h.tag===5){if(f===null){f=h;try{r=h.stateNode,d?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Hh("display",o))}catch(u){qe(e,e.return,u)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(u){qe(e,e.return,u)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:rn(t,e),vn(e),s&4&&rf(e);break;case 21:break;default:rn(t,e),vn(e)}}function vn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(hp(n)){var s=n;break e}n=n.return}throw Error(U(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(Er(r,""),s.flags&=-33);var i=af(e);Tc(e,i,r);break;case 3:case 4:var o=s.stateNode.containerInfo,l=af(e);Ec(e,l,o);break;default:throw Error(U(161))}}catch(c){qe(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function By(e,t,n){ee=e,gp(e)}function gp(e,t,n){for(var s=(e.mode&1)!==0;ee!==null;){var r=ee,i=r.child;if(r.tag===22&&s){var o=r.memoizedState!==null||ki;if(!o){var l=r.alternate,c=l!==null&&l.memoizedState!==null||pt;l=ki;var d=pt;if(ki=o,(pt=c)&&!d)for(ee=r;ee!==null;)o=ee,c=o.child,o.tag===22&&o.memoizedState!==null?cf(r):c!==null?(c.return=o,ee=c):cf(r);for(;i!==null;)ee=i,gp(i),i=i.sibling;ee=r,ki=l,pt=d}of(e)}else r.subtreeFlags&8772&&i!==null?(i.return=r,ee=i):of(e)}}function of(e){for(;ee!==null;){var t=ee;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:pt||Bo(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!pt)if(n===null)s.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:dn(t.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Wu(t,i,s);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Wu(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&Ir(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}pt||t.flags&512&&$c(t)}catch(p){qe(t,t.return,p)}}if(t===e){ee=null;break}if(n=t.sibling,n!==null){n.return=t.return,ee=n;break}ee=t.return}}function lf(e){for(;ee!==null;){var t=ee;if(t===e){ee=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ee=n;break}ee=t.return}}function cf(e){for(;ee!==null;){var t=ee;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Bo(4,t)}catch(c){qe(t,n,c)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var r=t.return;try{s.componentDidMount()}catch(c){qe(t,r,c)}}var i=t.return;try{$c(t)}catch(c){qe(t,i,c)}break;case 5:var o=t.return;try{$c(t)}catch(c){qe(t,o,c)}}}catch(c){qe(t,t.return,c)}if(t===e){ee=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ee=l;break}ee=t.return}}var Fy=Math.ceil,po=Qn.ReactCurrentDispatcher,Id=Qn.ReactCurrentOwner,tn=Qn.ReactCurrentBatchConfig,_e=0,nt=null,Ge=null,lt=0,Bt=0,ba=Es(0),Ye=0,Ur=null,na=0,Fo=0,Ld=0,Cr=null,Dt=null,Ad=0,Qa=1/0,An=null,go=!1,Pc=null,ws=null,Ni=!1,ps=null,_o=0,Dr=0,Mc=null,Vi=-1,Gi=0;function St(){return _e&6?Ue():Vi!==-1?Vi:Vi=Ue()}function js(e){return e.mode&1?_e&2&&lt!==0?lt&-lt:jy.transition!==null?(Gi===0&&(Gi=em()),Gi):(e=je,e!==0||(e=window.event,e=e===void 0?16:om(e.type)),e):1}function _n(e,t,n,s){if(50<Dr)throw Dr=0,Mc=null,Error(U(185));Zr(e,n,s),(!(_e&2)||e!==nt)&&(e===nt&&(!(_e&2)&&(Fo|=n),Ye===4&&is(e,lt)),Pt(e,s),n===1&&_e===0&&!(t.mode&1)&&(Qa=Ue()+500,Lo&&Ts()))}function Pt(e,t){var n=e.callbackNode;j_(e,t);var s=Ji(e,e===nt?lt:0);if(s===0)n!==null&&_u(n),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(n!=null&&_u(n),t===1)e.tag===0?wy(df.bind(null,e)):bm(df.bind(null,e)),_y(function(){!(_e&6)&&Ts()}),n=null;else{switch(tm(s)){case 1:n=ld;break;case 4:n=Zh;break;case 16:n=Zi;break;case 536870912:n=Jh;break;default:n=Zi}n=kp(n,_p.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function _p(e,t){if(Vi=-1,Gi=0,_e&6)throw Error(U(327));var n=e.callbackNode;if(Ma()&&e.callbackNode!==n)return null;var s=Ji(e,e===nt?lt:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=yo(e,s);else{t=s;var r=_e;_e|=2;var i=vp();(nt!==e||lt!==t)&&(An=null,Qa=Ue()+500,Ks(e,t));do try{qy();break}catch(l){yp(e,l)}while(!0);wd(),po.current=i,_e=r,Ge!==null?t=0:(nt=null,lt=0,t=Ye)}if(t!==0){if(t===2&&(r=ic(e),r!==0&&(s=r,t=Ic(e,r))),t===1)throw n=Ur,Ks(e,0),is(e,s),Pt(e,Ue()),n;if(t===6)is(e,s);else{if(r=e.current.alternate,!(s&30)&&!Oy(r)&&(t=yo(e,s),t===2&&(i=ic(e),i!==0&&(s=i,t=Ic(e,i))),t===1))throw n=Ur,Ks(e,0),is(e,s),Pt(e,Ue()),n;switch(e.finishedWork=r,e.finishedLanes=s,t){case 0:case 1:throw Error(U(345));case 2:Fs(e,Dt,An);break;case 3:if(is(e,s),(s&130023424)===s&&(t=Ad+500-Ue(),10<t)){if(Ji(e,0)!==0)break;if(r=e.suspendedLanes,(r&s)!==s){St(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=mc(Fs.bind(null,e,Dt,An),t);break}Fs(e,Dt,An);break;case 4:if(is(e,s),(s&4194240)===s)break;for(t=e.eventTimes,r=-1;0<s;){var o=31-gn(s);i=1<<o,o=t[o],o>r&&(r=o),s&=~i}if(s=r,s=Ue()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*Fy(s/1960))-s,10<s){e.timeoutHandle=mc(Fs.bind(null,e,Dt,An),s);break}Fs(e,Dt,An);break;case 5:Fs(e,Dt,An);break;default:throw Error(U(329))}}}return Pt(e,Ue()),e.callbackNode===n?_p.bind(null,e):null}function Ic(e,t){var n=Cr;return e.current.memoizedState.isDehydrated&&(Ks(e,t).flags|=256),e=yo(e,t),e!==2&&(t=Dt,Dt=n,t!==null&&Lc(t)),e}function Lc(e){Dt===null?Dt=e:Dt.push.apply(Dt,e)}function Oy(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],i=r.getSnapshot;r=r.value;try{if(!yn(i(),r))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function is(e,t){for(t&=~Ld,t&=~Fo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-gn(t),s=1<<n;e[n]=-1,t&=~s}}function df(e){if(_e&6)throw Error(U(327));Ma();var t=Ji(e,0);if(!(t&1))return Pt(e,Ue()),null;var n=yo(e,t);if(e.tag!==0&&n===2){var s=ic(e);s!==0&&(t=s,n=Ic(e,s))}if(n===1)throw n=Ur,Ks(e,0),is(e,t),Pt(e,Ue()),n;if(n===6)throw Error(U(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Fs(e,Dt,An),Pt(e,Ue()),null}function Rd(e,t){var n=_e;_e|=1;try{return e(t)}finally{_e=n,_e===0&&(Qa=Ue()+500,Lo&&Ts())}}function sa(e){ps!==null&&ps.tag===0&&!(_e&6)&&Ma();var t=_e;_e|=1;var n=tn.transition,s=je;try{if(tn.transition=null,je=1,e)return e()}finally{je=s,tn.transition=n,_e=t,!(_e&6)&&Ts()}}function Bd(){Bt=ba.current,Te(ba)}function Ks(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,gy(n)),Ge!==null)for(n=Ge.return;n!==null;){var s=n;switch(yd(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&ao();break;case 3:Va(),Te(Et),Te(gt),Cd();break;case 5:bd(s);break;case 4:Va();break;case 13:Te(Ae);break;case 19:Te(Ae);break;case 10:jd(s.type._context);break;case 22:case 23:Bd()}n=n.return}if(nt=e,Ge=e=Ss(e.current,null),lt=Bt=t,Ye=0,Ur=null,Ld=Fo=na=0,Dt=Cr=null,qs!==null){for(t=0;t<qs.length;t++)if(n=qs[t],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,i=n.pending;if(i!==null){var o=i.next;i.next=r,s.next=o}n.pending=s}qs=null}return e}function yp(e,t){do{var n=Ge;try{if(wd(),zi.current=mo,ho){for(var s=Re.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}ho=!1}if(ta=0,tt=Qe=Re=null,Nr=!1,qr=0,Id.current=null,n===null||n.return===null){Ye=1,Ur=t,Ge=null;break}e:{var i=e,o=n.return,l=n,c=t;if(t=lt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,f=l,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var p=f.alternate;p?(f.updateQueue=p.updateQueue,f.memoizedState=p.memoizedState,f.lanes=p.lanes):(f.updateQueue=null,f.memoizedState=null)}var _=Xu(o);if(_!==null){_.flags&=-257,Ku(_,o,l,i,t),_.mode&1&&Yu(i,d,t),t=_,c=d;var v=t.updateQueue;if(v===null){var u=new Set;u.add(c),t.updateQueue=u}else v.add(c);break e}else{if(!(t&1)){Yu(i,d,t),Fd();break e}c=Error(U(426))}}else if(Me&&l.mode&1){var y=Xu(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),Ku(y,o,l,i,t),vd(Ga(c,l));break e}}i=c=Ga(c,l),Ye!==4&&(Ye=2),Cr===null?Cr=[i]:Cr.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var m=tp(i,c,t);zu(i,m);break e;case 1:l=c;var x=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof x.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(ws===null||!ws.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var b=np(i,l,t);zu(i,b);break e}}i=i.return}while(i!==null)}wp(n)}catch(S){t=S,Ge===n&&n!==null&&(Ge=n=n.return);continue}break}while(!0)}function vp(){var e=po.current;return po.current=mo,e===null?mo:e}function Fd(){(Ye===0||Ye===3||Ye===2)&&(Ye=4),nt===null||!(na&268435455)&&!(Fo&268435455)||is(nt,lt)}function yo(e,t){var n=_e;_e|=2;var s=vp();(nt!==e||lt!==t)&&(An=null,Ks(e,t));do try{Hy();break}catch(r){yp(e,r)}while(!0);if(wd(),_e=n,po.current=s,Ge!==null)throw Error(U(261));return nt=null,lt=0,Ye}function Hy(){for(;Ge!==null;)xp(Ge)}function qy(){for(;Ge!==null&&!h_();)xp(Ge)}function xp(e){var t=Sp(e.alternate,e,Bt);e.memoizedProps=e.pendingProps,t===null?wp(e):Ge=t,Id.current=null}function wp(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Ly(n,t),n!==null){n.flags&=32767,Ge=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ye=6,Ge=null;return}}else if(n=Iy(n,t,Bt),n!==null){Ge=n;return}if(t=t.sibling,t!==null){Ge=t;return}Ge=t=e}while(t!==null);Ye===0&&(Ye=5)}function Fs(e,t,n){var s=je,r=tn.transition;try{tn.transition=null,je=1,zy(e,t,n,s)}finally{tn.transition=r,je=s}return null}function zy(e,t,n,s){do Ma();while(ps!==null);if(_e&6)throw Error(U(327));n=e.finishedWork;var r=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(U(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(S_(e,i),e===nt&&(Ge=nt=null,lt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ni||(Ni=!0,kp(Zi,function(){return Ma(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=tn.transition,tn.transition=null;var o=je;je=1;var l=_e;_e|=4,Id.current=null,Ry(e,n),pp(n,e),cy(fc),eo=!!uc,fc=uc=null,e.current=n,By(n),m_(),_e=l,je=o,tn.transition=i}else e.current=n;if(Ni&&(Ni=!1,ps=e,_o=r),i=e.pendingLanes,i===0&&(ws=null),__(n.stateNode),Pt(e,Ue()),t!==null)for(s=e.onRecoverableError,n=0;n<t.length;n++)r=t[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(go)throw go=!1,e=Pc,Pc=null,e;return _o&1&&e.tag!==0&&Ma(),i=e.pendingLanes,i&1?e===Mc?Dr++:(Dr=0,Mc=e):Dr=0,Ts(),null}function Ma(){if(ps!==null){var e=tm(_o),t=tn.transition,n=je;try{if(tn.transition=null,je=16>e?16:e,ps===null)var s=!1;else{if(e=ps,ps=null,_o=0,_e&6)throw Error(U(331));var r=_e;for(_e|=4,ee=e.current;ee!==null;){var i=ee,o=i.child;if(ee.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(ee=d;ee!==null;){var f=ee;switch(f.tag){case 0:case 11:case 15:br(8,f,i)}var h=f.child;if(h!==null)h.return=f,ee=h;else for(;ee!==null;){f=ee;var p=f.sibling,_=f.return;if(fp(f),f===d){ee=null;break}if(p!==null){p.return=_,ee=p;break}ee=_}}}var v=i.alternate;if(v!==null){var u=v.child;if(u!==null){v.child=null;do{var y=u.sibling;u.sibling=null,u=y}while(u!==null)}}ee=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ee=o;else e:for(;ee!==null;){if(i=ee,i.flags&2048)switch(i.tag){case 0:case 11:case 15:br(9,i,i.return)}var m=i.sibling;if(m!==null){m.return=i.return,ee=m;break e}ee=i.return}}var x=e.current;for(ee=x;ee!==null;){o=ee;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,ee=w;else e:for(o=x;ee!==null;){if(l=ee,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Bo(9,l)}}catch(S){qe(l,l.return,S)}if(l===o){ee=null;break e}var b=l.sibling;if(b!==null){b.return=l.return,ee=b;break e}ee=l.return}}if(_e=r,Ts(),Pn&&typeof Pn.onPostCommitFiberRoot=="function")try{Pn.onPostCommitFiberRoot(Eo,e)}catch{}s=!0}return s}finally{je=n,tn.transition=t}}return!1}function uf(e,t,n){t=Ga(n,t),t=tp(e,t,1),e=xs(e,t,1),t=St(),e!==null&&(Zr(e,1,t),Pt(e,t))}function qe(e,t,n){if(e.tag===3)uf(e,e,n);else for(;t!==null;){if(t.tag===3){uf(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(ws===null||!ws.has(s))){e=Ga(n,e),e=np(t,e,1),t=xs(t,e,1),e=St(),t!==null&&(Zr(t,1,e),Pt(t,e));break}}t=t.return}}function Wy(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),t=St(),e.pingedLanes|=e.suspendedLanes&n,nt===e&&(lt&n)===n&&(Ye===4||Ye===3&&(lt&130023424)===lt&&500>Ue()-Ad?Ks(e,0):Ld|=n),Pt(e,t)}function jp(e,t){t===0&&(e.mode&1?(t=pi,pi<<=1,!(pi&130023424)&&(pi=4194304)):t=1);var n=St();e=Un(e,t),e!==null&&(Zr(e,t,n),Pt(e,n))}function Uy(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),jp(e,n)}function Vy(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,r=e.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(U(314))}s!==null&&s.delete(t),jp(e,n)}var Sp;Sp=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Et.current)$t=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return $t=!1,My(e,t,n);$t=!!(e.flags&131072)}else $t=!1,Me&&t.flags&1048576&&Cm(t,oo,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Ui(e,t),e=t.pendingProps;var r=za(t,gt.current);Pa(t,n),r=$d(null,t,s,e,r,n);var i=Ed();return t.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Tt(s)?(i=!0,ro(t)):i=!1,t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,kd(t),r.updater=Ro,t.stateNode=r,r._reactInternals=t,wc(t,s,e,n),t=kc(null,t,s,!0,i,n)):(t.tag=0,Me&&i&&_d(t),wt(null,t,r,n),t=t.child),t;case 16:s=t.elementType;e:{switch(Ui(e,t),e=t.pendingProps,r=s._init,s=r(s._payload),t.type=s,r=t.tag=Qy(s),e=dn(s,e),r){case 0:t=Sc(null,t,s,e,n);break e;case 1:t=ef(null,t,s,e,n);break e;case 11:t=Zu(null,t,s,e,n);break e;case 14:t=Ju(null,t,s,dn(s.type,e),n);break e}throw Error(U(306,s,""))}return t;case 0:return s=t.type,r=t.pendingProps,r=t.elementType===s?r:dn(s,r),Sc(e,t,s,r,n);case 1:return s=t.type,r=t.pendingProps,r=t.elementType===s?r:dn(s,r),ef(e,t,s,r,n);case 3:e:{if(ip(t),e===null)throw Error(U(387));s=t.pendingProps,i=t.memoizedState,r=i.element,Mm(e,t),uo(t,s,null,n);var o=t.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){r=Ga(Error(U(423)),t),t=tf(e,t,s,n,r);break e}else if(s!==r){r=Ga(Error(U(424)),t),t=tf(e,t,s,n,r);break e}else for(Ft=vs(t.stateNode.containerInfo.firstChild),Ot=t,Me=!0,pn=null,n=Tm(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Wa(),s===r){t=Vn(e,t,n);break e}wt(e,t,s,n)}t=t.child}return t;case 5:return Im(t),e===null&&yc(t),s=t.type,r=t.pendingProps,i=e!==null?e.memoizedProps:null,o=r.children,hc(s,r)?o=null:i!==null&&hc(s,i)&&(t.flags|=32),rp(e,t),wt(e,t,o,n),t.child;case 6:return e===null&&yc(t),null;case 13:return op(e,t,n);case 4:return Nd(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=Ua(t,null,s,n):wt(e,t,s,n),t.child;case 11:return s=t.type,r=t.pendingProps,r=t.elementType===s?r:dn(s,r),Zu(e,t,s,r,n);case 7:return wt(e,t,t.pendingProps,n),t.child;case 8:return wt(e,t,t.pendingProps.children,n),t.child;case 12:return wt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(s=t.type._context,r=t.pendingProps,i=t.memoizedProps,o=r.value,Ne(lo,s._currentValue),s._currentValue=o,i!==null)if(yn(i.value,o)){if(i.children===r.children&&!Et.current){t=Vn(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===s){if(i.tag===1){c=Hn(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?c.next=c:(c.next=f.next,f.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),vc(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(U(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),vc(o,n,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}wt(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,s=t.pendingProps.children,Pa(t,n),r=nn(r),s=s(r),t.flags|=1,wt(e,t,s,n),t.child;case 14:return s=t.type,r=dn(s,t.pendingProps),r=dn(s.type,r),Ju(e,t,s,r,n);case 15:return sp(e,t,t.type,t.pendingProps,n);case 17:return s=t.type,r=t.pendingProps,r=t.elementType===s?r:dn(s,r),Ui(e,t),t.tag=1,Tt(s)?(e=!0,ro(t)):e=!1,Pa(t,n),ep(t,s,r),wc(t,s,r,n),kc(null,t,s,!0,e,n);case 19:return lp(e,t,n);case 22:return ap(e,t,n)}throw Error(U(156,t.tag))};function kp(e,t){return Kh(e,t)}function Gy(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function en(e,t,n,s){return new Gy(e,t,n,s)}function Od(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Qy(e){if(typeof e=="function")return Od(e)?1:0;if(e!=null){if(e=e.$$typeof,e===rd)return 11;if(e===id)return 14}return 2}function Ss(e,t){var n=e.alternate;return n===null?(n=en(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Qi(e,t,n,s,r,i){var o=2;if(s=e,typeof e=="function")Od(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case ga:return Zs(n.children,r,i,t);case ad:o=8,r|=8;break;case Ul:return e=en(12,n,t,r|2),e.elementType=Ul,e.lanes=i,e;case Vl:return e=en(13,n,t,r),e.elementType=Vl,e.lanes=i,e;case Gl:return e=en(19,n,t,r),e.elementType=Gl,e.lanes=i,e;case Ih:return Oo(n,r,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ph:o=10;break e;case Mh:o=9;break e;case rd:o=11;break e;case id:o=14;break e;case ns:o=16,s=null;break e}throw Error(U(130,e==null?e:typeof e,""))}return t=en(o,n,t,r),t.elementType=e,t.type=s,t.lanes=i,t}function Zs(e,t,n,s){return e=en(7,e,s,t),e.lanes=n,e}function Oo(e,t,n,s){return e=en(22,e,s,t),e.elementType=Ih,e.lanes=n,e.stateNode={isHidden:!1},e}function Nl(e,t,n){return e=en(6,e,null,t),e.lanes=n,e}function bl(e,t,n){return t=en(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Yy(e,t,n,s,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=il(0),this.expirationTimes=il(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=il(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Hd(e,t,n,s,r,i,o,l,c){return e=new Yy(e,t,n,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=en(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},kd(i),e}function Xy(e,t,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:pa,key:s==null?null:""+s,children:e,containerInfo:t,implementation:n}}function Np(e){if(!e)return Cs;e=e._reactInternals;e:{if(ra(e)!==e||e.tag!==1)throw Error(U(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Tt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(U(171))}if(e.tag===1){var n=e.type;if(Tt(n))return Nm(e,n,t)}return t}function bp(e,t,n,s,r,i,o,l,c){return e=Hd(n,s,!0,e,r,i,o,l,c),e.context=Np(null),n=e.current,s=St(),r=js(n),i=Hn(s,r),i.callback=t??null,xs(n,i,r),e.current.lanes=r,Zr(e,r,s),Pt(e,s),e}function Ho(e,t,n,s){var r=t.current,i=St(),o=js(r);return n=Np(n),t.context===null?t.context=n:t.pendingContext=n,t=Hn(i,o),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=xs(r,t,o),e!==null&&(_n(e,r,o,i),qi(e,r,o)),o}function vo(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function ff(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function qd(e,t){ff(e,t),(e=e.alternate)&&ff(e,t)}function Ky(){return null}var Cp=typeof reportError=="function"?reportError:function(e){console.error(e)};function zd(e){this._internalRoot=e}qo.prototype.render=zd.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(U(409));Ho(e,t,null,null)};qo.prototype.unmount=zd.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;sa(function(){Ho(null,e,null,null)}),t[Wn]=null}};function qo(e){this._internalRoot=e}qo.prototype.unstable_scheduleHydration=function(e){if(e){var t=am();e={blockedOn:null,target:e,priority:t};for(var n=0;n<rs.length&&t!==0&&t<rs[n].priority;n++);rs.splice(n,0,e),n===0&&im(e)}};function Wd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function zo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function hf(){}function Zy(e,t,n,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var d=vo(o);i.call(d)}}var o=bp(t,s,e,0,null,!1,!1,"",hf);return e._reactRootContainer=o,e[Wn]=o.current,Rr(e.nodeType===8?e.parentNode:e),sa(),o}for(;r=e.lastChild;)e.removeChild(r);if(typeof s=="function"){var l=s;s=function(){var d=vo(c);l.call(d)}}var c=Hd(e,0,!1,null,null,!1,!1,"",hf);return e._reactRootContainer=c,e[Wn]=c.current,Rr(e.nodeType===8?e.parentNode:e),sa(function(){Ho(t,c,n,s)}),c}function Wo(e,t,n,s,r){var i=n._reactRootContainer;if(i){var o=i;if(typeof r=="function"){var l=r;r=function(){var c=vo(o);l.call(c)}}Ho(t,o,e,r)}else o=Zy(n,t,e,r,s);return vo(o)}nm=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=yr(t.pendingLanes);n!==0&&(cd(t,n|1),Pt(t,Ue()),!(_e&6)&&(Qa=Ue()+500,Ts()))}break;case 13:sa(function(){var s=Un(e,1);if(s!==null){var r=St();_n(s,e,1,r)}}),qd(e,1)}};dd=function(e){if(e.tag===13){var t=Un(e,134217728);if(t!==null){var n=St();_n(t,e,134217728,n)}qd(e,134217728)}};sm=function(e){if(e.tag===13){var t=js(e),n=Un(e,t);if(n!==null){var s=St();_n(n,e,t,s)}qd(e,t)}};am=function(){return je};rm=function(e,t){var n=je;try{return je=e,t()}finally{je=n}};sc=function(e,t,n){switch(t){case"input":if(Xl(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var r=Io(s);if(!r)throw Error(U(90));Ah(s),Xl(s,r)}}}break;case"textarea":Bh(e,n);break;case"select":t=n.value,t!=null&&Da(e,!!n.multiple,t,!1)}};Uh=Rd;Vh=sa;var Jy={usingClientEntryPoint:!1,Events:[ei,xa,Io,zh,Wh,Rd]},or={findFiberByHostInstance:Hs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},e1={bundleType:or.bundleType,version:or.version,rendererPackageName:or.rendererPackageName,rendererConfig:or.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Qn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Yh(e),e===null?null:e.stateNode},findFiberByHostInstance:or.findFiberByHostInstance||Ky,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bi.isDisabled&&bi.supportsFiber)try{Eo=bi.inject(e1),Pn=bi}catch{}}zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Jy;zt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Wd(t))throw Error(U(200));return Xy(e,t,null,n)};zt.createRoot=function(e,t){if(!Wd(e))throw Error(U(299));var n=!1,s="",r=Cp;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(r=t.onRecoverableError)),t=Hd(e,1,!1,null,null,n,!1,s,r),e[Wn]=t.current,Rr(e.nodeType===8?e.parentNode:e),new zd(t)};zt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(U(188)):(e=Object.keys(e).join(","),Error(U(268,e)));return e=Yh(t),e=e===null?null:e.stateNode,e};zt.flushSync=function(e){return sa(e)};zt.hydrate=function(e,t,n){if(!zo(t))throw Error(U(200));return Wo(null,e,t,!0,n)};zt.hydrateRoot=function(e,t,n){if(!Wd(e))throw Error(U(405));var s=n!=null&&n.hydratedSources||null,r=!1,i="",o=Cp;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=bp(t,null,e,1,n??null,r,!1,i,o),e[Wn]=t.current,Rr(e),s)for(e=0;e<s.length;e++)n=s[e],r=n._getVersion,r=r(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new qo(t)};zt.render=function(e,t,n){if(!zo(t))throw Error(U(200));return Wo(null,e,t,!1,n)};zt.unmountComponentAtNode=function(e){if(!zo(e))throw Error(U(40));return e._reactRootContainer?(sa(function(){Wo(null,null,e,!1,function(){e._reactRootContainer=null,e[Wn]=null})}),!0):!1};zt.unstable_batchedUpdates=Rd;zt.unstable_renderSubtreeIntoContainer=function(e,t,n,s){if(!zo(n))throw Error(U(200));if(e==null||e._reactInternals===void 0)throw Error(U(38));return Wo(e,t,n,!1,s)};zt.version="18.3.1-next-f1338f8080-20240426";function Dp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Dp)}catch(e){console.error(e)}}Dp(),Dh.exports=zt;var Ud=Dh.exports,$p,mf=Ud;$p=mf.createRoot,mf.hydrateRoot;var Uo=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},t1={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},ls,Xc,lh,n1=(lh=class{constructor(){pe(this,ls,t1);pe(this,Xc,!1)}setTimeoutProvider(e){ie(this,ls,e)}setTimeout(e,t){return W(this,ls).setTimeout(e,t)}clearTimeout(e){W(this,ls).clearTimeout(e)}setInterval(e,t){return W(this,ls).setInterval(e,t)}clearInterval(e){W(this,ls).clearInterval(e)}},ls=new WeakMap,Xc=new WeakMap,lh),Ac=new n1;function s1(e){setTimeout(e,0)}var Vo=typeof window>"u"||"Deno"in globalThis;function un(){}function a1(e,t){return typeof e=="function"?e(t):e}function r1(e){return typeof e=="number"&&e>=0&&e!==1/0}function i1(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Rc(e,t){return typeof e=="function"?e(t):e}function o1(e,t){return typeof e=="function"?e(t):e}function pf(e,t){const{type:n="all",exact:s,fetchStatus:r,predicate:i,queryKey:o,stale:l}=e;if(o){if(s){if(t.queryHash!==Vd(o,t.options))return!1}else if(!Gr(t.queryKey,o))return!1}if(n!=="all"){const c=t.isActive();if(n==="active"&&!c||n==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||r&&r!==t.state.fetchStatus||i&&!i(t))}function gf(e,t){const{exact:n,status:s,predicate:r,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(Vr(t.options.mutationKey)!==Vr(i))return!1}else if(!Gr(t.options.mutationKey,i))return!1}return!(s&&t.state.status!==s||r&&!r(t))}function Vd(e,t){return((t==null?void 0:t.queryKeyHashFn)||Vr)(e)}function Vr(e){return JSON.stringify(e,(t,n)=>Bc(n)?Object.keys(n).sort().reduce((s,r)=>(s[r]=n[r],s),{}):n)}function Gr(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>Gr(e[n],t[n])):!1}var l1=Object.prototype.hasOwnProperty;function Ep(e,t){if(e===t)return e;const n=_f(e)&&_f(t);if(!n&&!(Bc(e)&&Bc(t)))return t;const r=(n?e:Object.keys(e)).length,i=n?t:Object.keys(t),o=i.length,l=n?new Array(o):{};let c=0;for(let d=0;d<o;d++){const f=n?d:i[d],h=e[f],p=t[f];if(h===p){l[f]=h,(n?d<r:l1.call(e,f))&&c++;continue}if(h===null||p===null||typeof h!="object"||typeof p!="object"){l[f]=p;continue}const _=Ep(h,p);l[f]=_,_===h&&c++}return r===o&&c===r?e:l}function _f(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Bc(e){if(!yf(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!yf(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function yf(e){return Object.prototype.toString.call(e)==="[object Object]"}function c1(e){return new Promise(t=>{Ac.setTimeout(t,e)})}function d1(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?Ep(e,t):t}function u1(e,t,n=0){const s=[...e,t];return n&&s.length>n?s.slice(1):s}function f1(e,t,n=0){const s=[t,...e];return n&&s.length>n?s.slice(0,-1):s}var Gd=Symbol();function Tp(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===Gd?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Us,cs,Ia,ch,h1=(ch=class extends Uo{constructor(){super();pe(this,Us);pe(this,cs);pe(this,Ia);ie(this,Ia,t=>{if(!Vo&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){W(this,cs)||this.setEventListener(W(this,Ia))}onUnsubscribe(){var t;this.hasListeners()||((t=W(this,cs))==null||t.call(this),ie(this,cs,void 0))}setEventListener(t){var n;ie(this,Ia,t),(n=W(this,cs))==null||n.call(this),ie(this,cs,t(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(t){W(this,Us)!==t&&(ie(this,Us,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof W(this,Us)=="boolean"?W(this,Us):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Us=new WeakMap,cs=new WeakMap,Ia=new WeakMap,ch),Pp=new h1;function m1(){let e,t;const n=new Promise((r,i)=>{e=r,t=i});n.status="pending",n.catch(()=>{});function s(r){Object.assign(n,r),delete n.resolve,delete n.reject}return n.resolve=r=>{s({status:"fulfilled",value:r}),e(r)},n.reject=r=>{s({status:"rejected",reason:r}),t(r)},n}var p1=s1;function g1(){let e=[],t=0,n=l=>{l()},s=l=>{l()},r=p1;const i=l=>{t?e.push(l):r(()=>{n(l)})},o=()=>{const l=e;e=[],l.length&&r(()=>{s(()=>{l.forEach(c=>{n(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||o()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{n=l},setBatchNotifyFunction:l=>{s=l},setScheduler:l=>{r=l}}}var jt=g1(),La,ds,Aa,dh,_1=(dh=class extends Uo{constructor(){super();pe(this,La,!0);pe(this,ds);pe(this,Aa);ie(this,Aa,t=>{if(!Vo&&window.addEventListener){const n=()=>t(!0),s=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}})}onSubscribe(){W(this,ds)||this.setEventListener(W(this,Aa))}onUnsubscribe(){var t;this.hasListeners()||((t=W(this,ds))==null||t.call(this),ie(this,ds,void 0))}setEventListener(t){var n;ie(this,Aa,t),(n=W(this,ds))==null||n.call(this),ie(this,ds,t(this.setOnline.bind(this)))}setOnline(t){W(this,La)!==t&&(ie(this,La,t),this.listeners.forEach(s=>{s(t)}))}isOnline(){return W(this,La)}},La=new WeakMap,ds=new WeakMap,Aa=new WeakMap,dh),xo=new _1;function y1(e){return Math.min(1e3*2**e,3e4)}function Mp(e){return(e??"online")==="online"?xo.isOnline():!0}var Fc=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Ip(e){let t=!1,n=0,s;const r=m1(),i=()=>r.status!=="pending",o=u=>{var y;if(!i()){const m=new Fc(u);p(m),(y=e.onCancel)==null||y.call(e,m)}},l=()=>{t=!0},c=()=>{t=!1},d=()=>Pp.isFocused()&&(e.networkMode==="always"||xo.isOnline())&&e.canRun(),f=()=>Mp(e.networkMode)&&e.canRun(),h=u=>{i()||(s==null||s(),r.resolve(u))},p=u=>{i()||(s==null||s(),r.reject(u))},_=()=>new Promise(u=>{var y;s=m=>{(i()||d())&&u(m)},(y=e.onPause)==null||y.call(e)}).then(()=>{var u;s=void 0,i()||(u=e.onContinue)==null||u.call(e)}),v=()=>{if(i())return;let u;const y=n===0?e.initialPromise:void 0;try{u=y??e.fn()}catch(m){u=Promise.reject(m)}Promise.resolve(u).then(h).catch(m=>{var N;if(i())return;const x=e.retry??(Vo?0:3),w=e.retryDelay??y1,b=typeof w=="function"?w(n,m):w,S=x===!0||typeof x=="number"&&n<x||typeof x=="function"&&x(n,m);if(t||!S){p(m);return}n++,(N=e.onFail)==null||N.call(e,n,m),c1(b).then(()=>d()?void 0:_()).then(()=>{t?p(m):v()})})};return{promise:r,status:()=>r.status,cancel:o,continue:()=>(s==null||s(),r),cancelRetry:l,continueRetry:c,canStart:f,start:()=>(f()?v():_().then(v),r)}}var Vs,uh,Lp=(uh=class{constructor(){pe(this,Vs)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),r1(this.gcTime)&&ie(this,Vs,Ac.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Vo?1/0:5*60*1e3))}clearGcTimeout(){W(this,Vs)&&(Ac.clearTimeout(W(this,Vs)),ie(this,Vs,void 0))}},Vs=new WeakMap,uh),Gs,Ra,Kt,Qs,Je,Qr,Ys,fn,Ln,fh,v1=(fh=class extends Lp{constructor(t){super();pe(this,fn);pe(this,Gs);pe(this,Ra);pe(this,Kt);pe(this,Qs);pe(this,Je);pe(this,Qr);pe(this,Ys);ie(this,Ys,!1),ie(this,Qr,t.defaultOptions),this.setOptions(t.options),this.observers=[],ie(this,Qs,t.client),ie(this,Kt,W(this,Qs).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,ie(this,Gs,xf(this.options)),this.state=t.state??W(this,Gs),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=W(this,Je))==null?void 0:t.promise}setOptions(t){if(this.options={...W(this,Qr),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=xf(this.options);n.data!==void 0&&(this.setState(vf(n.data,n.dataUpdatedAt)),ie(this,Gs,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&W(this,Kt).remove(this)}setData(t,n){const s=d1(this.state.data,t,this.options);return dt(this,fn,Ln).call(this,{data:s,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),s}setState(t,n){dt(this,fn,Ln).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var s,r;const n=(s=W(this,Je))==null?void 0:s.promise;return(r=W(this,Je))==null||r.cancel(t),n?n.then(un).catch(un):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(W(this,Gs))}isActive(){return this.observers.some(t=>o1(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Gd||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Rc(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!i1(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(s=>s.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=W(this,Je))==null||n.continue()}onOnline(){var n;const t=this.observers.find(s=>s.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=W(this,Je))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),W(this,Kt).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(W(this,Je)&&(W(this,Ys)?W(this,Je).cancel({revert:!0}):W(this,Je).cancelRetry()),this.scheduleGc()),W(this,Kt).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||dt(this,fn,Ln).call(this,{type:"invalidate"})}async fetch(t,n){var c,d,f,h,p,_,v,u,y,m,x,w;if(this.state.fetchStatus!=="idle"&&((c=W(this,Je))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(W(this,Je))return W(this,Je).continueRetry(),W(this,Je).promise}if(t&&this.setOptions(t),!this.options.queryFn){const b=this.observers.find(S=>S.options.queryFn);b&&this.setOptions(b.options)}const s=new AbortController,r=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(ie(this,Ys,!0),s.signal)})},i=()=>{const b=Tp(this.options,n),N=(()=>{const D={client:W(this,Qs),queryKey:this.queryKey,meta:this.meta};return r(D),D})();return ie(this,Ys,!1),this.options.persister?this.options.persister(b,N,this):b(N)},l=(()=>{const b={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:W(this,Qs),state:this.state,fetchFn:i};return r(b),b})();(d=this.options.behavior)==null||d.onFetch(l,this),ie(this,Ra,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=l.fetchOptions)==null?void 0:f.meta))&&dt(this,fn,Ln).call(this,{type:"fetch",meta:(h=l.fetchOptions)==null?void 0:h.meta}),ie(this,Je,Ip({initialPromise:n==null?void 0:n.initialPromise,fn:l.fetchFn,onCancel:b=>{b instanceof Fc&&b.revert&&this.setState({...W(this,Ra),fetchStatus:"idle"}),s.abort()},onFail:(b,S)=>{dt(this,fn,Ln).call(this,{type:"failed",failureCount:b,error:S})},onPause:()=>{dt(this,fn,Ln).call(this,{type:"pause"})},onContinue:()=>{dt(this,fn,Ln).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const b=await W(this,Je).start();if(b===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(b),(_=(p=W(this,Kt).config).onSuccess)==null||_.call(p,b,this),(u=(v=W(this,Kt).config).onSettled)==null||u.call(v,b,this.state.error,this),b}catch(b){if(b instanceof Fc){if(b.silent)return W(this,Je).promise;if(b.revert){if(this.state.data===void 0)throw b;return this.state.data}}throw dt(this,fn,Ln).call(this,{type:"error",error:b}),(m=(y=W(this,Kt).config).onError)==null||m.call(y,b,this),(w=(x=W(this,Kt).config).onSettled)==null||w.call(x,this.state.data,b,this),b}finally{this.scheduleGc()}}},Gs=new WeakMap,Ra=new WeakMap,Kt=new WeakMap,Qs=new WeakMap,Je=new WeakMap,Qr=new WeakMap,Ys=new WeakMap,fn=new WeakSet,Ln=function(t){const n=s=>{switch(t.type){case"failed":return{...s,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...x1(s.data,this.options),fetchMeta:t.meta??null};case"success":const r={...s,...vf(t.data,t.dataUpdatedAt),dataUpdateCount:s.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return ie(this,Ra,t.manual?r:void 0),r;case"error":const i=t.error;return{...s,error:i,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...t.state}}};this.state=n(this.state),jt.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),W(this,Kt).notify({query:this,type:"updated",action:t})})},fh);function x1(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Mp(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function vf(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function xf(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,s=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}function wf(e){return{onFetch:(t,n)=>{var f,h,p,_,v;const s=t.options,r=(p=(h=(f=t.fetchOptions)==null?void 0:f.meta)==null?void 0:h.fetchMore)==null?void 0:p.direction,i=((_=t.state.data)==null?void 0:_.pages)||[],o=((v=t.state.data)==null?void 0:v.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const d=async()=>{let u=!1;const y=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(t.signal.aborted?u=!0:t.signal.addEventListener("abort",()=>{u=!0}),t.signal)})},m=Tp(t.options,t.fetchOptions),x=async(w,b,S)=>{if(u)return Promise.reject();if(b==null&&w.pages.length)return Promise.resolve(w);const D=(()=>{const $={client:t.client,queryKey:t.queryKey,pageParam:b,direction:S?"backward":"forward",meta:t.options.meta};return y($),$})(),L=await m(D),{maxPages:T}=t.options,j=S?f1:u1;return{pages:j(w.pages,L,T),pageParams:j(w.pageParams,b,T)}};if(r&&i.length){const w=r==="backward",b=w?w1:jf,S={pages:i,pageParams:o},N=b(s,S);l=await x(S,N,w)}else{const w=e??i.length;do{const b=c===0?o[0]??s.initialPageParam:jf(s,l);if(c>0&&b==null)break;l=await x(l,b),c++}while(c<w)}return l};t.options.persister?t.fetchFn=()=>{var u,y;return(y=(u=t.options).persister)==null?void 0:y.call(u,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=d}}}function jf(e,{pages:t,pageParams:n}){const s=t.length-1;return t.length>0?e.getNextPageParam(t[s],t,n[s],n):void 0}function w1(e,{pages:t,pageParams:n}){var s;return t.length>0?(s=e.getPreviousPageParam)==null?void 0:s.call(e,t[0],t,n[0],n):void 0}var Yr,kn,xt,Xs,Nn,ts,hh,j1=(hh=class extends Lp{constructor(t){super();pe(this,Nn);pe(this,Yr);pe(this,kn);pe(this,xt);pe(this,Xs);ie(this,Yr,t.client),this.mutationId=t.mutationId,ie(this,xt,t.mutationCache),ie(this,kn,[]),this.state=t.state||S1(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){W(this,kn).includes(t)||(W(this,kn).push(t),this.clearGcTimeout(),W(this,xt).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){ie(this,kn,W(this,kn).filter(n=>n!==t)),this.scheduleGc(),W(this,xt).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){W(this,kn).length||(this.state.status==="pending"?this.scheduleGc():W(this,xt).remove(this))}continue(){var t;return((t=W(this,Xs))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,l,c,d,f,h,p,_,v,u,y,m,x,w,b,S,N,D,L,T;const n=()=>{dt(this,Nn,ts).call(this,{type:"continue"})},s={client:W(this,Yr),meta:this.options.meta,mutationKey:this.options.mutationKey};ie(this,Xs,Ip({fn:()=>this.options.mutationFn?this.options.mutationFn(t,s):Promise.reject(new Error("No mutationFn found")),onFail:(j,$)=>{dt(this,Nn,ts).call(this,{type:"failed",failureCount:j,error:$})},onPause:()=>{dt(this,Nn,ts).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>W(this,xt).canRun(this)}));const r=this.state.status==="pending",i=!W(this,Xs).canStart();try{if(r)n();else{dt(this,Nn,ts).call(this,{type:"pending",variables:t,isPaused:i}),await((l=(o=W(this,xt).config).onMutate)==null?void 0:l.call(o,t,this,s));const $=await((d=(c=this.options).onMutate)==null?void 0:d.call(c,t,s));$!==this.state.context&&dt(this,Nn,ts).call(this,{type:"pending",context:$,variables:t,isPaused:i})}const j=await W(this,Xs).start();return await((h=(f=W(this,xt).config).onSuccess)==null?void 0:h.call(f,j,t,this.state.context,this,s)),await((_=(p=this.options).onSuccess)==null?void 0:_.call(p,j,t,this.state.context,s)),await((u=(v=W(this,xt).config).onSettled)==null?void 0:u.call(v,j,null,this.state.variables,this.state.context,this,s)),await((m=(y=this.options).onSettled)==null?void 0:m.call(y,j,null,t,this.state.context,s)),dt(this,Nn,ts).call(this,{type:"success",data:j}),j}catch(j){try{throw await((w=(x=W(this,xt).config).onError)==null?void 0:w.call(x,j,t,this.state.context,this,s)),await((S=(b=this.options).onError)==null?void 0:S.call(b,j,t,this.state.context,s)),await((D=(N=W(this,xt).config).onSettled)==null?void 0:D.call(N,void 0,j,this.state.variables,this.state.context,this,s)),await((T=(L=this.options).onSettled)==null?void 0:T.call(L,void 0,j,t,this.state.context,s)),j}finally{dt(this,Nn,ts).call(this,{type:"error",error:j})}}finally{W(this,xt).runNext(this)}}},Yr=new WeakMap,kn=new WeakMap,xt=new WeakMap,Xs=new WeakMap,Nn=new WeakSet,ts=function(t){const n=s=>{switch(t.type){case"failed":return{...s,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...s,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:t.error,failureCount:s.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),jt.batch(()=>{W(this,kn).forEach(s=>{s.onMutationUpdate(t)}),W(this,xt).notify({mutation:this,type:"updated",action:t})})},hh);function S1(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Bn,hn,Xr,mh,k1=(mh=class extends Uo{constructor(t={}){super();pe(this,Bn);pe(this,hn);pe(this,Xr);this.config=t,ie(this,Bn,new Set),ie(this,hn,new Map),ie(this,Xr,0)}build(t,n,s){const r=new j1({client:t,mutationCache:this,mutationId:++li(this,Xr)._,options:t.defaultMutationOptions(n),state:s});return this.add(r),r}add(t){W(this,Bn).add(t);const n=Ci(t);if(typeof n=="string"){const s=W(this,hn).get(n);s?s.push(t):W(this,hn).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(W(this,Bn).delete(t)){const n=Ci(t);if(typeof n=="string"){const s=W(this,hn).get(n);if(s)if(s.length>1){const r=s.indexOf(t);r!==-1&&s.splice(r,1)}else s[0]===t&&W(this,hn).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=Ci(t);if(typeof n=="string"){const s=W(this,hn).get(n),r=s==null?void 0:s.find(i=>i.state.status==="pending");return!r||r===t}else return!0}runNext(t){var s;const n=Ci(t);if(typeof n=="string"){const r=(s=W(this,hn).get(n))==null?void 0:s.find(i=>i!==t&&i.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}else return Promise.resolve()}clear(){jt.batch(()=>{W(this,Bn).forEach(t=>{this.notify({type:"removed",mutation:t})}),W(this,Bn).clear(),W(this,hn).clear()})}getAll(){return Array.from(W(this,Bn))}find(t){const n={exact:!0,...t};return this.getAll().find(s=>gf(n,s))}findAll(t={}){return this.getAll().filter(n=>gf(t,n))}notify(t){jt.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return jt.batch(()=>Promise.all(t.map(n=>n.continue().catch(un))))}},Bn=new WeakMap,hn=new WeakMap,Xr=new WeakMap,mh);function Ci(e){var t;return(t=e.options.scope)==null?void 0:t.id}var bn,ph,N1=(ph=class extends Uo{constructor(t={}){super();pe(this,bn);this.config=t,ie(this,bn,new Map)}build(t,n,s){const r=n.queryKey,i=n.queryHash??Vd(r,n);let o=this.get(i);return o||(o=new v1({client:t,queryKey:r,queryHash:i,options:t.defaultQueryOptions(n),state:s,defaultOptions:t.getQueryDefaults(r)}),this.add(o)),o}add(t){W(this,bn).has(t.queryHash)||(W(this,bn).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=W(this,bn).get(t.queryHash);n&&(t.destroy(),n===t&&W(this,bn).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){jt.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return W(this,bn).get(t)}getAll(){return[...W(this,bn).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(s=>pf(n,s))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(s=>pf(t,s)):n}notify(t){jt.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){jt.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){jt.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},bn=new WeakMap,ph),He,us,fs,Ba,Fa,hs,Oa,Ha,gh,b1=(gh=class{constructor(e={}){pe(this,He);pe(this,us);pe(this,fs);pe(this,Ba);pe(this,Fa);pe(this,hs);pe(this,Oa);pe(this,Ha);ie(this,He,e.queryCache||new N1),ie(this,us,e.mutationCache||new k1),ie(this,fs,e.defaultOptions||{}),ie(this,Ba,new Map),ie(this,Fa,new Map),ie(this,hs,0)}mount(){li(this,hs)._++,W(this,hs)===1&&(ie(this,Oa,Pp.subscribe(async e=>{e&&(await this.resumePausedMutations(),W(this,He).onFocus())})),ie(this,Ha,xo.subscribe(async e=>{e&&(await this.resumePausedMutations(),W(this,He).onOnline())})))}unmount(){var e,t;li(this,hs)._--,W(this,hs)===0&&((e=W(this,Oa))==null||e.call(this),ie(this,Oa,void 0),(t=W(this,Ha))==null||t.call(this),ie(this,Ha,void 0))}isFetching(e){return W(this,He).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return W(this,us).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=W(this,He).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=W(this,He).build(this,t),s=n.state.data;return s===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(Rc(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(s))}getQueriesData(e){return W(this,He).findAll(e).map(({queryKey:t,state:n})=>{const s=n.data;return[t,s]})}setQueryData(e,t,n){const s=this.defaultQueryOptions({queryKey:e}),r=W(this,He).get(s.queryHash),i=r==null?void 0:r.state.data,o=a1(t,i);if(o!==void 0)return W(this,He).build(this,s).setData(o,{...n,manual:!0})}setQueriesData(e,t,n){return jt.batch(()=>W(this,He).findAll(e).map(({queryKey:s})=>[s,this.setQueryData(s,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=W(this,He).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=W(this,He);jt.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=W(this,He);return jt.batch(()=>(n.findAll(e).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},s=jt.batch(()=>W(this,He).findAll(e).map(r=>r.cancel(n)));return Promise.all(s).then(un).catch(un)}invalidateQueries(e,t={}){return jt.batch(()=>(W(this,He).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},s=jt.batch(()=>W(this,He).findAll(e).filter(r=>!r.isDisabled()&&!r.isStatic()).map(r=>{let i=r.fetch(void 0,n);return n.throwOnError||(i=i.catch(un)),r.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(un)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=W(this,He).build(this,t);return n.isStaleByTime(Rc(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(un).catch(un)}fetchInfiniteQuery(e){return e.behavior=wf(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(un).catch(un)}ensureInfiniteQueryData(e){return e.behavior=wf(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return xo.isOnline()?W(this,us).resumePausedMutations():Promise.resolve()}getQueryCache(){return W(this,He)}getMutationCache(){return W(this,us)}getDefaultOptions(){return W(this,fs)}setDefaultOptions(e){ie(this,fs,e)}setQueryDefaults(e,t){W(this,Ba).set(Vr(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...W(this,Ba).values()],n={};return t.forEach(s=>{Gr(e,s.queryKey)&&Object.assign(n,s.defaultOptions)}),n}setMutationDefaults(e,t){W(this,Fa).set(Vr(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...W(this,Fa).values()],n={};return t.forEach(s=>{Gr(e,s.mutationKey)&&Object.assign(n,s.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...W(this,fs).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Vd(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Gd&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...W(this,fs).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){W(this,He).clear(),W(this,us).clear()}},He=new WeakMap,us=new WeakMap,fs=new WeakMap,Ba=new WeakMap,Fa=new WeakMap,hs=new WeakMap,Oa=new WeakMap,Ha=new WeakMap,gh),C1=g.createContext(void 0),D1=({client:e,children:t})=>(g.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(C1.Provider,{value:e,children:t}));const $1="modulepreload",E1=function(e){return"/"+e},Sf={},T1=function(t,n,s){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(n.map(c=>{if(c=E1(c),c in Sf)return;Sf[c]=!0;const d=c.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":$1,d||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((p,_)=>{h.addEventListener("load",p),h.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})},kf=e=>{let t;const n=new Set,s=(d,f)=>{const h=typeof d=="function"?d(t):d;if(!Object.is(h,t)){const p=t;t=f??(typeof h!="object"||h===null)?h:Object.assign({},t,h),n.forEach(_=>_(t,p))}},r=()=>t,l={setState:s,getState:r,getInitialState:()=>c,subscribe:d=>(n.add(d),()=>n.delete(d))},c=t=e(s,r,l);return l},P1=e=>e?kf(e):kf,M1=e=>e;function I1(e,t=M1){const n=di.useSyncExternalStore(e.subscribe,di.useCallback(()=>t(e.getState()),[e,t]),di.useCallback(()=>t(e.getInitialState()),[e,t]));return di.useDebugValue(n),n}const Nf=e=>{const t=P1(e),n=s=>I1(t,s);return Object.assign(n,t),n},Go=e=>e?Nf(e):Nf;function Ap(e,t){let n;try{n=e()}catch{return}return{getItem:r=>{var i;const o=c=>c===null?null:JSON.parse(c,void 0),l=(i=n.getItem(r))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,i)=>n.setItem(r,JSON.stringify(i,void 0)),removeItem:r=>n.removeItem(r)}}const Oc=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(s){return Oc(s)(n)},catch(s){return this}}}catch(n){return{then(s){return this},catch(s){return Oc(s)(n)}}}},L1=(e,t)=>(n,s,r)=>{let i={storage:Ap(()=>localStorage),partialize:u=>u,version:0,merge:(u,y)=>({...y,...u}),...t},o=!1;const l=new Set,c=new Set;let d=i.storage;if(!d)return e((...u)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...u)},s,r);const f=()=>{const u=i.partialize({...s()});return d.setItem(i.name,{state:u,version:i.version})},h=r.setState;r.setState=(u,y)=>(h(u,y),f());const p=e((...u)=>(n(...u),f()),s,r);r.getInitialState=()=>p;let _;const v=()=>{var u,y;if(!d)return;o=!1,l.forEach(x=>{var w;return x((w=s())!=null?w:p)});const m=((y=i.onRehydrateStorage)==null?void 0:y.call(i,(u=s())!=null?u:p))||void 0;return Oc(d.getItem.bind(d))(i.name).then(x=>{if(x)if(typeof x.version=="number"&&x.version!==i.version){if(i.migrate){const w=i.migrate(x.state,x.version);return w instanceof Promise?w.then(b=>[!0,b]):[!0,w]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,x.state];return[!1,void 0]}).then(x=>{var w;const[b,S]=x;if(_=i.merge(S,(w=s())!=null?w:p),n(_,!0),b)return f()}).then(()=>{m==null||m(_,void 0),_=s(),o=!0,c.forEach(x=>x(_))}).catch(x=>{m==null||m(void 0,x)})};return r.persist={setOptions:u=>{i={...i,...u},u.storage&&(d=u.storage)},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>v(),hasHydrated:()=>o,onHydrate:u=>(l.add(u),()=>{l.delete(u)}),onFinishHydration:u=>(c.add(u),()=>{c.delete(u)})},i.skipHydration||v(),_||p},A1=L1,R1={week:100,month:36,quarter:50,year:80};function Hc(e){const t={1:[]};for(const s of e.phases||[])if(!s.is_milestone){const r=s.children||[],i=r.length>0;t[1].push({type:"phase",id:s.id,hasChildren:i}),i&&Rp(r,2,t)}let n=0;for(const s in t)t[s]&&t[s].length>0&&(n=Math.max(n,parseInt(s)));return n=Math.max(n,1),{levels:t,maxLevel:n}}function Rp(e,t,n){if(!(!e||e.length===0)){n[t]||(n[t]=[]);for(const s of e){const r=s.children||[],i=r.length>0;n[t].push({type:"subphase",id:s.id,hasChildren:i}),i&&Rp(r,t+1,n)}}}function bf(e,t,n,s){if(!t.has(e.id))return 0;const{levels:r,maxLevel:i}=Hc(e);if(!r[1]||r[1].length===0||!r[1].some(l=>n.has(l.id)))return 1;for(let l=2;l<=i;l++){if(!r[l]||r[l].length===0)continue;if(!r[l].some(d=>s.has(d.id)))return l}return i}function Cf(e,t,n,s,r,i,o){const l=new Set(r),c=new Set(i),d=new Set(o);if(t===0){l.delete(e.id);for(const f of n[1]||[])c.delete(f.id);for(let f=2;f<=s;f++)for(const h of n[f]||[])d.delete(h.id)}else if(l.add(e.id),t===1){for(const f of n[1]||[])c.delete(f.id);for(let f=2;f<=s;f++)for(const h of n[f]||[])d.delete(h.id)}else{for(const f of n[1]||[])c.add(f.id);for(let f=2;f<=s;f++)for(const h of n[f]||[])f<t?d.add(h.id):d.delete(h.id)}return{expandedProjects:l,expandedPhases:c,expandedSubphases:d}}const Df={isAuthChecking:!0,isAuthenticated:!1,sites:[],projects:[],staff:[],equipment:[],vacations:[],bankHolidays:[],bankHolidayDates:new Set,users:[],instanceSettings:null,currentSite:null,currentUser:null,viewMode:"month",currentView:"gantt",currentDate:new Date,cellWidth:36,currentResourceTab:"staff",timelineScrollLeft:0,expandedProjects:new Set,expandedPhases:new Set,expandedSubphases:new Set,expandedStaff:new Set,expandedEquipment:new Set,expandedBankHolidays:!1,whatIfMode:!1,whatIfSnapshot:null,whatIfPendingOperations:[],sidebarCollapsed:!1,resourcePanelCollapsed:!1},F=Go()(A1((e,t)=>({...Df,setSites:n=>e({sites:n}),setProjects:n=>e({projects:n}),setStaff:n=>e({staff:n}),setEquipment:n=>e({equipment:n}),setVacations:n=>e({vacations:n}),setBankHolidays:(n,s)=>e({bankHolidays:n,bankHolidayDates:s}),setUsers:n=>e({users:n}),setInstanceSettings:n=>e({instanceSettings:n}),setCurrentSite:n=>e({currentSite:n}),setCurrentUser:n=>e({currentUser:n}),setAuthChecking:n=>e({isAuthChecking:n}),setAuthenticated:n=>e({isAuthenticated:n}),setViewMode:n=>e({viewMode:n,cellWidth:R1[n]}),setCurrentView:n=>e({currentView:n}),setCurrentDate:n=>e({currentDate:n}),setCellWidth:n=>e({cellWidth:n}),setCurrentResourceTab:n=>e({currentResourceTab:n}),setTimelineScrollLeft:n=>e({timelineScrollLeft:n}),navigatePeriod:n=>{const{viewMode:s,currentDate:r}=t(),i=new Date(r);switch(s){case"week":i.setDate(i.getDate()+n*7);break;case"month":i.setMonth(i.getMonth()+n);break;case"quarter":i.setMonth(i.getMonth()+n*3);break;case"year":i.setFullYear(i.getFullYear()+n);break}e({currentDate:i})},goToToday:()=>e({currentDate:new Date}),toggleProjectExpanded:n=>e(s=>{const r=new Set(s.expandedProjects);return r.has(n)?r.delete(n):r.add(n),{expandedProjects:r}}),togglePhaseExpanded:n=>e(s=>{const r=new Set(s.expandedPhases);return r.has(n)?r.delete(n):r.add(n),{expandedPhases:r}}),toggleSubphaseExpanded:n=>e(s=>{const r=new Set(s.expandedSubphases);return r.has(n)?r.delete(n):r.add(n),{expandedSubphases:r}}),toggleStaffExpanded:n=>e(s=>{const r=new Set(s.expandedStaff);return r.has(n)?r.delete(n):r.add(n),{expandedStaff:r}}),toggleEquipmentExpanded:n=>e(s=>{const r=new Set(s.expandedEquipment);return r.has(n)?r.delete(n):r.add(n),{expandedEquipment:r}}),toggleBankHolidaysExpanded:()=>e(n=>({expandedBankHolidays:!n.expandedBankHolidays})),ensureProjectExpanded:n=>e(s=>{if(s.expandedProjects.has(n))return s;const r=new Set(s.expandedProjects);return r.add(n),{expandedProjects:r}}),ensurePhaseExpanded:n=>e(s=>{if(s.expandedPhases.has(n))return s;const r=new Set(s.expandedPhases);return r.add(n),{expandedPhases:r}}),ensureSubphaseExpanded:n=>e(s=>{if(s.expandedSubphases.has(n))return s;const r=new Set(s.expandedSubphases);return r.add(n),{expandedSubphases:r}}),setExpandedProjects:n=>e({expandedProjects:n}),setExpandedPhases:n=>e({expandedPhases:n}),collapseAll:()=>e({expandedProjects:new Set,expandedPhases:new Set,expandedSubphases:new Set,expandedStaff:new Set,expandedEquipment:new Set}),expandAll:()=>{const{projects:n}=t(),s=new Set(n.map(o=>o.id)),r=new Set,i=new Set;n.forEach(o=>{var l;(l=o.phases)==null||l.forEach(c=>{r.add(c.id);const d=f=>{f==null||f.forEach(h=>{i.add(h.id),d(h.children)})};d(c.children)})}),e({expandedProjects:s,expandedPhases:r,expandedSubphases:i})},expandProjectLevel:n=>{const{projects:s,expandedProjects:r,expandedPhases:i,expandedSubphases:o}=t(),l=s.find(_=>_.id===n);if(!l)return;const{levels:c,maxLevel:d}=Hc(l),f=bf(l,r,i,o),h=Math.min(f+1,d),p=Cf(l,h,c,d,r,i,o);e(p)},collapseProjectLevel:n=>{const{projects:s,expandedProjects:r,expandedPhases:i,expandedSubphases:o}=t(),l=s.find(_=>_.id===n);if(!l)return;const{levels:c,maxLevel:d}=Hc(l),f=bf(l,r,i,o),h=Math.max(f-1,0),p=Cf(l,h,c,d,r,i,o);e(p)},enterWhatIfMode:()=>{const{projects:n}=t();e({whatIfMode:!0,whatIfSnapshot:{projects:structuredClone(n)},whatIfPendingOperations:[]})},exitWhatIfMode:async n=>{const{whatIfSnapshot:s,whatIfPendingOperations:r}=t();if(!n&&s)e({projects:s.projects,whatIfMode:!1,whatIfSnapshot:null,whatIfPendingOperations:[]});else if(n&&r.length>0){console.log(`[What If] Applying ${r.length} pending operations...`);const{apiRequest:i,clientConfig:o}=await T1(async()=>{const{apiRequest:c,clientConfig:d}=await Promise.resolve().then(()=>F1);return{apiRequest:c,clientConfig:d}},void 0),l=o.isWhatIfMode;o.isWhatIfMode=()=>!1;try{for(const c of r)console.log(`[What If] Executing: ${c.method} ${c.url}`),await i(c.url,{method:c.method,body:c.body});console.log("[What If] All operations applied successfully")}catch(c){console.error("[What If] Failed to apply operations:",c)}finally{o.isWhatIfMode=l}e({whatIfMode:!1,whatIfSnapshot:null,whatIfPendingOperations:[]})}else e({whatIfMode:!1,whatIfSnapshot:null,whatIfPendingOperations:[]})},queueWhatIfOperation:n=>{e(s=>({whatIfPendingOperations:[...s.whatIfPendingOperations,{...n,id:`op_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:Date.now()}]}))},toggleSidebar:()=>e(n=>({sidebarCollapsed:!n.sidebarCollapsed})),toggleResourcePanel:()=>e(n=>({resourcePanelCollapsed:!n.resourcePanelCollapsed})),setSidebarCollapsed:n=>e({sidebarCollapsed:n}),setResourcePanelCollapsed:n=>e({resourcePanelCollapsed:n}),reset:()=>e(Df)}),{name:"milestone-app-storage",storage:Ap(()=>localStorage),partialize:e=>{var t;return{viewMode:e.viewMode,currentView:e.currentView,cellWidth:e.cellWidth,currentResourceTab:e.currentResourceTab,sidebarCollapsed:e.sidebarCollapsed,resourcePanelCollapsed:e.resourcePanelCollapsed,timelineScrollLeft:e.timelineScrollLeft,expandedProjects:Array.from(e.expandedProjects),expandedPhases:Array.from(e.expandedPhases),expandedSubphases:Array.from(e.expandedSubphases),currentSiteId:(t=e.currentSite)==null?void 0:t.id,currentDateISO:e.currentDate.toISOString()}},onRehydrateStorage:()=>(console.log("[AppStore] Starting hydration from localStorage..."),(e,t)=>{var n,s;t?console.error("[AppStore] Hydration error:",t):e&&console.log("[AppStore] Hydration complete:",{viewMode:e.viewMode,currentDate:(s=(n=e.currentDate)==null?void 0:n.toISOString)==null?void 0:s.call(n),cellWidth:e.cellWidth})}),merge:(e,t)=>{const n=(e==null?void 0:e.state)??e;return console.log("[AppStore] Merging persisted state:",{raw:e,unwrapped:n}),{...t,viewMode:(n==null?void 0:n.viewMode)??t.viewMode,currentView:(n==null?void 0:n.currentView)??t.currentView,cellWidth:(n==null?void 0:n.cellWidth)??t.cellWidth,currentResourceTab:(n==null?void 0:n.currentResourceTab)??t.currentResourceTab,sidebarCollapsed:(n==null?void 0:n.sidebarCollapsed)??t.sidebarCollapsed,resourcePanelCollapsed:(n==null?void 0:n.resourcePanelCollapsed)??t.resourcePanelCollapsed,timelineScrollLeft:(n==null?void 0:n.timelineScrollLeft)??t.timelineScrollLeft,expandedProjects:Array.isArray(n==null?void 0:n.expandedProjects)?new Set(n.expandedProjects):t.expandedProjects,expandedPhases:Array.isArray(n==null?void 0:n.expandedPhases)?new Set(n.expandedPhases):t.expandedPhases,expandedSubphases:Array.isArray(n==null?void 0:n.expandedSubphases)?new Set(n.expandedSubphases):t.expandedSubphases,currentDate:n!=null&&n.currentDateISO?new Date(n.currentDateISO):t.currentDate}}}));function B1(){return window.location.port==="3333"?`${window.location.protocol}//${window.location.hostname}:8485`:""}function Bp(){const e=window.location.pathname.match(/^(\/t\/[a-z0-9][a-z0-9-]*)/);return e?e[1]:""}let os={isWhatIfMode:()=>!1,queueWhatIfOperation:void 0};function Fp(e){os={...os,...e}}async function ni(e,t={}){var f;const n=B1(),s=Bp();let r=e.startsWith("/")?e:`/${e}`;r.startsWith("/api/")&&s&&(r=s+r),r=n+r;const i=t.method||"GET";if((f=os.isWhatIfMode)!=null&&f.call(os)&&["PUT","POST","DELETE"].includes(i)&&!["/api/auth/","/api/settings/"].some(_=>r.includes(_))){if(console.log(`[What If Mode] Queued ${i} request to ${r}`),os.queueWhatIfOperation){const _=r.replace(n,"");os.queueWhatIfOperation({method:i,url:_,body:t.body})}return{success:!0,whatIfMode:!0,id:Date.now()}}const{body:o,headers:l,...c}=t,d={method:i,headers:{"Content-Type":"application/json",...l},credentials:"include",...c};o!==void 0&&(d.body=JSON.stringify(o));try{const h=await fetch(r,d);if(h.status===204)return{};const p=await h.text();if(!p||p.trim()===""){if(h.ok)return{};throw new Error(`HTTP ${h.status}: Empty response`)}let _;try{_=JSON.parse(p)}catch{throw console.error(`[API Error] Non-JSON response from ${e}:`,p.substring(0,200)),new Error(`HTTP ${h.status}: Invalid response`)}if(!h.ok){const v=_;if(Array.isArray(v.detail)){const y=v.detail.map(m=>{var w;return`${((w=m.loc)==null?void 0:w.slice(-1)[0])||"field"}: ${m.msg||"invalid"}`});throw new Error(y.join(", "))}const u=v.error||v.detail||`HTTP ${h.status}`;throw new Error(u)}return _}catch(h){throw h instanceof Error?(console.error(`[API Error] ${i} ${e}:`,h.message),h):new Error("An unexpected error occurred")}}function Ce(e){return ni(e,{method:"GET"})}function De(e,t){return ni(e,{method:"POST",body:t})}function Xe(e,t){return ni(e,{method:"PUT",body:t})}function Ut(e){return ni(e,{method:"DELETE"})}const F1=Object.freeze(Object.defineProperty({__proto__:null,apiDelete:Ut,apiGet:Ce,apiPost:De,apiPut:Xe,apiRequest:ni,get clientConfig(){return os},configureApiClient:Fp,getTenantPrefix:Bp},Symbol.toStringTag,{value:"Module"}));async function O1(){try{return await Ce("/api/auth/me")}catch{return{user:null}}}async function H1(e,t){return De("/api/auth/login",{email:e,password:t})}async function Op(){await De("/api/auth/logout")}async function q1(){try{return await Ce("/api/auth/sso/status")}catch{return{enabled:!1}}}async function z1(){return Ce("/api/auth/sso/login")}async function W1(e="false"){return Ce(`/api/projects?archived=${e}`)}async function U1(e){return Ce(`/api/projects/${e}`)}async function V1(e){return De("/api/projects",e)}async function si(e,t){return Xe(`/api/projects/${e}`,t)}async function G1(e){await Ut(`/api/projects/${e}`)}async function Q1(e,t){const n={type:t.name,start_date:t.start_date,end_date:t.end_date,is_milestone:!1};return t.order_index!==void 0&&(n.order_index=t.order_index),t.dependencies!==void 0&&(n.dependencies=t.dependencies),De(`/api/projects/${e}/phases`,n)}async function ia(e,t){return Xe(`/api/phases/${e}`,t)}async function Hp(e){await Ut(`/api/phases/${e}`)}async function Y1(e,t,n){const s={name:n.name,start_date:n.start_date,end_date:n.end_date,project_id:t,is_milestone:!1};return n.order_index!==void 0&&(s.order_index=n.order_index),n.dependencies!==void 0&&(s.dependencies=n.dependencies),De(`/api/phases/${e}/subphases`,s)}async function X1(e,t,n){const s={name:n.name,start_date:n.start_date,end_date:n.end_date,project_id:t,is_milestone:!1};return n.order_index!==void 0&&(s.order_index=n.order_index),n.dependencies!==void 0&&(s.dependencies=n.dependencies),De(`/api/subphases/${e}/children`,s)}async function Ps(e,t){return Xe(`/api/subphases/${e}`,t)}async function qp(e){await Ut(`/api/subphases/${e}`)}async function K1(e){if(e.subphase_id)return De(`/api/subphases/${e.subphase_id}/staff`,e);if(e.phase_id)return De(`/api/phases/${e.phase_id}/staff`,e);if(e.project_id)return De(`/api/projects/${e.project_id}/staff`,e);throw new Error("Must specify project_id, phase_id, or subphase_id")}async function Qo(e,t){return Xe(`/api/assignments/${e}`,t)}async function Z1(e){await Ut(`/api/assignments/${e}`)}async function J1(e){if(e.subphase_id)return De(`/api/subphases/${e.subphase_id}/equipment`,e);if(e.phase_id)return De(`/api/phases/${e.phase_id}/equipment`,e);if(e.project_id)return De(`/api/projects/${e.project_id}/equipment`,e);throw new Error("Must specify project_id, phase_id, or subphase_id")}async function Yo(e,t){return Xe(`/api/equipment-assignments/${e}`,t)}async function ev(e){await Ut(`/api/equipment-assignments/${e}`)}function tv(e){return{...e,phases:(e.phases??[]).map(av),staffAssignments:(e.staff_assignments??e.staffAssignments??[]).map(Qd),equipmentAssignments:(e.equipment_assignments??e.equipmentAssignments??[]).map(Yd)}}const nv="#ec4899",$f={1:"#06b6d4",2:"#8b5cf6",3:"#3b82f6",4:"#f97316",5:"#10b981",6:"#ec4899",7:"#eab308",8:"#14b8a6",9:"#a855f7"};function sv(e){return $f[e]||$f[1]}function av(e){return{id:e.id,project_id:e.project_id,name:e.type||e.name||"Phase",start_date:e.start_date,end_date:e.end_date,color:nv,order_index:e.sort_order??0,completion:e.completion??null,is_milestone:!!e.is_milestone,dependencies:e.dependencies??[],children:(e.children??e.subphases??[]).map(t=>zp(t,1)),staffAssignments:(e.staff_assignments??e.staffAssignments??[]).map(Qd),equipmentAssignments:(e.equipment_assignments??e.equipmentAssignments??[]).map(Yd)}}function zp(e,t=1){const n=e.depth??t;return{id:e.id,project_id:e.project_id,parent_phase_id:e.parent_type==="phase"?e.parent_id:null,parent_subphase_id:e.parent_type==="subphase"?e.parent_id:null,name:e.name,start_date:e.start_date,end_date:e.end_date,color:sv(n),order_index:e.sort_order??0,completion:e.completion??null,is_milestone:!!e.is_milestone,dependencies:e.dependencies??[],children:(e.children??[]).map(s=>zp(s,n+1)),staffAssignments:(e.staff_assignments??e.staffAssignments??[]).map(Qd),equipmentAssignments:(e.equipment_assignments??e.equipmentAssignments??[]).map(Yd)}}function Qd(e){return{id:e.id,staff_id:e.staff_id,staff_name:e.staff_name,project_id:e.project_id,phase_id:e.phase_id,subphase_id:e.subphase_id,allocation:e.allocation??e.allocation_percent??100,start_date:e.start_date,end_date:e.end_date}}function Yd(e){return{id:e.id,equipment_id:e.equipment_id,equipment_name:e.equipment_name,project_id:e.project_id,phase_id:e.phase_id,subphase_id:e.subphase_id,start_date:e.start_date,end_date:e.end_date}}async function Ke(){const e=await W1("all");return!e||e.length===0?[]:(await Promise.all(e.map(n=>U1(n.id)))).map(tv)}async function rv(){return Ce("/api/sites")}async function iv(e){return De("/api/sites",e)}async function ov(e,t){return Xe(`/api/sites/${e}`,t)}async function ks(e,t){const n=t?`/api/sites/${e}/holidays?year=${t}`:`/api/sites/${e}/holidays`;return Ce(n)}async function Wp(e,t){return De(`/api/sites/${e}/holidays`,t)}const lv=Wp;async function Up(e,t){await Ut(`/api/sites/${e}/holidays/${t}`)}const cv=Up;async function Vp(e){return De(`/api/sites/${e}/holidays/refresh`)}function $n(e){const t=new Set;return e.forEach(n=>{const s=new Date(n.date),r=n.end_date?new Date(n.end_date):s,i=new Date(s);for(;i<=r;){const o=dv(i);t.add(o),i.setDate(i.getDate()+1)}}),t}function dv(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${n}-${s}`}async function uv(e=!1){return Ce(e?"/api/staff?includeAllSites=true":"/api/staff")}async function fv(e=!1){return Ce(e?"/api/equipment?includeAllSites=true":"/api/equipment")}async function Xd(){return Ce("/api/vacations")}async function hv(e){return De("/api/vacations",e)}async function mv(e,t){return Xe(`/api/vacations/${e}`,t)}async function pv(e){await Ut(`/api/vacations/${e}`)}async function gv(e=!1){return Ce(e?"/api/users?includeDisabled=true":"/api/users")}async function _v(e){return De("/api/users",e)}async function yv(e,t){return Xe(`/api/users/${e}`,t)}async function vv(e){await Ut(`/api/users/${e}`)}async function xv(e){return Ce(`/api/settings/${e}`)}async function wv(e,t){return Xe(`/api/settings/${e}`,{value:t})}async function jv(){const e=await Ce("/api/settings");return{instance_title:e.instance_title||void 0,instance_name:e.instance_name||void 0}}async function Sv(){return Ce("/api/predefined-phases")}async function kv(e,t){return De("/api/admin/auth/login",{email:e,password:t})}async function Nv(){await De("/api/admin/auth/logout",{})}async function bv(){return Ce("/api/admin/auth/me")}async function Cv(){return Ce("/api/admin/tenants")}async function Dv(e){return Ce(`/api/admin/tenants/${e}`)}async function $v(e){return De("/api/admin/tenants",e)}async function Ev(e,t){return Xe(`/api/admin/tenants/${e}/status`,{status:t})}async function Tv(e){await Ut(`/api/admin/tenants/${e}`)}async function Pv(e){return De(`/api/admin/tenants/${e}/provision`,{})}async function Mv(e){return De(`/api/admin/tenants/${e}/reset-admin-password`,{})}async function Iv(e,t=50){return Ce(`/api/admin/tenants/${e}/audit?limit=${t}`)}async function Lv(){return Ce("/api/admin/stats")}async function Av(){return Ce("/api/admin/users")}async function Rv(e){return De("/api/admin/users",e)}async function Bv(e,t){return Xe(`/api/admin/users/${e}`,t)}async function Fv(e){await Ut(`/api/admin/users/${e}`)}function Gp(){const e=F(d=>d.currentUser),t=F(d=>d.isAuthChecking),n=F(d=>d.isAuthenticated),s=F(d=>d.setCurrentUser),r=F(d=>d.setAuthChecking),i=F(d=>d.setAuthenticated),o=F(d=>d.reset);g.useEffect(()=>{t&&(async()=>{try{const f=await O1();f.user?(s(f.user),i(!0)):i(!1)}catch(f){console.error("Auth check failed:",f),i(!1)}finally{r(!1)}})()},[t,s,i,r]);const l=g.useCallback(async(d,f)=>{try{const h=await H1(d,f);s(h.user),i(!0)}catch(h){const p=h instanceof Error?h.message:"Login failed";throw new Error(p)}},[s,i]),c=g.useCallback(async()=>{try{await Op()}catch(d){console.error("Logout error:",d)}finally{s(null),i(!1),o()}},[s,i,o]);return{isLoading:t,isAuthenticated:n,user:e,login:l,logout:c}}function Qp(){const[e,t]=g.useState(!1),[n,s]=g.useState(null),{setSites:r,setProjects:i,setStaff:o,setEquipment:l,setVacations:c,setBankHolidays:d,setCurrentSite:f,setInstanceSettings:h}=F(),p=g.useCallback(async()=>{var u;t(!0),s(null);try{console.log("[DataLoader] Loading all data...");const[y,m,x,w,b]=await Promise.all([rv(),uv(!0),fv(!0),Xd(),jv().catch(()=>null)]);if(console.log("[DataLoader] Loaded:",{sites:y.length,staff:m.length,equipment:x.length,vacations:w.length,instanceSettings:b?"yes":"no"}),r(y),o(m),l(x),c(w),b&&h(b),y.length>0){const N=[...y].sort((j,$)=>j.id-$.id);let D=N[0];console.log("[DataLoader] Default site (first by ID):",D.name,"id:",D.id);try{const j=localStorage.getItem("milestone-app-storage");if(console.log("[DataLoader] Raw localStorage:",j),j){const $=JSON.parse(j),P=(u=$==null?void 0:$.state)==null?void 0:u.currentSiteId;if(console.log("[DataLoader] Looking for persisted site ID:",P,"type:",typeof P),console.log("[DataLoader] Available sites:",N.map(k=>({id:k.id,name:k.name,type:typeof k.id}))),P!=null){const k=Number(P),E=N.find(I=>Number(I.id)===k);console.log("[DataLoader] Comparison: looking for",k,"type:",typeof k),E?(D=E,console.log("[DataLoader]  Restored persisted site:",D.name,"id:",D.id)):console.log("[DataLoader]  Site ID",k,"not found in available sites")}else console.log("[DataLoader] No persistedSiteId in stored state")}else console.log("[DataLoader] No stored state in localStorage")}catch(j){console.warn("[DataLoader] Failed to restore persisted site:",j)}console.log("[DataLoader] Final selected site:",D.name,"id:",D.id),f(D);const L=await ks(D.id),T=$n(L);d(L,T)}const S=await Ke();i(S),console.log("[DataLoader] Loaded projects:",S.length)}catch(y){const m=y instanceof Error?y.message:"Failed to load data";console.error("[DataLoader] Error:",m),s(m)}finally{t(!1)}},[r,i,o,l,c,d,f,h]),_=g.useCallback(async()=>{try{const u=await Ke();i(u)}catch(u){console.error("[DataLoader] Failed to refresh projects:",u)}},[i]),v=g.useCallback(async u=>{try{const y=await ks(u),m=$n(y);d(y,m)}catch(y){console.error("[DataLoader] Failed to refresh site data:",y)}},[d]);return{isLoading:e,error:n,loadAllData:p,refreshProjects:_,refreshSiteData:v}}const Ov="_container_69zuh_1",Hv="_content_69zuh_9",qv="_logo_69zuh_16",zv="_spinner_69zuh_21",Wv="_message_69zuh_30",lr={container:Ov,content:Hv,logo:qv,spinner:zv,message:Wv};function Ef({message:e="Loading..."}){return a.jsx("div",{className:lr.container,children:a.jsxs("div",{className:lr.content,children:[a.jsx("img",{src:"/img/milestone_logo_no_text.svg",alt:"Milestone",className:lr.logo}),a.jsx("div",{className:lr.spinner}),a.jsx("p",{className:lr.message,children:e})]})})}const as={PREF_SITE_ID:"milestone_pref_site_id",PREF_VIEW:"milestone_pref_view",PREF_VIEW_MODE:"milestone_pref_view_mode",PREF_THEME:"milestone_theme",LEGACY_SITE_ID:"rd_pref_site_id",LEGACY_VIEW:"rd_pref_view",LEGACY_VIEW_MODE:"rd_pref_view_mode"};function Uv(){[[as.LEGACY_SITE_ID,as.PREF_SITE_ID],[as.LEGACY_VIEW,as.PREF_VIEW],[as.LEGACY_VIEW_MODE,as.PREF_VIEW_MODE]].forEach(([t,n])=>{const s=localStorage.getItem(t);s!==null&&localStorage.getItem(n)===null&&(localStorage.setItem(n,s),console.log(`Migrated storage: ${t} -> ${n}`))})}function oa(){const e=localStorage.getItem(as.PREF_THEME);return e==="light"||e==="dark"?e:"dark"}function Vv(e){localStorage.setItem(as.PREF_THEME,e),document.documentElement.setAttribute("data-theme",e)}function Gv(){const t=oa()==="dark"?"light":"dark";return Vv(t),t}function Qv(){const e=oa();document.documentElement.setAttribute("data-theme",e)}const Yv="_container_1pc0d_1",Xv="_card_1pc0d_10",Kv="_header_1pc0d_19",Zv="_logo_1pc0d_24",Jv="_subtitle_1pc0d_30",ex="_ssoButton_1pc0d_36",tx="_divider_1pc0d_58",nx="_form_1pc0d_78",sx="_formGroup_1pc0d_84",ax="_label_1pc0d_90",rx="_input_1pc0d_96",ix="_error_1pc0d_122",ox="_submitButton_1pc0d_132",ht={container:Yv,card:Xv,header:Kv,logo:Zv,subtitle:Jv,ssoButton:ex,divider:tx,form:nx,formGroup:sx,label:ax,input:rx,error:ix,submitButton:ox};function lx(){const{login:e}=Gp(),[t,n]=g.useState(""),[s,r]=g.useState(""),[i,o]=g.useState(!1),[l,c]=g.useState(null),[d,f]=g.useState(!1),[h,p]=g.useState(()=>oa());g.useEffect(()=>{(async()=>{try{const{enabled:m}=await q1();f(m)}catch{}})()},[]),g.useEffect(()=>{const y=new MutationObserver(()=>{const m=document.documentElement.dataset.theme;m&&m!==h&&p(m)});return y.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>y.disconnect()},[h]);const _=async y=>{y.preventDefault(),c(null),o(!0);try{await e(t,s)}catch(m){c(m instanceof Error?m.message:"Invalid email or password")}finally{o(!1)}},v=async()=>{try{const{url:y}=await z1();window.location.href=y}catch{c("Failed to initiate SSO login")}},u=h==="dark"?"/img/milestone_logo_dark_theme.svg":"/img/milestone_logo_light_theme.svg";return a.jsx("div",{className:ht.container,children:a.jsxs("div",{className:ht.card,children:[a.jsxs("div",{className:ht.header,children:[a.jsx("img",{src:u,alt:"Milestone",className:ht.logo}),a.jsx("p",{className:ht.subtitle,children:"Sign in to continue"})]}),d&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{type:"button",className:ht.ssoButton,onClick:v,children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 23 23",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{fill:"#f35325",d:"M1 1h10v10H1z"}),a.jsx("path",{fill:"#81bc06",d:"M12 1h10v10H12z"}),a.jsx("path",{fill:"#05a6f0",d:"M1 12h10v10H1z"}),a.jsx("path",{fill:"#ffba08",d:"M12 12h10v10H12z"})]}),"Sign in with Microsoft"]}),a.jsx("div",{className:ht.divider,children:a.jsx("span",{children:"or sign in with email"})})]}),a.jsxs("form",{onSubmit:_,className:ht.form,children:[a.jsxs("div",{className:ht.formGroup,children:[a.jsx("label",{htmlFor:"email",className:ht.label,children:"Email"}),a.jsx("input",{type:"email",id:"email",className:ht.input,value:t,onChange:y=>n(y.target.value),placeholder:"your@email.com",required:!0,autoFocus:!0,disabled:i})]}),a.jsxs("div",{className:ht.formGroup,children:[a.jsx("label",{htmlFor:"password",className:ht.label,children:"Password"}),a.jsx("input",{type:"password",id:"password",className:ht.input,value:s,onChange:y=>r(y.target.value),placeholder:"",required:!0,disabled:i})]}),l&&a.jsx("div",{className:ht.error,children:l}),a.jsx("button",{type:"submit",className:ht.submitButton,disabled:i,children:i?"Signing in...":"Sign In"})]})]})})}const cx={activeModal:null,editingProject:null,editingPhase:null,editingSubphase:null,editingStaffAssignment:null,editingEquipmentAssignment:null,editingVacation:null,editingStaff:null,editingEquipment:null,editingUser:null,editingSite:null,modalContext:{},tooltip:{visible:!1,content:"",x:0,y:0},contextMenu:{visible:!1,x:0,y:0,type:null,targetId:null,projectId:void 0,phaseId:void 0},isDragging:!1,dragType:null,dragItemId:null,isResizing:!1,resizeEdge:null,resizeItemId:null,resizeItemType:null,dragIndicator:{visible:!1,left:0,top:0,type:"drag"},isLinkingDependency:!1,linkingFrom:null,phantomSiblingMode:null,isLoading:!1,loadingMessage:"",scrollToTodayTrigger:0,scrollToDateTrigger:null,zoomTrigger:null},Z=Go()(e=>({...cx,openModal:(t,n={})=>e({activeModal:t,modalContext:n}),closeModal:()=>e({activeModal:null,editingProject:null,editingPhase:null,editingSubphase:null,editingStaffAssignment:null,editingEquipmentAssignment:null,editingVacation:null,editingStaff:null,editingEquipment:null,editingUser:null,editingSite:null,modalContext:{}}),setEditingProject:t=>e({editingProject:t}),setEditingPhase:t=>e({editingPhase:t}),setEditingSubphase:t=>e({editingSubphase:t}),setEditingStaffAssignment:t=>e({editingStaffAssignment:t}),setEditingEquipmentAssignment:t=>e({editingEquipmentAssignment:t}),setEditingVacation:t=>e({editingVacation:t}),setEditingStaff:t=>e({editingStaff:t}),setEditingEquipment:t=>e({editingEquipment:t}),setEditingUser:t=>e({editingUser:t}),setEditingSite:t=>e({editingSite:t}),openProjectModal:t=>e({activeModal:"project",editingProject:t||null}),openPhaseModal:(t,n)=>e({activeModal:"phase",editingPhase:t||null,modalContext:n?{projectId:n}:{}}),openSubphaseModal:(t,n,s,r)=>e({activeModal:"subphase",editingSubphase:t||null,modalContext:{phaseId:n,projectId:s,subphaseId:r}}),openVacationModal:(t,n)=>e({activeModal:"vacation",editingVacation:t||null,modalContext:n?{staffId:n}:{}}),openBankHolidayModal:()=>e({activeModal:"bankHoliday"}),openSiteModal:()=>e({activeModal:"site"}),setActiveModal:t=>e({activeModal:t}),showTooltip:(t,n,s)=>e({tooltip:{visible:!0,content:t,x:n,y:s}}),hideTooltip:()=>e({tooltip:{visible:!1,content:"",x:0,y:0}}),startDrag:(t,n)=>e({isDragging:!0,dragType:t,dragItemId:n}),endDrag:()=>e({isDragging:!1,dragType:null,dragItemId:null}),startResize:(t,n,s)=>e({isResizing:!0,resizeItemType:t,resizeItemId:n,resizeEdge:s}),endResize:()=>e({isResizing:!1,resizeItemType:null,resizeItemId:null,resizeEdge:null}),showDragIndicator:(t,n,s)=>e({dragIndicator:{visible:!0,left:t,top:n,type:"drag",lagDays:s}}),showResizeIndicator:(t,n,s,r,i)=>e({dragIndicator:{visible:!0,left:t,top:n,type:"resize",date:s,duration:r,edge:i}}),hideIndicator:()=>e({dragIndicator:{visible:!1,left:0,top:0,type:"drag"}}),startLinking:(t,n,s,r)=>e({isLinkingDependency:!0,linkingFrom:{projectId:t,itemId:n,itemType:s,zone:r}}),completeLinking:()=>e({isLinkingDependency:!1,linkingFrom:null}),cancelLinking:()=>e({isLinkingDependency:!1,linkingFrom:null}),startPhantomSibling:t=>e({phantomSiblingMode:t}),updatePhantomPosition:(t,n)=>e(s=>({phantomSiblingMode:s.phantomSiblingMode?{...s.phantomSiblingMode,phantomStart:t,phantomEnd:n}:null})),endPhantomSibling:()=>e({phantomSiblingMode:null}),setLoading:(t,n="")=>e({isLoading:t,loadingMessage:n}),showContextMenu:(t,n,s,r,i,o)=>e({contextMenu:{visible:!0,x:s,y:r,type:t,targetId:n,projectId:i,phaseId:o}}),hideContextMenu:()=>e({contextMenu:{visible:!1,x:0,y:0,type:null,targetId:null,projectId:void 0,phaseId:void 0}}),triggerScrollToToday:()=>e(t=>({scrollToTodayTrigger:t.scrollToTodayTrigger+1})),triggerScrollToDate:t=>e({scrollToDateTrigger:{date:t,timestamp:Date.now()}}),clearScrollToDateTrigger:()=>e({scrollToDateTrigger:null}),triggerZoom:(t,n)=>e({zoomTrigger:{direction:t,newCellWidth:n,timestamp:Date.now()}}),clearZoomTrigger:()=>e({zoomTrigger:null})})),Yp=Go()((e,t)=>({undoStack:[],redoStack:[],canUndo:!1,canRedo:!1,saveState:(n,s)=>{e(r=>{const i={projects:structuredClone(n),description:s,timestamp:Date.now()};return{undoStack:[...r.undoStack,i].slice(-50),redoStack:[],canUndo:!0,canRedo:!1}})},undo:()=>{const{undoStack:n,redoStack:s}=t();if(n.length===0)return null;const r=n[n.length-1],i=n.slice(0,-1);return e({undoStack:i,redoStack:[...s,r],canUndo:i.length>0,canRedo:!0}),i.length>0?i[i.length-1].projects:null},redo:()=>{const{undoStack:n,redoStack:s}=t();if(s.length===0)return null;const r=s[s.length-1],i=s.slice(0,-1);return e({undoStack:[...n,r],redoStack:i,canUndo:!0,canRedo:i.length>0}),r.projects},clear:()=>{e({undoStack:[],redoStack:[],canUndo:!1,canRedo:!1})}})),Xp=6048e5,dx=864e5,Kp=6e4,Zp=36e5,Tf=Symbol.for("constructDateFrom");function qt(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&Tf in e?e[Tf](t):e instanceof Date?new e.constructor(t):new Date(t)}function Ze(e,t){return qt(t||e,e)}function En(e,t,n){const s=Ze(e,n==null?void 0:n.in);return isNaN(t)?qt(e,NaN):(t&&s.setDate(s.getDate()+t),s)}function Tn(e,t,n){const s=Ze(e,n==null?void 0:n.in);if(isNaN(t))return qt(e,NaN);if(!t)return s;const r=s.getDate(),i=qt(e,s.getTime());i.setMonth(s.getMonth()+t+1,0);const o=i.getDate();return r>=o?i:(s.setFullYear(i.getFullYear(),i.getMonth(),r),s)}function Jp(e,t){const n=Ze(e,t==null?void 0:t.in).getDay();return n===0||n===6}let ux={};function Xo(){return ux}function Ds(e,t){var l,c,d,f;const n=Xo(),s=(t==null?void 0:t.weekStartsOn)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??n.weekStartsOn??((f=(d=n.locale)==null?void 0:d.options)==null?void 0:f.weekStartsOn)??0,r=Ze(e,t==null?void 0:t.in),i=r.getDay(),o=(i<s?7:0)+i-s;return r.setDate(r.getDate()-o),r.setHours(0,0,0,0),r}function wo(e,t){return Ds(e,{...t,weekStartsOn:1})}function eg(e,t){const n=Ze(e,t==null?void 0:t.in),s=n.getFullYear(),r=qt(n,0);r.setFullYear(s+1,0,4),r.setHours(0,0,0,0);const i=wo(r),o=qt(n,0);o.setFullYear(s,0,4),o.setHours(0,0,0,0);const l=wo(o);return n.getTime()>=i.getTime()?s+1:n.getTime()>=l.getTime()?s:s-1}function Pf(e){const t=Ze(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function Ko(e,...t){const n=qt.bind(null,t.find(s=>typeof s=="object"));return t.map(n)}function jo(e,t){const n=Ze(e,t==null?void 0:t.in);return n.setHours(0,0,0,0),n}function tg(e,t,n){const[s,r]=Ko(n==null?void 0:n.in,e,t),i=jo(s),o=jo(r),l=+i-Pf(i),c=+o-Pf(o);return Math.round((l-c)/dx)}function fx(e,t){const n=eg(e,t),s=qt(e,0);return s.setFullYear(n,0,4),s.setHours(0,0,0,0),wo(s)}function Kd(e,t,n){return En(e,t*7,n)}function hx(e,t,n){const[s,r]=Ko(n==null?void 0:n.in,e,t);return+jo(s)==+jo(r)}function mx(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function px(e){return!(!mx(e)&&typeof e!="number"||isNaN(+Ze(e)))}function Ns(e,t,n){const[s,r]=Ko(n==null?void 0:n.in,e,t),i=Mf(s,r),o=Math.abs(tg(s,r));s.setDate(s.getDate()-i*o);const l=+(Mf(s,r)===-i),c=i*(o-l);return c===0?0:c}function Mf(e,t){const n=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return n<0?-1:n>0?1:n}function gx(e,t){const n=Ze(e,t==null?void 0:t.in),s=n.getMonth();return n.setFullYear(n.getFullYear(),s+1,0),n.setHours(23,59,59,999),n}function _x(e,t){const[n,s]=Ko(e,t.start,t.end);return{start:n,end:s}}function yx(e,t){const{start:n,end:s}=_x(t==null?void 0:t.in,e);let r=+n>+s;const i=r?+n:+s,o=r?s:n;o.setHours(0,0,0,0);let l=1;const c=[];for(;+o<=i;)c.push(qt(n,o)),o.setDate(o.getDate()+l),o.setHours(0,0,0,0);return r?c.reverse():c}function ng(e,t){const n=Ze(e,t==null?void 0:t.in),s=n.getMonth(),r=s-s%3;return n.setMonth(r,1),n.setHours(0,0,0,0),n}function vx(e,t){const n=Ze(e,t==null?void 0:t.in);return n.setDate(1),n.setHours(0,0,0,0),n}function xx(e,t){const n=Ze(e,t==null?void 0:t.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}const wx={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},jx=(e,t,n)=>{let s;const r=wx[e];return typeof r=="string"?s=r:t===1?s=r.one:s=r.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+s:s+" ago":s};function Cl(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const Sx={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},kx={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Nx={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},bx={date:Cl({formats:Sx,defaultWidth:"full"}),time:Cl({formats:kx,defaultWidth:"full"}),dateTime:Cl({formats:Nx,defaultWidth:"full"})},Cx={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Dx=(e,t,n,s)=>Cx[e];function cr(e){return(t,n)=>{const s=n!=null&&n.context?String(n.context):"standalone";let r;if(s==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,l=n!=null&&n.width?String(n.width):o;r=e.formattingValues[l]||e.formattingValues[o]}else{const o=e.defaultWidth,l=n!=null&&n.width?String(n.width):e.defaultWidth;r=e.values[l]||e.values[o]}const i=e.argumentCallback?e.argumentCallback(t):t;return r[i]}}const $x={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Ex={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Tx={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Px={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Mx={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Ix={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Lx=(e,t)=>{const n=Number(e),s=n%100;if(s>20||s<10)switch(s%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Ax={ordinalNumber:Lx,era:cr({values:$x,defaultWidth:"wide"}),quarter:cr({values:Ex,defaultWidth:"wide",argumentCallback:e=>e-1}),month:cr({values:Tx,defaultWidth:"wide"}),day:cr({values:Px,defaultWidth:"wide"}),dayPeriod:cr({values:Mx,defaultWidth:"wide",formattingValues:Ix,defaultFormattingWidth:"wide"})};function dr(e){return(t,n={})=>{const s=n.width,r=s&&e.matchPatterns[s]||e.matchPatterns[e.defaultMatchWidth],i=t.match(r);if(!i)return null;const o=i[0],l=s&&e.parsePatterns[s]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?Bx(l,h=>h.test(o)):Rx(l,h=>h.test(o));let d;d=e.valueCallback?e.valueCallback(c):c,d=n.valueCallback?n.valueCallback(d):d;const f=t.slice(o.length);return{value:d,rest:f}}}function Rx(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function Bx(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function Fx(e){return(t,n={})=>{const s=t.match(e.matchPattern);if(!s)return null;const r=s[0],i=t.match(e.parsePattern);if(!i)return null;let o=e.valueCallback?e.valueCallback(i[0]):i[0];o=n.valueCallback?n.valueCallback(o):o;const l=t.slice(r.length);return{value:o,rest:l}}}const Ox=/^(\d+)(th|st|nd|rd)?/i,Hx=/\d+/i,qx={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},zx={any:[/^b/i,/^(a|c)/i]},Wx={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Ux={any:[/1/i,/2/i,/3/i,/4/i]},Vx={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Gx={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Qx={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Yx={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Xx={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Kx={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Zx={ordinalNumber:Fx({matchPattern:Ox,parsePattern:Hx,valueCallback:e=>parseInt(e,10)}),era:dr({matchPatterns:qx,defaultMatchWidth:"wide",parsePatterns:zx,defaultParseWidth:"any"}),quarter:dr({matchPatterns:Wx,defaultMatchWidth:"wide",parsePatterns:Ux,defaultParseWidth:"any",valueCallback:e=>e+1}),month:dr({matchPatterns:Vx,defaultMatchWidth:"wide",parsePatterns:Gx,defaultParseWidth:"any"}),day:dr({matchPatterns:Qx,defaultMatchWidth:"wide",parsePatterns:Yx,defaultParseWidth:"any"}),dayPeriod:dr({matchPatterns:Xx,defaultMatchWidth:"any",parsePatterns:Kx,defaultParseWidth:"any"})},Jx={code:"en-US",formatDistance:jx,formatLong:bx,formatRelative:Dx,localize:Ax,match:Zx,options:{weekStartsOn:0,firstWeekContainsDate:1}};function e0(e,t){const n=Ze(e,t==null?void 0:t.in);return tg(n,xx(n))+1}function t0(e,t){const n=Ze(e,t==null?void 0:t.in),s=+wo(n)-+fx(n);return Math.round(s/Xp)+1}function sg(e,t){var f,h,p,_;const n=Ze(e,t==null?void 0:t.in),s=n.getFullYear(),r=Xo(),i=(t==null?void 0:t.firstWeekContainsDate)??((h=(f=t==null?void 0:t.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??r.firstWeekContainsDate??((_=(p=r.locale)==null?void 0:p.options)==null?void 0:_.firstWeekContainsDate)??1,o=qt((t==null?void 0:t.in)||e,0);o.setFullYear(s+1,0,i),o.setHours(0,0,0,0);const l=Ds(o,t),c=qt((t==null?void 0:t.in)||e,0);c.setFullYear(s,0,i),c.setHours(0,0,0,0);const d=Ds(c,t);return+n>=+l?s+1:+n>=+d?s:s-1}function n0(e,t){var l,c,d,f;const n=Xo(),s=(t==null?void 0:t.firstWeekContainsDate)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??n.firstWeekContainsDate??((f=(d=n.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??1,r=sg(e,t),i=qt((t==null?void 0:t.in)||e,0);return i.setFullYear(r,0,s),i.setHours(0,0,0,0),Ds(i,t)}function Zd(e,t){const n=Ze(e,t==null?void 0:t.in),s=+Ds(n,t)-+n0(n,t);return Math.round(s/Xp)+1}function we(e,t){const n=e<0?"-":"",s=Math.abs(e).toString().padStart(t,"0");return n+s}const Xn={y(e,t){const n=e.getFullYear(),s=n>0?n:1-n;return we(t==="yy"?s%100:s,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):we(n+1,2)},d(e,t){return we(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return we(e.getHours()%12||12,t.length)},H(e,t){return we(e.getHours(),t.length)},m(e,t){return we(e.getMinutes(),t.length)},s(e,t){return we(e.getSeconds(),t.length)},S(e,t){const n=t.length,s=e.getMilliseconds(),r=Math.trunc(s*Math.pow(10,n-3));return we(r,t.length)}},da={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},If={G:function(e,t,n){const s=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(s,{width:"abbreviated"});case"GGGGG":return n.era(s,{width:"narrow"});case"GGGG":default:return n.era(s,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const s=e.getFullYear(),r=s>0?s:1-s;return n.ordinalNumber(r,{unit:"year"})}return Xn.y(e,t)},Y:function(e,t,n,s){const r=sg(e,s),i=r>0?r:1-r;if(t==="YY"){const o=i%100;return we(o,2)}return t==="Yo"?n.ordinalNumber(i,{unit:"year"}):we(i,t.length)},R:function(e,t){const n=eg(e);return we(n,t.length)},u:function(e,t){const n=e.getFullYear();return we(n,t.length)},Q:function(e,t,n){const s=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(s);case"QQ":return we(s,2);case"Qo":return n.ordinalNumber(s,{unit:"quarter"});case"QQQ":return n.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(s,{width:"wide",context:"formatting"})}},q:function(e,t,n){const s=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(s);case"qq":return we(s,2);case"qo":return n.ordinalNumber(s,{unit:"quarter"});case"qqq":return n.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(s,{width:"wide",context:"standalone"})}},M:function(e,t,n){const s=e.getMonth();switch(t){case"M":case"MM":return Xn.M(e,t);case"Mo":return n.ordinalNumber(s+1,{unit:"month"});case"MMM":return n.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(s,{width:"wide",context:"formatting"})}},L:function(e,t,n){const s=e.getMonth();switch(t){case"L":return String(s+1);case"LL":return we(s+1,2);case"Lo":return n.ordinalNumber(s+1,{unit:"month"});case"LLL":return n.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(s,{width:"wide",context:"standalone"})}},w:function(e,t,n,s){const r=Zd(e,s);return t==="wo"?n.ordinalNumber(r,{unit:"week"}):we(r,t.length)},I:function(e,t,n){const s=t0(e);return t==="Io"?n.ordinalNumber(s,{unit:"week"}):we(s,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):Xn.d(e,t)},D:function(e,t,n){const s=e0(e);return t==="Do"?n.ordinalNumber(s,{unit:"dayOfYear"}):we(s,t.length)},E:function(e,t,n){const s=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(s,{width:"short",context:"formatting"});case"EEEE":default:return n.day(s,{width:"wide",context:"formatting"})}},e:function(e,t,n,s){const r=e.getDay(),i=(r-s.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return we(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});case"eeee":default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(e,t,n,s){const r=e.getDay(),i=(r-s.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return we(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});case"cccc":default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(e,t,n){const s=e.getDay(),r=s===0?7:s;switch(t){case"i":return String(r);case"ii":return we(r,t.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(s,{width:"short",context:"formatting"});case"iiii":default:return n.day(s,{width:"wide",context:"formatting"})}},a:function(e,t,n){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){const s=e.getHours();let r;switch(s===12?r=da.noon:s===0?r=da.midnight:r=s/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){const s=e.getHours();let r;switch(s>=17?r=da.evening:s>=12?r=da.afternoon:s>=4?r=da.morning:r=da.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let s=e.getHours()%12;return s===0&&(s=12),n.ordinalNumber(s,{unit:"hour"})}return Xn.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):Xn.H(e,t)},K:function(e,t,n){const s=e.getHours()%12;return t==="Ko"?n.ordinalNumber(s,{unit:"hour"}):we(s,t.length)},k:function(e,t,n){let s=e.getHours();return s===0&&(s=24),t==="ko"?n.ordinalNumber(s,{unit:"hour"}):we(s,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Xn.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Xn.s(e,t)},S:function(e,t){return Xn.S(e,t)},X:function(e,t,n){const s=e.getTimezoneOffset();if(s===0)return"Z";switch(t){case"X":return Af(s);case"XXXX":case"XX":return Os(s);case"XXXXX":case"XXX":default:return Os(s,":")}},x:function(e,t,n){const s=e.getTimezoneOffset();switch(t){case"x":return Af(s);case"xxxx":case"xx":return Os(s);case"xxxxx":case"xxx":default:return Os(s,":")}},O:function(e,t,n){const s=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Lf(s,":");case"OOOO":default:return"GMT"+Os(s,":")}},z:function(e,t,n){const s=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Lf(s,":");case"zzzz":default:return"GMT"+Os(s,":")}},t:function(e,t,n){const s=Math.trunc(+e/1e3);return we(s,t.length)},T:function(e,t,n){return we(+e,t.length)}};function Lf(e,t=""){const n=e>0?"-":"+",s=Math.abs(e),r=Math.trunc(s/60),i=s%60;return i===0?n+String(r):n+String(r)+t+we(i,2)}function Af(e,t){return e%60===0?(e>0?"-":"+")+we(Math.abs(e)/60,2):Os(e,t)}function Os(e,t=""){const n=e>0?"-":"+",s=Math.abs(e),r=we(Math.trunc(s/60),2),i=we(s%60,2);return n+r+t+i}const Rf=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},ag=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},s0=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],s=n[1],r=n[2];if(!r)return Rf(e,t);let i;switch(s){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",Rf(s,t)).replace("{{time}}",ag(r,t))},a0={p:ag,P:s0},r0=/^D+$/,i0=/^Y+$/,o0=["D","DD","YY","YYYY"];function l0(e){return r0.test(e)}function c0(e){return i0.test(e)}function d0(e,t,n){const s=u0(e,t,n);if(console.warn(s),o0.includes(e))throw new RangeError(s)}function u0(e,t,n){const s=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${s} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const f0=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,h0=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,m0=/^'([^]*?)'?$/,p0=/''/g,g0=/[a-zA-Z]/;function be(e,t,n){var f,h,p,_;const s=Xo(),r=s.locale??Jx,i=s.firstWeekContainsDate??((h=(f=s.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??1,o=s.weekStartsOn??((_=(p=s.locale)==null?void 0:p.options)==null?void 0:_.weekStartsOn)??0,l=Ze(e,n==null?void 0:n.in);if(!px(l))throw new RangeError("Invalid time value");let c=t.match(h0).map(v=>{const u=v[0];if(u==="p"||u==="P"){const y=a0[u];return y(v,r.formatLong)}return v}).join("").match(f0).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const u=v[0];if(u==="'")return{isToken:!1,value:_0(v)};if(If[u])return{isToken:!0,value:v};if(u.match(g0))throw new RangeError("Format string contains an unescaped latin alphabet character `"+u+"`");return{isToken:!1,value:v}});r.localize.preprocessor&&(c=r.localize.preprocessor(l,c));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:r};return c.map(v=>{if(!v.isToken)return v.value;const u=v.value;(c0(u)||l0(u))&&d0(u,t,String(e));const y=If[u[0]];return y(l,u,r.localize,d)}).join("")}function _0(e){const t=e.match(m0);return t?t[1].replace(p0,"'"):e}function Gn(e,t){const n=()=>qt(t==null?void 0:t.in,NaN),r=w0(e);let i;if(r.date){const d=j0(r.date,2);i=S0(d.restDateString,d.year)}if(!i||isNaN(+i))return n();const o=+i;let l=0,c;if(r.time&&(l=k0(r.time),isNaN(l)))return n();if(r.timezone){if(c=N0(r.timezone),isNaN(c))return n()}else{const d=new Date(o+l),f=Ze(0,t==null?void 0:t.in);return f.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),f.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),f}return Ze(o+l+c,t==null?void 0:t.in)}const Di={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},y0=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,v0=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,x0=/^([+-])(\d{2})(?::?(\d{2}))?$/;function w0(e){const t={},n=e.split(Di.dateTimeDelimiter);let s;if(n.length>2)return t;if(/:/.test(n[0])?s=n[0]:(t.date=n[0],s=n[1],Di.timeZoneDelimiter.test(t.date)&&(t.date=e.split(Di.timeZoneDelimiter)[0],s=e.substr(t.date.length,e.length))),s){const r=Di.timezone.exec(s);r?(t.time=s.replace(r[1],""),t.timezone=r[1]):t.time=s}return t}function j0(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),s=e.match(n);if(!s)return{year:NaN,restDateString:""};const r=s[1]?parseInt(s[1]):null,i=s[2]?parseInt(s[2]):null;return{year:i===null?r:i*100,restDateString:e.slice((s[1]||s[2]).length)}}function S0(e,t){if(t===null)return new Date(NaN);const n=e.match(y0);if(!n)return new Date(NaN);const s=!!n[4],r=ur(n[1]),i=ur(n[2])-1,o=ur(n[3]),l=ur(n[4]),c=ur(n[5])-1;if(s)return E0(t,l,c)?b0(t,l,c):new Date(NaN);{const d=new Date(0);return!D0(t,i,o)||!$0(t,r)?new Date(NaN):(d.setUTCFullYear(t,i,Math.max(r,o)),d)}}function ur(e){return e?parseInt(e):1}function k0(e){const t=e.match(v0);if(!t)return NaN;const n=Dl(t[1]),s=Dl(t[2]),r=Dl(t[3]);return T0(n,s,r)?n*Zp+s*Kp+r*1e3:NaN}function Dl(e){return e&&parseFloat(e.replace(",","."))||0}function N0(e){if(e==="Z")return 0;const t=e.match(x0);if(!t)return 0;const n=t[1]==="+"?-1:1,s=parseInt(t[2]),r=t[3]&&parseInt(t[3])||0;return P0(s,r)?n*(s*Zp+r*Kp):NaN}function b0(e,t,n){const s=new Date(0);s.setUTCFullYear(e,0,4);const r=s.getUTCDay()||7,i=(t-1)*7+n+1-r;return s.setUTCDate(s.getUTCDate()+i),s}const C0=[31,null,31,30,31,30,31,31,30,31,30,31];function rg(e){return e%400===0||e%4===0&&e%100!==0}function D0(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(C0[t]||(rg(e)?29:28))}function $0(e,t){return t>=1&&t<=(rg(e)?366:365)}function E0(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function T0(e,t,n){return e===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}function P0(e,t){return t>=0&&t<=59}const Zo={week:{before:26,after:52},month:{after:36},quarter:{after:16},year:{before:3,after:7}};function ai(e,t,n,s){const r=new Date;r.setHours(0,0,0,0);const i=o=>{const l=be(o,"yyyy-MM-dd"),c=s.find(d=>d.date===l);return c==null?void 0:c.name};switch(t){case"week":return M0(e,r,n,i);case"month":return I0(e,r,n,i);case"quarter":return L0(e,r,n,i);case"year":return A0(e);default:return[]}}function M0(e,t,n,s){const r=[],{before:i,after:o}=Zo.week,l=Ds(e,{weekStartsOn:1}),c=Kd(l,-i),f=(i+o+1)*7;for(let h=0;h<f;h++){const p=En(c,h);r.push(Jd(p,t,n,s))}return r}function I0(e,t,n,s){const r=[],{after:i}=Zo.month,o=vx(e),l=Tn(o,-12),c=gx(Tn(o,i));let d=l;for(;d<=c;)r.push(Jd(d,t,n,s)),d=En(d,1);return r}function L0(e,t,n,s){const r=[],{after:i}=Zo.quarter,o=ng(e),l=Tn(o,-8*3),c=Tn(o,(i+1)*3);let d=Ds(l,{weekStartsOn:1});for(;d<c;){const f=En(d,6),h=t>=d&&t<=f,p=Jd(d,t,n,s);p.dateEnd=f,p.isToday=h,r.push(p),d=Kd(d,1)}return r}function A0(e,t,n,s){const r=[],{before:i,after:o}=Zo.year,l=new Date(e.getFullYear(),0,1),c=Tn(l,-i*12),d=(i+o+1)*12;for(let f=0;f<d;f++){const h=Tn(c,f);r.push(R0(h))}return r}function R0(e){const t=be(e,"yyyy-MM-dd"),n=e.getDay(),s=new Date;s.setHours(0,0,0,0);const r=e.getFullYear()===s.getFullYear()&&e.getMonth()===s.getMonth();return{date:e,dateStr:t,label:be(e,"MMM"),isToday:r,isWeekend:!1,isBankHoliday:!1,bankHolidayName:void 0,dayOfWeek:n,isFirstOfWeek:e.getDate()<=7&&n===1,isFirstOfMonth:!0,weekNumber:Zd(e,{weekStartsOn:1}),monthLabel:be(e,"MMM"),yearLabel:be(e,"yyyy")}}function Jd(e,t,n,s){const r=be(e,"yyyy-MM-dd"),i=e.getDay();return{date:e,dateStr:r,label:be(e,"d"),isToday:hx(e,t),isWeekend:Jp(e),isBankHoliday:n.has(r),bankHolidayName:s(e),dayOfWeek:i,isFirstOfWeek:i===1,isFirstOfMonth:e.getDate()===1,weekNumber:Zd(e,{weekStartsOn:1}),monthLabel:be(e,"MMM"),yearLabel:be(e,"yyyy")}}function ri(e,t){switch(t){case"week":return{primary:Bf(e),secondary:Ff(e)};case"month":return{primary:Bf(e),secondary:Ff(e)};case"quarter":return{primary:B0(e),secondary:F0(e)};case"year":return{primary:O0(e),secondary:H0(e)};default:return{primary:[],secondary:[]}}}function Bf(e){const t=[];let n="",s=0;const r=new Date;return e.forEach((i,o)=>{const l=`${i.yearLabel}-${i.monthLabel}`;l!==n?(s>0&&t.push({label:n.split("-")[1]+" "+n.split("-")[0],span:s,isCurrentPeriod:!1}),n=l,s=1):s++,o===e.length-1&&t.push({label:n.split("-")[1]+" "+n.split("-")[0],span:s,isCurrentPeriod:be(r,"yyyy-MMM")===n})}),t}function Ff(e){return e.map(t=>({label:t.label,span:1,isCurrentPeriod:t.isToday}))}function B0(e){const t=[];let n="",s=0;return e.forEach((r,i)=>{const l=`Q${Math.floor(r.date.getMonth()/3)+1} ${r.yearLabel}`;l!==n?(s>0&&t.push({label:n,span:s,isCurrentPeriod:!1}),n=l,s=1):s++,i===e.length-1&&t.push({label:n,span:s,isCurrentPeriod:!1})}),t}function F0(e){return e.map(t=>({label:`W${t.weekNumber}`,span:1,isCurrentPeriod:t.isToday}))}function O0(e){const t=[];let n="",s=0;const r=new Date().getFullYear().toString();return e.forEach((i,o)=>{i.yearLabel!==n?(s>0&&t.push({label:n,span:s,isCurrentPeriod:n===r}),n=i.yearLabel,s=1):s++,o===e.length-1&&t.push({label:n,span:s,isCurrentPeriod:n===r})}),t}function H0(e){const n=be(new Date,"yyyy-MM");return e.map(s=>({label:s.monthLabel,span:1,isCurrentPeriod:be(s.date,"yyyy-MM")===n}))}function Mt(e,t,n,s,r){if(!n.length||!e||!t)return null;const i=String(e).split("T")[0],o=String(t).split("T")[0],l=new Date(i+"T00:00:00"),c=new Date(o+"T23:59:59.999");if(isNaN(l.getTime())||isNaN(c.getTime()))return null;const d=new Date(n[0].date);d.setHours(0,0,0,0);let f;const h=n[n.length-1];if(r==="quarter"&&h.dateEnd?(f=new Date(h.dateEnd),f.setHours(23,59,59,999)):r==="year"?(f=new Date(h.date),f=new Date(f.getFullYear(),f.getMonth()+1,0,23,59,59,999)):(f=new Date(h.date),f.setHours(23,59,59,999)),c<d||l>f)return null;const p=f.getTime()-d.getTime(),_=n.length*s,u=(Math.max(d.getTime(),l.getTime())-d.getTime())/p*_,m=(Math.min(f.getTime(),c.getTime())-d.getTime())/p*_,x=Math.max(20,m-u);return{left:u,width:x}}function q0(e,t){const n=e.findIndex(s=>s.isToday);return n===-1?null:n*t+t/2}function z0(e){const t=[];return e.forEach(n=>{(n.phases??[]).forEach(s=>{(s.dependencies??[]).forEach(r=>{const{item:i,type:o}=og(n,r.id);i&&t.push({id:`dep-${o}-${r.id}-phase-${s.id}`,fromId:r.id,fromType:o,toId:s.id,toType:"phase",type:r.type||"FS",lag:r.lag??0,projectId:n.id})}),ig(n,s.children??[],t)})}),t}function ig(e,t,n){t.forEach(s=>{var r;(s.dependencies??[]).forEach(i=>{const{item:o,type:l}=og(e,i.id);o&&n.push({id:`dep-${l}-${i.id}-subphase-${s.id}`,fromId:i.id,fromType:l,toId:s.id,toType:"subphase",type:i.type||"FS",lag:i.lag??0,projectId:e.id})}),(r=s.children)!=null&&r.length&&ig(e,s.children,n)})}function og(e,t){const n=(e.phases??[]).find(s=>s.id===t);if(n)return{item:n,type:"phase"};for(const s of e.phases??[]){const r=lg(s.children??[],t);if(r)return{item:r,type:"subphase"}}return{item:null,type:"subphase"}}function lg(e,t){var n;for(const s of e){if(s.id===t)return s;if((n=s.children)!=null&&n.length){const r=lg(s.children,t);if(r)return r}}return null}const W0={FS:{dashArray:"",description:"Finish-to-Start (solid)"},SS:{dashArray:"6,3",description:"Start-to-Start (long dash)"},FF:{dashArray:"4,2",description:"Finish-to-Finish (short dash)"},SF:{dashArray:"2,2",description:"Start-to-Finish (dotted)"}},cg=5;function Vt(e,t,n,s,r=cg){const i=r,o={"right-down":{dx1:-i,dy1:0,dx2:0,dy2:i,sweep:1},"right-up":{dx1:-i,dy1:0,dx2:0,dy2:-i,sweep:0},"left-down":{dx1:i,dy1:0,dx2:0,dy2:i,sweep:0},"left-up":{dx1:i,dy1:0,dx2:0,dy2:-i,sweep:1},"down-right":{dx1:0,dy1:-i,dx2:i,dy2:0,sweep:0},"down-left":{dx1:0,dy1:-i,dx2:-i,dy2:0,sweep:1},"up-right":{dx1:0,dy1:i,dx2:i,dy2:0,sweep:1},"up-left":{dx1:0,dy1:i,dx2:-i,dy2:0,sweep:0}},l=`${n}-${s}`,c=o[l];if(!c)return`L ${e} ${t}`;const d=e+c.dx1,f=t+c.dy1,h=e+c.dx2,p=t+c.dy2;return`L ${d} ${f} A ${i} ${i} 0 0 ${c.sweep} ${h} ${p}`}function U0(e,t,n,s,r){const o=cg,l=s>t?"down":"up";if(r==="FS")if(n>e+15){const c=e+(n-e)/2;return Math.abs(s-t)<o*2?`M ${e} ${t} H ${c} V ${s} H ${n}`:`M ${e} ${t} H ${c-o} ${Vt(c,t,"right",l,o)} V ${s-(s>t?o:-o)} ${Vt(c,s,l,"right",o)} H ${n}`}else{const c=t+(s>t?20:-20),d=Math.min(e,n)-15,f=e+15;if(Math.abs(c-t)<o*2||Math.abs(s-c)<o*2)return`M ${e} ${t} H ${f} V ${c} H ${d} V ${s} H ${n}`;const h=c>t?"down":"up",p=s>c?"down":"up";return`M ${e} ${t} H ${f-o} ${Vt(f,t,"right",h,o)} V ${c-(c>t?o:-o)} ${Vt(f,c,h,"left",o)} H ${d+o} ${Vt(d,c,"left",p,o)} V ${s-(s>c?o:-o)} ${Vt(d,s,p,"right",o)} H ${n}`}if(r==="SS"){const c=Math.min(e,n)-15;return Math.abs(s-t)<o*2?`M ${e} ${t} H ${c} V ${s} H ${n}`:`M ${e} ${t} H ${c+o} ${Vt(c,t,"left",l,o)} V ${s-(s>t?o:-o)} ${Vt(c,s,l,"right",o)} H ${n}`}if(r==="FF"){const c=Math.max(e,n)+15;return Math.abs(s-t)<o*2?`M ${e} ${t} H ${c} V ${s} H ${n}`:`M ${e} ${t} H ${c-o} ${Vt(c,t,"right",l,o)} V ${s-(s>t?o:-o)} ${Vt(c,s,l,"left",o)} H ${n}`}if(r==="SF")if(n<e-15){const c=e-(e-n)/2;return Math.abs(s-t)<o*2?`M ${e} ${t} H ${c} V ${s} H ${n}`:`M ${e} ${t} H ${c+o} ${Vt(c,t,"left",l,o)} V ${s-(s>t?o:-o)} ${Vt(c,s,l,"left",o)} H ${n}`}else{const c=Math.min(e,n)-15,d=Math.max(e,n)+15,f=t+(s>t?20:-20);return`M ${e} ${t} H ${c} V ${f} H ${d} V ${s} H ${n}`}return`M ${e} ${t} L ${n} ${s}`}function V0(e){switch(e){case"FS":return{sourceEdge:"end",targetEdge:"start"};case"SS":return{sourceEdge:"start",targetEdge:"start"};case"FF":return{sourceEdge:"end",targetEdge:"end"};case"SF":return{sourceEdge:"start",targetEdge:"end"};default:return{sourceEdge:"end",targetEdge:"start"}}}const So=32,G0=45,Cn=33;function Q0(e,t,n,s,r){const i=new Map;let o=0,l;return e.forEach(c=>{var d,f;if(o+=G0,t.has(c.id)){(c.phases??[]).forEach(_=>{var u,y;const v=o;if(i.set(`phase-${_.id}`,{top:v,height:So}),o+=Cn,(r==null?void 0:r.type)==="phase"&&r.projectId===c.id&&r.sourceId===_.id&&(l=o,i.set("phantom",{top:o,height:So}),o+=Cn),n.has(_.id)){const m=dg(_.children??[],i,o,s,r,c.id,_.id);o=m.currentTop,m.phantomRowTop!==void 0&&(l=m.phantomRowTop);const x=((u=_.staffAssignments)==null?void 0:u.length)??0;o+=x*Cn;const w=((y=_.equipmentAssignments)==null?void 0:y.length)??0;o+=w*Cn}});const h=((d=c.staffAssignments)==null?void 0:d.length)??0;o+=h*Cn;const p=((f=c.equipmentAssignments)==null?void 0:f.length)??0;o+=p*Cn}}),{positions:i,totalHeight:o,phantomRowTop:l}}function dg(e,t,n,s,r,i,o,l){let c;return e.forEach(d=>{var f,h,p;if(t.set(`subphase-${d.id}`,{top:n,height:So}),n+=Cn,(r==null?void 0:r.type)==="subphase"&&r.projectId===i&&r.sourceId===d.id&&(c=n,t.set("phantom",{top:n,height:So}),n+=Cn),s.has(d.id)){if((f=d.children)!=null&&f.length){const u=dg(d.children,t,n,s,r,i,o,d.id);n=u.currentTop,u.phantomRowTop!==void 0&&(c=u.phantomRowTop)}const _=((h=d.staffAssignments)==null?void 0:h.length)??0;n+=_*Cn;const v=((p=d.equipmentAssignments)==null?void 0:p.length)??0;n+=v*Cn}}),{currentTop:n,phantomRowTop:c}}function an(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${n}-${s}`}function qc(e,t,n){for(const s of e){const r=new Date(s.start_date),i=new Date(s.end_date),o=new Date(r);o.setDate(o.getDate()+t);const l=new Date(i);l.setDate(l.getDate()+t),s.start_date=an(o),s.end_date=an(l),n.push({type:"staffAssignment",id:s.id,start_date:s.start_date,end_date:s.end_date,allocation:s.allocation??100})}}function zc(e,t,n){for(const s of e){const r=new Date(s.start_date),i=new Date(s.end_date),o=new Date(r);o.setDate(o.getDate()+t);const l=new Date(i);l.setDate(l.getDate()+t),s.start_date=an(o),s.end_date=an(l),n.push({type:"equipmentAssignment",id:s.id,start_date:s.start_date,end_date:s.end_date})}}function ko(e,t,n){var s,r,i;for(const o of e){const l=new Date(o.start_date),c=new Date(o.end_date),d=new Date(l);d.setDate(d.getDate()+t);const f=new Date(c);f.setDate(f.getDate()+t),o.start_date=an(d),o.end_date=an(f),n.push({type:"subphase",id:o.id,start_date:o.start_date,end_date:o.end_date}),(s=o.staffAssignments)!=null&&s.length&&qc(o.staffAssignments,t,n),(r=o.equipmentAssignments)!=null&&r.length&&zc(o.equipmentAssignments,t,n),(i=o.children)!=null&&i.length&&ko(o.children,t,n)}}function Y0(e,t,n){var s,r,i,o,l;for(const c of e.phases??[]){const d=new Date(c.start_date),f=new Date(c.end_date),h=new Date(d);h.setDate(h.getDate()+t);const p=new Date(f);p.setDate(p.getDate()+t),c.start_date=an(h),c.end_date=an(p),n.push({type:"phase",id:c.id,start_date:c.start_date,end_date:c.end_date}),(s=c.staffAssignments)!=null&&s.length&&qc(c.staffAssignments,t,n),(r=c.equipmentAssignments)!=null&&r.length&&zc(c.equipmentAssignments,t,n),(i=c.children)!=null&&i.length&&ko(c.children,t,n)}(o=e.staffAssignments)!=null&&o.length&&qc(e.staffAssignments,t,n),(l=e.equipmentAssignments)!=null&&l.length&&zc(e.equipmentAssignments,t,n)}function Of(e,t){for(const n of e.phases??[])for(const s of n.children??[]){if(s.id===t)return{parent:n,type:"phase"};const r=ug(s,t);if(r)return r}return null}function ug(e,t){for(const n of e.children??[]){if(n.id===t)return{parent:e,type:"subphase"};const s=ug(n,t);if(s)return s}return null}function X0(e,t,n){let s=t,r=Of(e,s);for(;r;){const i=r.parent,o=i.children??[];if(o.length===0)break;let l=null,c=null;for(const p of o){const _=new Date(p.start_date),v=new Date(p.end_date);(!l||_<l)&&(l=_),(!c||v>c)&&(c=v)}if(!l||!c)break;const d=new Date(i.start_date),f=new Date(i.end_date);let h=!1;if(l.getTime()!==d.getTime()&&(i.start_date=an(l),h=!0),c.getTime()!==f.getTime()&&(i.end_date=an(c),h=!0),h&&n.push({type:r.type,id:i.id,start_date:i.start_date,end_date:i.end_date}),r.type==="phase"){fg(e,n);break}else s=i.id,r=Of(e,s)}}function fg(e,t){const n=e.phases??[];if(n.length===0)return;let s=null,r=null;for(const l of n){const c=new Date(l.start_date),d=new Date(l.end_date);(!s||c<s)&&(s=c),(!r||d>r)&&(r=d)}if(!s||!r)return;const i=an(s),o=an(r);if(e.start_date!==i||e.end_date!==o){e.start_date=i,e.end_date=o;const l=t.findIndex(c=>c.type==="project"&&c.id===e.id);l>=0?(t[l].start_date=i,t[l].end_date=o):t.push({type:"project",id:e.id,start_date:i,end_date:o,name:e.name,pm_id:e.pm_id,customer:e.customer,sales_pm:e.sales_pm,volume:e.volume,confirmed:e.confirmed})}}async function hg(e){const t=e.map(n=>n.type==="phase"?ia(n.id,{start_date:n.start_date,end_date:n.end_date}).catch(s=>console.error(`Failed to save phase ${n.id}:`,s)):n.type==="subphase"?Ps(n.id,{start_date:n.start_date,end_date:n.end_date}).catch(s=>console.error(`Failed to save subphase ${n.id}:`,s)):n.type==="project"?si(n.id,{name:n.name,start_date:n.start_date,end_date:n.end_date,pm_id:n.pm_id,customer:n.customer,sales_pm:n.sales_pm,volume:n.volume,confirmed:n.confirmed}).catch(s=>console.error(`Failed to save project ${n.id}:`,s)):n.type==="staffAssignment"?Qo(n.id,{start_date:n.start_date,end_date:n.end_date,allocation:n.allocation??100}).catch(s=>console.error(`Failed to save staff assignment ${n.id}:`,s)):n.type==="equipmentAssignment"?Yo(n.id,{start_date:n.start_date,end_date:n.end_date}).catch(s=>console.error(`Failed to save equipment assignment ${n.id}:`,s)):Promise.resolve());await Promise.all(t)}function mg(e,t,n,s){const r=[];return fg(e,r),r}function pg(e,t,n,s){const r=[];return X0(e,t,r),r}function gg(e){return JSON.parse(JSON.stringify(e))}function K0(){const{isDragging:e,dragType:t,dragItemId:n,startDrag:s,endDrag:r,showDragIndicator:i,hideIndicator:o}=Z(),{projects:l,setProjects:c,cellWidth:d,currentView:f,viewMode:h}=F(),{saveState:p}=Yp(),_=g.useRef(null),v=g.useRef(0),u=g.useCallback(k=>{const E=k.getFullYear(),I=String(k.getMonth()+1).padStart(2,"0"),M=String(k.getDate()).padStart(2,"0");return`${E}-${I}-${M}`},[]),y=g.useCallback(()=>{const k=document.querySelectorAll("[data-date]");if(k.length===0)return null;const E=[];return k.forEach(I=>{const M=I.getAttribute("data-date"),B=I.getAttribute("data-date-end");M&&E.push({date:M,dateEnd:B||void 0})}),E.length>0?E:null},[]),m=g.useCallback((k,E,I,M)=>{if(E.length===0)return null;if(M==="week"||M==="month"){const Q=Math.round(k/I),Y=Math.max(0,Math.min(E.length-1,Q));return E[Y].date}const B=new Date(E[0].date);B.setHours(0,0,0,0);let C;const R=E[E.length-1];M==="quarter"&&R.dateEnd?(C=new Date(R.dateEnd),C.setHours(23,59,59,999)):M==="year"?(C=new Date(R.date),C=new Date(C.getFullYear(),C.getMonth()+1,0,23,59,59,999)):(C=new Date(R.date),C.setHours(23,59,59,999));const A=C.getTime()-B.getTime(),H=E.length*I,z=k/H*A,K=new Date(B.getTime()+z);return u(K)},[u]),x=g.useCallback((k,E,I)=>{const M=l.find(Y=>Y.id===E);if(!M)return null;const B=(M.phases??[]).find(Y=>Y.id===k);if(!B)return null;const C=B.dependencies??[];if(C.length===0)return null;const R=new Date(B.start_date),H=new Date(B.end_date).getTime()-R.getTime(),z=new Date(I),K=new Date(z.getTime()+H);let Q=null;for(const Y of C){const J=(M.phases??[]).find(G=>G.id===Y.id);if(!J)continue;const ne=new Date(J.start_date),O=new Date(J.end_date);let V;if(Y.type==="SS")V=Math.round((z.getTime()-ne.getTime())/864e5);else if(Y.type==="FF")V=Math.round((K.getTime()-O.getTime())/864e5);else if(Y.type==="SF")V=Math.round((K.getTime()-ne.getTime())/864e5);else{const G=new Date(O);G.setDate(G.getDate()+1),V=Math.round((z.getTime()-G.getTime())/864e5)}(Q===null||V<Q)&&(Q=V)}return Q},[l]),w=g.useCallback((k,E)=>{var M;const I=B=>{var C;for(const R of B){if(R.id===E)return R;if((C=R.children)!=null&&C.length){const A=I(R.children);if(A)return A}}return null};for(const B of k.phases??[])if((M=B.children)!=null&&M.length){const C=I(B.children);if(C)return C}return null},[]),b=g.useCallback((k,E,I)=>{const M=l.find(Y=>Y.id===E);if(!M)return null;const B=w(M,k);if(!B)return null;const C=B.dependencies??[];if(C.length===0)return null;const R=new Date(B.start_date),H=new Date(B.end_date).getTime()-R.getTime(),z=new Date(I),K=new Date(z.getTime()+H);let Q=null;for(const Y of C){const J=w(M,Y.id);if(!J)continue;const ne=new Date(J.start_date),O=new Date(J.end_date);let V;if(Y.type==="SS")V=Math.round((z.getTime()-ne.getTime())/864e5);else if(Y.type==="FF")V=Math.round((K.getTime()-O.getTime())/864e5);else if(Y.type==="SF")V=Math.round((K.getTime()-ne.getTime())/864e5);else{const G=new Date(O);G.setDate(G.getDate()+1),V=Math.round((z.getTime()-G.getTime())/864e5)}(Q===null||V<Q)&&(Q=V)}return Q},[l,w]),S=g.useCallback(k=>{if(!_.current)return;v.current=k.clientX;const E=_.current,I=k.clientX-E.startX,M=E.originalLeft+I;E.element&&(E.element.style.left=`${M}px`,E.element.style.opacity="0.8",E.element.style.zIndex="1000");const B=y();if(B&&B.length>0&&E.element){const C=m(M,B,d,h);if(C){const R=E.type==="phase"?x(E.id,E.projectId,C):b(E.id,E.projectId,C);if(R!==null){const A=E.element.closest('[class*="row"]');if(A){const H=A.offsetTop,z=E.element.offsetWidth,K=M+z/2,Q=H-22;i(K,Q,R)}}else o()}}},[d,h,y,m,x,b,i,o]),N=g.useCallback(async()=>{if(o(),!_.current){r();return}const k=_.current;k.element&&(k.element.style.opacity="1",k.element.style.zIndex="",k.element.classList.remove("dragging")),document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",N);const E=k.element?parseFloat(k.element.style.left)||0:k.originalLeft,I=E-k.originalLeft;if(Math.abs(I)<2){_.current=null,r();return}const M=y();if(!M||M.length===0){console.warn("Could not get timeline cells for date calculation");const Y=Math.round(I/d),J=(V,G)=>{const re=new Date(V);return re.setDate(re.getDate()+G),re.toISOString().split("T")[0]},ne=J(k.originalStartDate,Y),O=k.isMilestone?ne:J(k.originalEndDate,Y);await D(k,ne,O);return}const B=m(E,M,d,h);if(!B){console.warn("Could not calculate date from position"),_.current=null,r();return}const C=new Date(k.originalStartDate),A=new Date(k.originalEndDate).getTime()-C.getTime(),H=new Date(B),z=new Date(H.getTime()+A),K=u(H),Q=k.isMilestone?K:u(z);await D(k,K,Q)},[d,h,r,S,p,c,l,o]),D=g.useCallback(async(k,E,I)=>{var M,B,C,R,A,H;try{const z=l.findIndex(G=>G.id===k.projectId);if(z===-1){console.error("Project not found:",k.projectId),_.current=null,r();return}const K=new Date(k.originalStartDate).getTime(),Q=new Date(E).getTime(),Y=Math.round((Q-K)/864e5);if(Y===0){_.current=null,r();return}if(k.type==="project"){const re=((M=l[z].phases)==null?void 0:M.length)??0;if(!window.confirm(`Move project by ${Y>0?"+":""}${Y} days?

This will move all ${re} phase(s), their subphases, and all staff/equipment assignments.`)){k.element&&(k.element.style.left=`${k.originalLeft}px`,k.element.classList.remove("dragging")),_.current=null,r();return}}p(l,"drag");const J=gg(l[z]),ne=[];if(k.type==="project")J.start_date=E,J.end_date=I,Y!==0&&Y0(J,Y,ne);else if(k.type==="phase"){const G=(J.phases??[]).find(re=>re.id===k.id);G&&(G.start_date=E,G.end_date=I,(B=G.children)!=null&&B.length&&Y!==0&&ko(G.children,Y,ne))}else{const G=re=>{var se,ve;for(const st of re){if(st.id===k.id)return st.start_date=E,st.end_date=I,(se=st.children)!=null&&se.length&&Y!==0&&ko(st.children,Y,ne),!0;if((ve=st.children)!=null&&ve.length&&G(st.children))return!0}return!1};for(const re of J.phases??[])if((C=re.children)!=null&&C.length&&G(re.children))break}let O=[];if(k.type==="phase")O=mg(J,k.id,k.originalEndDate,I);else if(k.type==="subphase")O=pg(J,k.id,k.originalEndDate,I);else if(k.type==="staffAssignment"){const G=(R=J.staffAssignments)==null?void 0:R.find(re=>re.id===k.id);G&&(G.start_date=E,G.end_date=I)}else if(k.type==="equipmentAssignment"){const G=(A=J.equipmentAssignments)==null?void 0:A.find(re=>re.id===k.id);G&&(G.start_date=E,G.end_date=I)}O.push(...ne);const V=l.map((G,re)=>re===z?J:G);if(c(V),k.type==="project")await si(k.id,{start_date:E,end_date:I});else if(k.type==="phase")await ia(k.id,{start_date:E,end_date:I});else if(k.type==="subphase")await Ps(k.id,{start_date:E,end_date:I});else if(k.type==="staffAssignment"){const G=(H=J.staffAssignments)==null?void 0:H.find(re=>re.id===k.id);await Qo(k.id,{start_date:E,end_date:I,allocation:(G==null?void 0:G.allocation)??100})}else k.type==="equipmentAssignment"&&await Yo(k.id,{start_date:E,end_date:I});O.length>0&&(console.log(`Saving ${O.length} cascaded updates`),await hg(O))}catch(z){console.error("Failed to update item:",z);const K=await Ke();c(K)}_.current=null,r()},[p,c,l,r]),L=g.useCallback((k,E,I,M,B,C=!1,R)=>{var H,z;if(k.target.classList.contains("resize-handle")||f==="equipment"||f==="staff")return;k.preventDefault(),k.stopPropagation();let A=R||k.currentTarget;if((!A||!((H=A.classList)!=null&&H.contains("gantt-bar"))&&!((z=A.dataset)!=null&&z.phaseId))&&(A=k.target.closest("[data-phase-id]")),!A){console.warn("Could not find element for drag");return}_.current={id:E,type:"phase",projectId:I,startX:k.clientX,element:A,originalLeft:parseInt((A==null?void 0:A.style.left)||"0")||0,originalStartDate:M,originalEndDate:B,isMilestone:C},v.current=k.clientX,A&&A.classList.add("dragging"),s("phase",E),document.addEventListener("mousemove",S),document.addEventListener("mouseup",N)},[f,S,N,s]),T=g.useCallback((k,E,I,M,B,C,R=!1,A)=>{var z,K;if(k.target.classList.contains("resize-handle")||f==="equipment"||f==="staff")return;k.preventDefault(),k.stopPropagation();let H=A||k.currentTarget;if((!H||!((z=H.classList)!=null&&z.contains("gantt-bar"))&&!((K=H.dataset)!=null&&K.subphaseId))&&(H=k.target.closest("[data-subphase-id]")),!H){console.warn("Could not find element for subphase drag");return}_.current={id:E,type:"subphase",projectId:I,phaseId:M,startX:k.clientX,element:H,originalLeft:parseInt((H==null?void 0:H.style.left)||"0")||0,originalStartDate:B,originalEndDate:C,isMilestone:R},v.current=k.clientX,H&&H.classList.add("dragging"),s("subphase",E),document.addEventListener("mousemove",S),document.addEventListener("mouseup",N)},[f,S,N,s]),j=g.useCallback((k,E,I,M,B)=>{var R,A;if(k.target.classList.contains("resize-handle")||f==="equipment"||f==="staff")return;k.preventDefault(),k.stopPropagation();let C=B||k.currentTarget;if((!C||!((R=C.classList)!=null&&R.contains("gantt-bar"))&&!((A=C.dataset)!=null&&A.projectId))&&(C=k.target.closest("[data-project-id]")),!C){console.warn("Could not find element for project drag");return}_.current={id:E,type:"project",projectId:E,startX:k.clientX,element:C,originalLeft:parseInt((C==null?void 0:C.style.left)||"0")||0,originalStartDate:I,originalEndDate:M,isMilestone:!1},v.current=k.clientX,C&&C.classList.add("dragging"),s("project",E),document.addEventListener("mousemove",S),document.addEventListener("mouseup",N)},[f,S,N,s]),$=g.useCallback((k,E,I,M,B,C)=>{var A;if(k.target.classList.contains("resize-handle")||f==="equipment"||f==="staff")return;k.preventDefault(),k.stopPropagation();let R=C||k.currentTarget;if((!R||!((A=R.dataset)!=null&&A.assignmentId))&&(R=k.target.closest("[data-assignment-id]")),!R){console.warn("Could not find element for staff assignment drag");return}_.current={id:E,type:"staffAssignment",projectId:I,startX:k.clientX,element:R,originalLeft:parseInt((R==null?void 0:R.style.left)||"0")||0,originalStartDate:M,originalEndDate:B,isMilestone:!1},v.current=k.clientX,R&&R.classList.add("dragging"),s("staffAssignment",E),document.addEventListener("mousemove",S),document.addEventListener("mouseup",N)},[f,S,N,s]),P=g.useCallback((k,E,I,M,B,C)=>{var A;if(k.target.classList.contains("resize-handle")||f==="equipment"||f==="staff")return;k.preventDefault(),k.stopPropagation();let R=C||k.currentTarget;if((!R||!((A=R.dataset)!=null&&A.assignmentId))&&(R=k.target.closest("[data-assignment-id]")),!R){console.warn("Could not find element for equipment assignment drag");return}_.current={id:E,type:"equipmentAssignment",projectId:I,startX:k.clientX,element:R,originalLeft:parseInt((R==null?void 0:R.style.left)||"0")||0,originalStartDate:M,originalEndDate:B,isMilestone:!1},v.current=k.clientX,R&&R.classList.add("dragging"),s("equipmentAssignment",E),document.addEventListener("mousemove",S),document.addEventListener("mouseup",N)},[f,S,N,s]);return g.useEffect(()=>()=>{document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",N)},[S,N]),{isDragging:e,dragType:t,dragItemId:n,startProjectDrag:j,startPhaseDrag:L,startSubphaseDrag:T,startStaffAssignmentDrag:$,startEquipmentAssignmentDrag:P}}function Z0(){const{isResizing:e,resizeEdge:t,resizeItemId:n,resizeItemType:s,startResize:r,endResize:i,showResizeIndicator:o,hideIndicator:l}=Z(),{projects:c,setProjects:d,cellWidth:f,currentView:h,viewMode:p}=F(),{saveState:_}=Yp(),v=g.useRef(null),u=g.useRef(0),y=g.useCallback(T=>{const j=T.getFullYear(),$=String(T.getMonth()+1).padStart(2,"0"),P=String(T.getDate()).padStart(2,"0");return`${j}-${$}-${P}`},[]),m=g.useCallback(()=>{const T=document.querySelectorAll("[data-date]");if(T.length===0)return null;const j=[];return T.forEach($=>{const P=$.getAttribute("data-date"),k=$.getAttribute("data-date-end");P&&j.push({date:P,dateEnd:k||void 0})}),j.length>0?j:null},[]),x=g.useCallback((T,j,$,P)=>{if(j.length===0)return null;if(P==="week"||P==="month"){const A=Math.round(T/$),H=Math.max(0,Math.min(j.length-1,A));return j[H].date}const k=new Date(j[0].date);k.setHours(0,0,0,0);let E;const I=j[j.length-1];P==="quarter"&&I.dateEnd?(E=new Date(I.dateEnd),E.setHours(23,59,59,999)):P==="year"?(E=new Date(I.date),E=new Date(E.getFullYear(),E.getMonth()+1,0,23,59,59,999)):(E=new Date(I.date),E.setHours(23,59,59,999));const M=E.getTime()-k.getTime(),B=j.length*$,C=T/B*M,R=new Date(k.getTime()+C);return y(R)},[y]),w=g.useCallback(T=>{if(!v.current)return;u.current=T.clientX;const j=v.current,$=T.clientX-j.startX;let P=j.originalLeft,k=j.originalWidth;j.element&&(j.edge==="left"?(P=j.originalLeft+$,k=j.originalWidth-$,k>=f&&(j.element.style.left=`${P}px`,j.element.style.width=`${k}px`)):(k=j.originalWidth+$,k>=f&&(j.element.style.width=`${k}px`)));const E=m();if(E&&E.length>0&&k>=f&&j.element){const I=j.edge==="left"?x(P,E,f,p):x(P+k,E,f,p);if(I){const M=j.edge==="left"?I:x(P,E,f,p)||j.originalStartDate,B=j.edge==="left"?x(P+k,E,f,p)||j.originalEndDate:I,C=new Date(M).getTime(),R=new Date(B).getTime(),A=Math.round((R-C)/864e5)+1,H=j.element.closest('[class*="row"]');if(H){const z=H.offsetTop,K=j.edge==="left"?P:P+k,Q=z-28;o(K,Q,I,A,j.edge)}}}},[f,p,o,m,x]),b=g.useCallback(async()=>{var B,C,R,A;if(l(),!v.current){i();return}const T=v.current;document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",b),document.body.style.cursor="",T.element&&T.element.classList.remove("resizing");const j=T.element?parseFloat(T.element.style.left)||0:T.originalLeft,$=T.element&&parseFloat(T.element.style.width)||T.originalWidth,P=Math.abs(j-T.originalLeft),k=Math.abs($-T.originalWidth);if(P<2&&k<2){T.element&&(T.element.style.left=`${T.originalLeft}px`,T.element.style.width=`${T.originalWidth}px`),v.current=null,i();return}const E=m();let I=T.originalStartDate,M=T.originalEndDate;if(E&&E.length>0)if(T.edge==="left"){const H=x(j,E,f,p);if(H&&(I=H,new Date(I)>=new Date(M))){const z=new Date(M);z.setDate(z.getDate()-1),I=y(z)}}else{const H=j+$,z=x(H,E,f,p);if(z&&(M=z,new Date(M)<=new Date(I))){const K=new Date(I);K.setDate(K.getDate()+1),M=y(K)}}else{const H=u.current-T.startX;let z;switch(p){case"week":case"month":z=1;break;case"quarter":z=7;break;case"year":z=30;break;default:z=1}const K=Math.round(H/f*z),Q=(Y,J)=>{const ne=new Date(Y);return ne.setDate(ne.getDate()+J),ne.toISOString().split("T")[0]};T.edge==="left"?(I=Q(T.originalStartDate,K),new Date(I)>=new Date(M)&&(I=Q(M,-1))):(M=Q(T.originalEndDate,K),new Date(M)<=new Date(I)&&(M=Q(I,1)))}try{_(c,"resize");const H=c.findIndex(Y=>Y.id===T.projectId);if(H===-1){console.error("Project not found:",T.projectId),v.current=null,i();return}const z=gg(c[H]);if(T.type==="phase"){const Y=(z.phases??[]).find(J=>J.id===T.id);Y&&(Y.start_date=I,Y.end_date=M)}else if(T.type==="subphase"){const Y=J=>{var ne;for(const O of J){if(O.id===T.id)return O.start_date=I,O.end_date=M,!0;if((ne=O.children)!=null&&ne.length&&Y(O.children))return!0}return!1};for(const J of z.phases??[])if((B=J.children)!=null&&B.length&&Y(J.children))break}else if(T.type==="staffAssignment"){const Y=(C=z.staffAssignments)==null?void 0:C.find(J=>J.id===T.id);Y&&(Y.start_date=I,Y.end_date=M)}else if(T.type==="equipmentAssignment"){const Y=(R=z.equipmentAssignments)==null?void 0:R.find(J=>J.id===T.id);Y&&(Y.start_date=I,Y.end_date=M)}let K=[];T.type==="phase"?K=mg(z,T.id,T.originalEndDate,M):T.type==="subphase"&&(K=pg(z,T.id,T.originalEndDate,M));const Q=c.map((Y,J)=>J===H?z:Y);if(d(Q),T.type==="phase")await ia(T.id,{start_date:I,end_date:M});else if(T.type==="subphase")await Ps(T.id,{start_date:I,end_date:M});else if(T.type==="staffAssignment"){const Y=(A=z.staffAssignments)==null?void 0:A.find(J=>J.id===T.id);await Qo(T.id,{start_date:I,end_date:M,allocation:(Y==null?void 0:Y.allocation)??100})}else T.type==="equipmentAssignment"&&await Yo(T.id,{start_date:I,end_date:M});K.length>0&&(console.log(`Cascading ${K.length} updates:`,K),await hg(K))}catch(H){console.error("Failed to resize item:",H);const z=await Ke();d(z)}v.current=null,i()},[f,p,i,w,_,d,c,l]),S=g.useCallback((T,j,$,P,k,E,I)=>{if(h==="equipment"||h==="staff")return;T.preventDefault(),T.stopPropagation();const M=I.getBoundingClientRect(),B=window.getComputedStyle(I);v.current={id:j,type:"phase",projectId:$,edge:P,startX:T.clientX,element:I,originalLeft:parseFloat(B.left)||0,originalWidth:M.width,originalStartDate:k,originalEndDate:E},u.current=T.clientX,I.classList.add("resizing"),document.body.style.cursor="ew-resize",r("phase",j,P),document.addEventListener("mousemove",w),document.addEventListener("mouseup",b)},[h,w,b,r]),N=g.useCallback((T,j,$,P,k,E,I)=>{if(h==="equipment"||h==="staff")return;T.preventDefault(),T.stopPropagation();const M=I.getBoundingClientRect(),B=window.getComputedStyle(I);v.current={id:j,type:"subphase",projectId:$,edge:P,startX:T.clientX,element:I,originalLeft:parseFloat(B.left)||0,originalWidth:M.width,originalStartDate:k,originalEndDate:E},u.current=T.clientX,I.classList.add("resizing"),document.body.style.cursor="ew-resize",r("subphase",j,P),document.addEventListener("mousemove",w),document.addEventListener("mouseup",b)},[h,w,b,r]),D=g.useCallback((T,j,$,P,k,E,I)=>{if(h==="equipment"||h==="staff")return;T.preventDefault(),T.stopPropagation();const M=I||T.currentTarget.closest("[data-assignment-id]");M&&(v.current={id:j,type:"staffAssignment",projectId:$,edge:P,startX:T.clientX,element:M,originalLeft:parseInt(M.style.left||"0")||0,originalWidth:parseInt(M.style.width||"0")||M.offsetWidth,originalStartDate:k,originalEndDate:E},u.current=T.clientX,M.classList.add("resizing"),document.body.style.cursor="ew-resize",r("staffAssignment",j,P),document.addEventListener("mousemove",w),document.addEventListener("mouseup",b))},[h,w,b,r]),L=g.useCallback((T,j,$,P,k,E,I)=>{if(h==="equipment"||h==="staff")return;T.preventDefault(),T.stopPropagation();const M=I||T.currentTarget.closest("[data-assignment-id]");M&&(v.current={id:j,type:"equipmentAssignment",projectId:$,edge:P,startX:T.clientX,element:M,originalLeft:parseInt(M.style.left||"0")||0,originalWidth:parseInt(M.style.width||"0")||M.offsetWidth,originalStartDate:k,originalEndDate:E},u.current=T.clientX,M.classList.add("resizing"),document.body.style.cursor="ew-resize",r("equipmentAssignment",j,P),document.addEventListener("mousemove",w),document.addEventListener("mouseup",b))},[h,w,b,r]);return g.useEffect(()=>()=>{document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",b),document.body.style.cursor=""},[w,b]),{isResizing:e,resizeEdge:t,resizeItemId:n,resizeItemType:s,startPhaseResize:S,startSubphaseResize:N,startStaffAssignmentResize:D,startEquipmentAssignmentResize:L}}function Jo(e,t){g.useEffect(()=>{const n=e.current,s=t.current;if(!n||!s)return;let r=!1;const i=()=>{r||(r=!0,s.scrollTop=n.scrollTop,requestAnimationFrame(()=>{r=!1}))},o=()=>{r||(r=!0,n.scrollTop=s.scrollTop,requestAnimationFrame(()=>{r=!1}))};return n.addEventListener("scroll",i,{passive:!0}),s.addEventListener("scroll",o,{passive:!0}),()=>{n.removeEventListener("scroll",i),s.removeEventListener("scroll",o)}},[e,t])}function J0(e,t,n){return g.useMemo(()=>n.map(s=>{const r=s.dateStr,i=t.find(h=>{const p=h.start_date.split("T")[0],_=h.end_date.split("T")[0];return r>=p&&r<=_}),o=!!i,l=e.filter(h=>{const p=h.start_date.split("T")[0],_=h.end_date.split("T")[0];return r>=p&&r<=_}),c=l.reduce((h,p)=>h+(p.allocation||0),0);let d,f;return o?(d=0,c>0?f="conflict":f="vacation"):c===0?(d=100,f="empty"):c>100?(d=100-c,f="overloaded"):c===100?(d=0,f="full"):(d=100-c,f="partial"),{total:c,assignments:l,isOnVacation:o,vacationDescription:i==null?void 0:i.description,available:d,state:f}}),[e,t,n])}function ew(e){if(e.isOnVacation){const n=e.vacationDescription||"Vacation";return e.total>0?`${n}
 Conflict: ${e.total}% assigned during vacation`:n}if(e.total===0)return"Available";let t=`${e.total}% allocated`;return e.assignments.length>1&&(t+=` (${e.assignments.length} assignments)`),e.total>100&&(t+=`
 Overloaded by ${e.total-100}%`),t}function tw(e){switch(e.state){case"vacation":return{background:"rgba(139, 92, 246, 0.25)"};case"conflict":return{background:"linear-gradient(135deg, rgba(139, 92, 246, 0.3), rgba(239, 68, 68, 0.3))"};case"overloaded":return{background:`linear-gradient(to top, rgba(239, 68, 68, ${.3+Math.min(100,e.total-100)/200}) ${Math.min(100,e.total)}%, transparent ${Math.min(100,e.total)}%)`};case"full":return{background:"rgba(59, 130, 246, 0.25)"};case"partial":return{background:`linear-gradient(to top, rgba(59, 130, 246, 0.2) ${e.total}%, transparent ${e.total}%)`};default:return{}}}function nw(e,t){return e==="end"&&t==="start"?"FS":e==="start"&&t==="start"?"SS":e==="end"&&t==="end"?"FF":e==="start"&&t==="end"?"SF":"FS"}function $i(e){const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${n}-${s}`}function sw(){const{isLinkingDependency:e,linkingFrom:t,startLinking:n,completeLinking:s,cancelLinking:r}=Z(),{projects:i,setProjects:o}=F(),l=g.useCallback(_=>{for(const v of i){const u=(v.phases??[]).find(y=>y.id===_);if(u)return{project:v,phase:u}}return null},[i]),c=g.useCallback(_=>{const v=u=>{var y;for(const m of u){if(m.id===_)return m;if((y=m.children)!=null&&y.length){const x=v(m.children);if(x)return x}}return null};for(const u of i)for(const y of u.phases??[]){const m=v(y.children??[]);if(m)return{project:u,subphase:m}}return null},[i]),d=g.useCallback((_,v,u,y)=>{const m=new Set,x=[v],w=i.find(b=>b.id===_);if(!w)return!1;for(;x.length>0;){const b=x.pop();if(b===u)return!0;if(m.has(b))continue;m.add(b);let S=[];if(y==="phase"){const N=(w.phases??[]).find(D=>D.id===b);N!=null&&N.dependencies&&(S=N.dependencies)}else{const N=D=>{var L;for(const T of D){if(T.id===b&&T.dependencies)return T.dependencies;if((L=T.children)!=null&&L.length){const j=N(T.children);if(j.length)return j}}return[]};for(const D of w.phases??[])if(S=N(D.children??[]),S.length)break}S.forEach(N=>x.push(N.id))}return!1},[i]),f=g.useCallback((_,v,u,y,m)=>{if(_.stopPropagation(),_.preventDefault(),e&&t){if(t.projectId!==v){alert("Dependencies can only be created between items in the same project"),r();return}if(t.itemId===u&&t.itemType===y){r();return}if(d(v,u,t.itemId,y)){alert("Cannot create circular dependency"),r();return}const x=nw(t.zone,m);h(v,t.itemId,t.itemType,u,y,x),s();return}n(v,u,y,m)},[e,t,n,s,r,d]),h=g.useCallback(async(_,v,u,y,m,x)=>{try{let w=null,b=null;if(u==="phase"){const $=l(v);$&&(w=$.phase)}else{const $=c(v);$&&(w=$.subphase)}if(m==="phase"){const $=l(y);$&&(b=$.phase)}else{const $=c(y);$&&(b=$.subphase)}if(!w||!b){console.error("Could not find source or target item");return}const S=b.dependencies??[];if(S.some($=>$.id===v&&$.type===x)){console.log("Dependency already exists");return}const N=[...S,{id:v,type:x}];let D=b.start_date,L=b.end_date;const T=(new Date(b.end_date).getTime()-new Date(b.start_date).getTime())/864e5;if(x==="FS"){const $=new Date(w.end_date),P=new Date($);P.setDate(P.getDate()+1);const k=new Date(P);k.setDate(k.getDate()+T),D=$i(P),L=$i(k)}else if(x==="SS"){const $=new Date(w.start_date),P=new Date($),k=new Date(P);k.setDate(k.getDate()+T),D=$i(P),L=$i(k)}const j=i.map($=>{if($.id!==_)return $;if(m==="phase")return{...$,phases:($.phases??[]).map(P=>P.id===y?{...P,dependencies:N,start_date:D,end_date:L}:P)};{const P=k=>k.map(E=>{var I;return E.id===y?{...E,dependencies:N,start_date:D,end_date:L}:(I=E.children)!=null&&I.length?{...E,children:P(E.children)}:E});return{...$,phases:($.phases??[]).map(k=>({...k,children:P(k.children??[])}))}}});o(j),m==="phase"?await ia(y,{start_date:D,end_date:L,dependencies:N}):await Ps(y,{start_date:D,end_date:L,dependencies:N})}catch(w){console.error("Failed to create dependency:",w);const b=await Ke();o(b)}},[i,o,l,c]),p=g.useCallback(()=>{e&&r()},[e,r]);return{isLinkingDependency:e,linkingFrom:t,handleLinkZoneClick:f,handleCancelLinking:p}}const aw="#ec4899",$l=["#06b6d4","#8b5cf6","#f59e0b","#10b981","#ef4444"];function rw(e){return $l[Math.min(e-1,$l.length-1)]||$l[0]}function iw(e,t){for(const n of e.phases||[]){const s=_g(n.children||[],t,1);if(s!==null)return s}return 1}function _g(e,t,n){for(const s of e){if(s.id===t)return n;if(s.children&&s.children.length>0){const r=_g(s.children,t,n+1);if(r!==null)return r}}return null}function No(e,t){for(const n of e){const s=eu(n.children||[],t);if(s)return s}return null}function eu(e,t){for(const n of e){if(n.id===t)return n;if(n.children&&n.children.length>0){const s=eu(n.children,t);if(s)return s}}return null}function ow(e,t){const n=No(e.phases||[],t);if(!n)return 0;const s=!!n.parent_subphase_id,r=s?n.parent_subphase_id:n.parent_phase_id;let i=[];if(s){const o=No(e.phases||[],r);i=(o==null?void 0:o.children)||[]}else{const o=(e.phases||[]).find(l=>l.id===r);i=(o==null?void 0:o.children)||[]}return i.findIndex(o=>o.id===t)}function Ei(e){return be(e,"yyyy-MM-dd")}function fr(e){const t=e.split("T")[0];return new Date(t+"T12:00:00")}function ii(){const e=F(h=>h.projects),t=Z(h=>h.phantomSiblingMode),n=Z(h=>h.startPhantomSibling),s=Z(h=>h.updatePhantomPosition),r=Z(h=>h.endPhantomSibling),i=g.useRef(!1);i.current=!!t;const o=g.useCallback(h=>{const{projectId:p,sourceId:_,type:v,zone:u}=h,y=e.find(P=>P.id===p);if(!y)return;let m,x,w,b=null,S;const N=u==="start"?"SS":"FS";if(v==="phase"){if(m=(y.phases||[]).find(k=>k.id===_),!m)return;w=(y.phases||[]).findIndex(k=>k.id===_),x=aw;const{expandedPhases:P}=F.getState();P.has(_)&&F.getState().togglePhaseExpanded(_)}else{if(m=No(y.phases||[],_)||void 0,!m)return;const P=m;w=ow(y,_),x=P.color||rw(iw(y,_)),P.parent_subphase_id?(b=P.parent_subphase_id,S="subphase"):(b=P.parent_phase_id,S="phase");const{expandedSubphases:k}=F.getState();k.has(_)&&F.getState().toggleSubphaseExpanded(_)}const D=fr(m.start_date),L=fr(m.end_date),T=Ns(L,D)+1;let j;N==="FS"?j=En(L,1):j=new Date(D);const $=En(j,T-1);n({projectId:p,sourceId:_,type:v,dependencyType:N,phantomStart:Ei(j),phantomEnd:Ei($),phantomColor:x,siblingDurationDays:T,sourceIndex:w,parentId:b,parentType:S}),document.body.classList.add("phantom-sibling-mode")},[e,n]),l=g.useCallback((h,p,_,v,u)=>{if(!t)return;const{siblingDurationDays:y}=t,m=h-p.left+_;if(v.length===0)return;const x=new Date(v[0].date);x.setHours(0,0,0,0);const w=v[v.length-1],b=new Date(w.date);b.setHours(23,59,59,999);const S=v.length*u,D=(b.getTime()-x.getTime())/S,L=(y-1)*24*60*60*1e3,T=L/D/2,j=m-T,$=Math.max(0,Math.min(j,S-L/D)),P=x.getTime()+$*D,k=new Date(P);k.setHours(0,0,0,0);const E=En(k,y-1);s(Ei(k),Ei(E))},[t,s]),c=g.useCallback(()=>{document.body.classList.remove("phantom-sibling-mode"),r()},[r]),d=g.useCallback(()=>{if(!t)return;const{projectId:h,sourceId:p,type:_,phantomStart:v,phantomEnd:u,dependencyType:y,parentId:m,parentType:x}=t,w={startDate:v,endDate:u,predecessorId:p,dependencyType:y,parentId:m,parentType:x};c(),setTimeout(()=>{if(_==="phase")Z.setState({activeModal:"phase",editingPhase:null,modalContext:{projectId:h,phantomPreset:w}});else{const b=e.find(D=>D.id===h);let S,N;if(x==="phase")S=m??void 0,N=void 0;else if(x==="subphase"&&m&&b){N=m;for(const D of b.phases||[])if(eu(D.children||[],m)){S=D.id;break}}Z.setState({activeModal:"subphase",editingSubphase:null,modalContext:{phaseId:S,projectId:h,subphaseId:N,phantomPreset:w}})}},50)},[t,c,e]);g.useEffect(()=>{const h=p=>{p.key==="Escape"&&i.current&&c()};return document.addEventListener("keydown",h),()=>document.removeEventListener("keydown",h)},[c]);const f=g.useCallback(()=>{if(!t)return{lagDays:0,dependencyType:"FS"};const{phantomStart:h,dependencyType:p,sourceId:_,type:v}=t,u=e.find(S=>S.id===t.projectId);if(!u)return{lagDays:0,dependencyType:p};let y;if(v==="phase"?y=(u.phases||[]).find(S=>S.id===_):y=No(u.phases||[],_)||void 0,!y)return{lagDays:0,dependencyType:p};const m=fr(h),x=fr(y.start_date),w=fr(y.end_date);let b;if(p==="SS")b=Ns(m,x);else{const S=En(w,1);b=Ns(m,S)}return{lagDays:b,dependencyType:p}},[t,e]);return{phantomSiblingMode:t,isPhantomMode:!!t,startPhantom:o,updatePhantom:l,completePhantom:d,cancelPhantom:c,calculateLag:f}}const Hf=12,qf=120,El=4;function lw({containerRef:e,cellWidth:t}){const n=F(i=>i.setCellWidth),s=g.useRef(!1),r=g.useCallback(i=>{if(!i.ctrlKey)return;i.preventDefault();const o=e.current;if(!o||s.current)return;s.current=!0;const c=i.deltaY<0?Math.min(t+El,qf):Math.max(t-El,Hf);if(c===t){s.current=!1;return}const d=o.getBoundingClientRect(),h=(i.clientX-d.left+o.scrollLeft)/t;n(c),requestAnimationFrame(()=>{const p=h*c-(i.clientX-d.left);o.scrollLeft=Math.max(0,p),s.current=!1})},[t,e,n]);return g.useEffect(()=>{const i=e.current;if(i)return i.addEventListener("wheel",r,{passive:!1}),()=>{i.removeEventListener("wheel",r)}},[r,e]),{minCellWidth:Hf,maxCellWidth:qf,zoomStep:El}}const cw=12,dw=120,zf=4;function uw(){const e=Z(h=>h.triggerScrollToToday),t=Z(h=>h.triggerZoom),n=Z(h=>h.endPhantomSibling),s=Z(h=>h.phantomSiblingMode),r=Z(h=>h.cancelLinking),i=Z(h=>h.isLinkingDependency),o=Z(h=>h.closeModal),l=Z(h=>h.activeModal),c=F(h=>h.cellWidth),d=F(h=>h.setCellWidth),f=g.useCallback(h=>{const p=h.target;if(!(p.tagName==="INPUT"||p.tagName==="TEXTAREA"||p.isContentEditable)){if(h.key==="Escape"){if(l){o(),h.preventDefault();return}if(i){r(),h.preventDefault();return}if(s){document.body.classList.remove("phantom-sibling-mode"),n(),h.preventDefault();return}}if(h.key==="Home"&&!h.ctrlKey&&!h.shiftKey&&!h.altKey){e(),h.preventDefault();return}if((h.key==="+"||h.key==="=")&&!h.ctrlKey){const _=Math.min(c+zf,dw);_!==c&&(t(1,_),d(_)),h.preventDefault();return}if(h.key==="-"&&!h.ctrlKey){const _=Math.max(c-zf,cw);_!==c&&(t(-1,_),d(_)),h.preventDefault();return}}},[l,o,i,r,s,n,e,t,c,d]);g.useEffect(()=>(document.addEventListener("keydown",f),()=>document.removeEventListener("keydown",f)),[f])}const fw="_container_ft4rj_1",hw="_wrapper_ft4rj_7",mw="_icon_ft4rj_13",pw="_select_ft4rj_20",gw="_chevron_ft4rj_48",_w="_singleSite_ft4rj_55",Is={container:fw,wrapper:hw,icon:mw,select:pw,chevron:gw,singleSite:_w};function yw(){const e=F(l=>l.sites),t=F(l=>l.currentSite),n=F(l=>l.setCurrentSite),s=F(l=>l.setBankHolidays),r=F(l=>l.currentUser),i=(r==null?void 0:r.role)==="admin"?e:e.filter(l=>{var c;return(c=r==null?void 0:r.site_ids)==null?void 0:c.includes(l.id)}),o=async l=>{const c=parseInt(l.target.value,10),d=e.find(f=>f.id===c);if(d){n(d);try{const f=await ks(d.id),h=$n(f);s(f,h)}catch(f){console.error("[SiteSelector] Failed to load bank holidays:",f)}}};return i.length<=1?t?a.jsx("div",{className:Is.container,children:a.jsxs("div",{className:Is.singleSite,children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),a.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),a.jsx("span",{children:t.name})]})}):null:a.jsx("div",{className:Is.container,children:a.jsxs("div",{className:Is.wrapper,children:[a.jsxs("svg",{className:Is.icon,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),a.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),a.jsx("select",{className:Is.select,value:(t==null?void 0:t.id)||"",onChange:o,children:i.map(l=>a.jsx("option",{value:l.id,children:l.name},l.id))}),a.jsx("svg",{className:Is.chevron,width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]})})}const vw="_wrapper_1qwm4_1",xw="_button_1qwm4_9",ww="_active_1qwm4_31",Tl={wrapper:vw,button:xw,active:ww},jw=[{value:"week",label:"W"},{value:"month",label:"M"},{value:"quarter",label:"Q"},{value:"year",label:"Y"}];function Sw(){const e=F(n=>n.viewMode),t=F(n=>n.setViewMode);return a.jsx("div",{className:Tl.wrapper,children:jw.map(n=>a.jsx("button",{className:`${Tl.button} ${e===n.value?Tl.active:""}`,onClick:()=>t(n.value),title:`${n.value.charAt(0).toUpperCase()+n.value.slice(1)} view`,children:n.label},n.value))})}const kw="_container_at63v_1",Nw="_button_at63v_10",bw="_zoomLevel_at63v_34",Ti={container:kw,button:Nw,zoomLevel:bw},Wf=12,Uf=120,Vf=4,hr=36;function Cw(){const e=F(d=>d.cellWidth),t=F(d=>d.setCellWidth),n=Z(d=>d.triggerZoom),s=Math.round(e/hr*100),r=()=>{const d=Math.min(e+Vf,Uf);d!==e&&(n(1,d),t(d))},i=()=>{const d=Math.max(e-Vf,Wf);d!==e&&(n(-1,d),t(d))},o=()=>{if(e!==hr){const d=e>hr?-1:1;n(d,hr),t(hr)}},l=e<Uf,c=e>Wf;return a.jsxs("div",{className:Ti.container,children:[a.jsx("button",{className:Ti.button,onClick:i,disabled:!c,title:"Zoom out (-)",children:a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:a.jsx("path",{d:"M19 13H5v-2h14v2z"})})}),a.jsxs("button",{className:Ti.zoomLevel,onClick:o,title:"Click to reset zoom (100%)",children:[s,"%"]}),a.jsx("button",{className:Ti.button,onClick:r,disabled:!l,title:"Zoom in (+)",children:a.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:a.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})})})]})}const Dw="_wrapper_8vp7s_1",$w="_navigation_8vp7s_7",Ew="_navButton_8vp7s_17",Tw="_periodLabel_8vp7s_40",Pw="_todayButton_8vp7s_48",ua={wrapper:Dw,navigation:$w,navButton:Ew,periodLabel:Tw,todayButton:Pw};function Mw(){const e=F(l=>l.viewMode),t=F(l=>l.currentDate),n=F(l=>l.setCurrentDate),s=Z(l=>l.triggerScrollToToday),r=l=>{let c;switch(e){case"week":c=Kd(t,l);break;case"month":c=Tn(t,l);break;case"quarter":c=Tn(t,l*3);break;case"year":c=Tn(t,l*12);break;default:c=Tn(t,l)}n(c)},i=()=>{n(new Date),s()},o=()=>{switch(e){case"week":{const l=Ds(t,{weekStartsOn:1});return be(l,"MMM d, yyyy")}case"month":return be(t,"MMMM yyyy");case"quarter":{const l=ng(t);return`Q${Math.floor(l.getMonth()/3)+1} ${be(l,"yyyy")}`}case"year":return be(t,"yyyy");default:return be(t,"MMMM yyyy")}};return a.jsxs("div",{className:ua.wrapper,children:[a.jsxs("div",{className:ua.navigation,children:[a.jsx("button",{className:ua.navButton,onClick:()=>r(-1),title:"Previous period",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsx("span",{className:ua.periodLabel,children:o()}),a.jsx("button",{className:ua.navButton,onClick:()=>r(1),title:"Next period",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),a.jsx("button",{className:ua.todayButton,onClick:i,title:"Go to today",children:"Today"})]})}const Iw="_wrapper_vcvut_1",Lw="_trigger_vcvut_5",Aw="_avatar_vcvut_26",Rw="_chevron_vcvut_39",Bw="_open_vcvut_44",Fw="_menu_vcvut_48",Ow="_userInfo_vcvut_61",Hw="_name_vcvut_68",qw="_email_vcvut_74",zw="_role_vcvut_79",Ww="_divider_vcvut_85",Uw="_menuItem_vcvut_90",Gt={wrapper:Iw,trigger:Lw,avatar:Aw,chevron:Rw,open:Bw,menu:Fw,userInfo:Ow,name:Hw,email:qw,role:zw,divider:Ww,menuItem:Uw};function Vw(){var l,c;const[e,t]=g.useState(!1),n=g.useRef(null),s=F(d=>d.currentUser),r=F(d=>d.setCurrentUser);g.useEffect(()=>{const d=f=>{n.current&&!n.current.contains(f.target)&&t(!1)};return e&&document.addEventListener("mousedown",d),()=>{document.removeEventListener("mousedown",d)}},[e]);const i=async()=>{try{await Op(),r(null),window.location.reload()}catch(d){console.error("Logout failed:",d)}};if(!s)return null;const o=`${((l=s.first_name)==null?void 0:l[0])||""}${((c=s.last_name)==null?void 0:c[0])||""}`.toUpperCase()||"?";return a.jsxs("div",{ref:n,className:Gt.wrapper,children:[a.jsxs("button",{className:Gt.trigger,onClick:()=>t(!e),"aria-expanded":e,"aria-haspopup":"true",children:[a.jsx("span",{className:Gt.avatar,children:o}),a.jsx("svg",{className:`${Gt.chevron} ${e?Gt.open:""}`,width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),e&&a.jsxs("div",{className:Gt.menu,children:[a.jsxs("div",{className:Gt.userInfo,children:[a.jsx("span",{className:Gt.name,children:s.name}),a.jsx("span",{className:Gt.email,children:s.email}),a.jsx("span",{className:Gt.role,children:s.role})]}),a.jsx("div",{className:Gt.divider}),a.jsxs("button",{className:Gt.menuItem,onClick:i,children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),a.jsx("polyline",{points:"16 17 21 12 16 7"}),a.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),a.jsx("span",{children:"Log out"})]})]})]})}const Gw="_button_1jsgw_1",Qw={button:Gw};function Yw(){const[e,t]=g.useState(()=>oa());g.useEffect(()=>{const s=new MutationObserver(()=>{const r=document.documentElement.dataset.theme;r&&r!==e&&t(r)});return s.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>s.disconnect()},[e]);const n=()=>{const s=Gv();t(s)};return a.jsx("button",{className:Qw.button,onClick:n,title:`Switch to ${e==="dark"?"light":"dark"} theme`,"aria-label":`Switch to ${e==="dark"?"light":"dark"} theme`,children:e==="dark"?a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"5"}),a.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),a.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),a.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),a.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),a.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),a.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),a.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),a.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}):a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})})}const Xw="_button_n3mic_1",Kw="_label_n3mic_28",Zw="_activeContainer_n3mic_33",Jw="_indicator_n3mic_53",ej="_pendingBadge_n3mic_63",tj="_discardButton_n3mic_77",nj="_applyButton_n3mic_78",Ls={button:Xw,label:Kw,activeContainer:Zw,indicator:Jw,pendingBadge:ej,discardButton:tj,applyButton:nj};function sj(){const e=F(f=>f.whatIfMode),t=F(f=>f.whatIfPendingOperations),n=F(f=>f.enterWhatIfMode),s=F(f=>f.exitWhatIfMode),[r,i]=g.useState(!1),o=t.length,l=()=>{n()},c=()=>{window.confirm(o>0?`Discard ${o} pending change${o!==1?"s":""}? This cannot be undone.`:"Exit What If mode?")&&s(!1)},d=async()=>{if(o===0){s(!1);return}if(window.confirm(`Apply ${o} change${o!==1?"s":""} to the database?`)){i(!0);try{await s(!0)}finally{i(!1)}}};return e?a.jsxs("div",{className:Ls.activeContainer,children:[a.jsxs("div",{className:Ls.indicator,children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),a.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),a.jsx("span",{children:"What If"}),o>0&&a.jsx("span",{className:Ls.pendingBadge,children:o})]}),a.jsx("button",{className:Ls.discardButton,onClick:c,disabled:r,title:"Discard all changes",children:"Discard"}),a.jsx("button",{className:Ls.applyButton,onClick:d,disabled:r,title:o>0?`Apply ${o} change${o!==1?"s":""}`:"Exit What If mode",children:r?"Applying...":o>0?"Apply":"Exit"})]}):a.jsxs("button",{className:Ls.button,onClick:l,title:"Enter What If mode to test changes without saving",children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),a.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),a.jsx("span",{className:Ls.label,children:"What If"})]})}const aj="_container_155df_1",rj="_separator_155df_7",ij="_title_155df_14",Pl={container:aj,separator:rj,title:ij};function oj(){const e=F(n=>n.instanceSettings),t=(e==null?void 0:e.instance_title)||(e==null?void 0:e.instance_name);return!t||t==="Milestone"?null:a.jsxs("div",{className:Pl.container,children:[a.jsx("span",{className:Pl.separator,children:"|"}),a.jsx("span",{className:Pl.title,children:t})]})}const lj="_header_1l3ba_1",cj="_whatIfActive_1l3ba_13",dj="_left_1l3ba_18",uj="_logo_1l3ba_24",fj="_logoImg_1l3ba_29",hj="_center_1l3ba_40",mj="_right_1l3ba_47",As={header:lj,whatIfActive:cj,left:dj,logo:uj,logoImg:fj,center:hj,right:mj};function pj(){const e=F(o=>o.currentUser),t=F(o=>o.whatIfMode),[n,s]=g.useState(()=>oa());g.useEffect(()=>{const o=new MutationObserver(()=>{const l=document.documentElement.dataset.theme;l&&l!==n&&s(l)});return o.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>o.disconnect()},[n]);const r=(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="superuser",i=n==="dark"?"/img/milestone_logo_dark_theme.svg":"/img/milestone_logo_light_theme.svg";return a.jsxs("header",{className:`${As.header} ${t?As.whatIfActive:""}`,children:[a.jsxs("div",{className:As.left,children:[a.jsx("div",{className:As.logo,children:a.jsx("img",{src:i,alt:"Milestone",className:As.logoImg})}),a.jsx(oj,{})]}),a.jsxs("div",{className:As.center,children:[a.jsx(Mw,{}),r&&a.jsx(sj,{})]}),a.jsxs("div",{className:As.right,children:[a.jsx(yw,{}),a.jsx(Sw,{}),a.jsx(Cw,{}),a.jsx(Yw,{}),a.jsx(Vw,{})]})]})}const gj="_nav_7yrvb_1",_j="_collapsed_7yrvb_7",yj="_navItem_7yrvb_7",vj="_active_7yrvb_34",xj="_icon_7yrvb_44",wj="_label_7yrvb_53",fa={nav:gj,collapsed:_j,navItem:yj,active:vj,icon:xj,label:wj},jj=[{view:"gantt",label:"Gantt Chart",icon:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"4",y1:"9",x2:"20",y2:"9"}),a.jsx("line",{x1:"4",y1:"15",x2:"12",y2:"15"}),a.jsx("line",{x1:"4",y1:"21",x2:"16",y2:"21"}),a.jsx("rect",{x:"4",y:"3",width:"16",height:"2",rx:"1"})]})},{view:"staff",label:"Staff Overview",icon:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]})},{view:"equipment",label:"Equipment",icon:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})},{view:"crosssite",label:"Cross-Site",icon:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"2",y1:"12",x2:"22",y2:"12"}),a.jsx("path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})]})},{view:"archived",label:"Archived",icon:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"21 8 21 21 3 21 3 8"}),a.jsx("rect",{x:"1",y:"3",width:"22",height:"5"}),a.jsx("line",{x1:"10",y1:"12",x2:"14",y2:"12"})]})}];function Sj({collapsed:e=!1}){const t=F(s=>s.currentView),n=F(s=>s.setCurrentView);return a.jsx("nav",{className:`${fa.nav} ${e?fa.collapsed:""}`,children:jj.map(s=>a.jsxs("button",{className:`${fa.navItem} ${t===s.view?fa.active:""}`,onClick:()=>n(s.view),title:e?s.label:void 0,children:[a.jsx("span",{className:fa.icon,children:s.icon}),!e&&a.jsx("span",{className:fa.label,children:s.label})]},s.view))})}const kj="_section_18spk_1",Nj="_collapsed_18spk_7",bj="_item_18spk_7",Cj="_icon_18spk_39",Dj="_label_18spk_48",mr={section:kj,collapsed:Nj,item:bj,icon:Cj,label:Dj},$j=[{id:"users",label:"Manage Users",modal:"userManagement",icon:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("line",{x1:"19",y1:"8",x2:"19",y2:"14"}),a.jsx("line",{x1:"22",y1:"11",x2:"16",y2:"11"})]})},{id:"equipment",label:"Manage Equipment",modal:"manageEquipment",icon:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"2",y:"7",width:"20",height:"14",rx:"2",ry:"2"}),a.jsx("path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"})]})},{id:"sites",label:"Manage Sites",modal:"manageSites",icon:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),a.jsx("circle",{cx:"12",cy:"10",r:"3"})]})},{id:"phases",label:"Predefined Phases",modal:"predefinedPhases",icon:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),a.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),a.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),a.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),a.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),a.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]})},{id:"sso",label:"SSO Configuration",modal:"ssoConfig",adminOnly:!0,icon:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})},{id:"settings",label:"Settings",modal:"settings",icon:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"})]})}];function Ej({collapsed:e=!1}){const t=Z(o=>o.setActiveModal),n=F(o=>o.currentUser),s=(n==null?void 0:n.role)==="admin",r=o=>{t(o)},i=$j.filter(o=>!o.adminOnly||s);return a.jsx("div",{className:`${mr.section} ${e?mr.collapsed:""}`,children:i.map(o=>a.jsxs("button",{className:mr.item,onClick:()=>r(o.modal),title:e?o.label:void 0,children:[a.jsx("span",{className:mr.icon,children:o.icon}),!e&&a.jsx("span",{className:mr.label,children:o.label})]},o.id))})}const Tj="_stats_sfjfp_1",Pj="_stat_sfjfp_1",Mj="_value_sfjfp_14",Ij="_label_sfjfp_21",Lj="_detail_sfjfp_26",on={stats:Tj,stat:Pj,value:Mj,label:Ij,detail:Lj};function Aj(){const e=F(d=>d.projects),t=F(d=>d.staff),n=F(d=>d.equipment),s=F(d=>d.currentSite),r=s?e.filter(d=>d.site_id===s.id&&!d.archived):e.filter(d=>!d.archived),i=s?t.filter(d=>d.site_id===s.id&&d.active):t.filter(d=>d.active),o=s?n.filter(d=>d.site_id===s.id&&d.active):n.filter(d=>d.active),l=r.filter(d=>d.confirmed).length,c=r.filter(d=>!d.confirmed).length;return a.jsxs("div",{className:on.stats,children:[a.jsxs("div",{className:on.stat,children:[a.jsx("span",{className:on.value,children:r.length}),a.jsx("span",{className:on.label,children:"Projects"}),a.jsxs("span",{className:on.detail,children:[l," confirmed, ",c," pending"]})]}),a.jsxs("div",{className:on.stat,children:[a.jsx("span",{className:on.value,children:i.length}),a.jsx("span",{className:on.label,children:"Staff"})]}),a.jsxs("div",{className:on.stat,children:[a.jsx("span",{className:on.value,children:o.length}),a.jsx("span",{className:on.label,children:"Equipment"})]})]})}const Rj="_sidebar_vk433_1",Bj="_collapsed_vk433_14",Fj="_collapseBtn_vk433_18",Oj="_content_vk433_51",Hj="_section_vk433_64",qj="_sectionTitle_vk433_70",xn={sidebar:Rj,collapsed:Bj,collapseBtn:Fj,content:Oj,section:Hj,sectionTitle:qj};function zj(){const e=F(i=>i.sidebarCollapsed),t=F(i=>i.setSidebarCollapsed),n=F(i=>i.currentUser),s=(n==null?void 0:n.role)==="admin"||(n==null?void 0:n.role)==="superuser",r=()=>{t(!e)};return a.jsxs("aside",{className:`${xn.sidebar} ${e?xn.collapsed:""}`,children:[a.jsx("button",{className:xn.collapseBtn,onClick:r,title:e?"Expand sidebar":"Collapse sidebar","aria-label":e?"Expand sidebar":"Collapse sidebar",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}),a.jsxs("div",{className:xn.content,children:[a.jsxs("div",{className:xn.section,children:[!e&&a.jsx("div",{className:xn.sectionTitle,children:"Views"}),a.jsx(Sj,{collapsed:e})]}),s&&a.jsxs("div",{className:xn.section,children:[!e&&a.jsx("div",{className:xn.sectionTitle,children:"Admin"}),a.jsx(Ej,{collapsed:e})]}),!e&&a.jsxs("div",{className:xn.section,children:[a.jsx("div",{className:xn.sectionTitle,children:"Quick Stats"}),a.jsx(Aj,{})]})]})]})}const Wj="_tabs_147ep_1",Uj="_tab_147ep_1",Vj="_active_147ep_25",Ml={tabs:Wj,tab:Uj,active:Vj},Gj=[{value:"staff",label:"Staff"},{value:"equipment",label:"Equipment"}];function Qj(){const e=F(n=>n.currentResourceTab),t=F(n=>n.setCurrentResourceTab);return a.jsx("div",{className:Ml.tabs,children:Gj.map(n=>a.jsx("button",{className:`${Ml.tab} ${e===n.value?Ml.active:""}`,onClick:()=>t(n.value),children:n.label},n.value))})}const Yj="_card_1hr7e_1",Xj="_info_1hr7e_18",Kj="_name_1hr7e_25",Zj="_detail_1hr7e_34",Jj="_availability_1hr7e_42",e2="_bar_1hr7e_49",t2="_fill_1hr7e_57",n2="_percent_1hr7e_63",Kn={card:Yj,info:Xj,name:Kj,detail:Zj,availability:Jj,bar:e2,fill:t2,percent:n2};function Ws(e,t,n){const s=new Date(e),r=new Date(t);return s.setHours(0,0,0,0),r.setHours(23,59,59,999),s<=n&&r>=n}function s2(e,t,n){const s=new Date;if(s.setHours(12,0,0,0),n.some(o=>o.staff_id!==t?!1:Ws(o.start_date,o.end_date,s)))return 100;let i=0;for(const o of e){for(const l of o.staffAssignments||[])l.staff_id===t&&Ws(l.start_date,l.end_date,s)&&(i+=l.allocation||0);for(const l of o.phases||[]){for(const d of l.staffAssignments||[])d.staff_id===t&&Ws(l.start_date,l.end_date,s)&&(i+=d.allocation||0);const c=d=>{for(const f of d||[]){for(const h of f.staffAssignments||[])h.staff_id===t&&Ws(f.start_date,f.end_date,s)&&(i+=h.allocation||0);f.children&&c(f.children)}};c(l.children)}}return i}function a2(e,t){const n=new Date;n.setHours(12,0,0,0);for(const s of e){for(const r of s.equipmentAssignments||[])if(r.equipment_id===t&&Ws(r.start_date,r.end_date,n))return!0;for(const r of s.phases||[]){for(const o of r.equipmentAssignments||[])if(o.equipment_id===t&&Ws(r.start_date,r.end_date,n))return!0;const i=o=>{for(const l of o||[]){for(const c of l.equipmentAssignments||[])if(c.equipment_id===t&&Ws(l.start_date,l.end_date,n))return!0;if(l.children&&i(l.children))return!0}return!1};if(i(r.children))return!0}}return!1}function r2({resource:e,type:t,projects:n}){const s=F(f=>f.vacations),i=100-(t==="staff"?s2(n,e.id,s):a2(n,e.id)?100:0),o=t==="staff",l=e,c=e,d=f=>f<=0?"var(--accent-red)":f<30?"var(--accent-orange)":f<60?"var(--accent-yellow)":"var(--accent-green)";return a.jsxs("div",{className:Kn.card,children:[a.jsxs("div",{className:Kn.info,children:[a.jsx("span",{className:Kn.name,children:e.name}),a.jsx("span",{className:Kn.detail,children:o?l.role||"No role":c.type||"No type"})]}),a.jsxs("div",{className:Kn.availability,children:[a.jsx("div",{className:Kn.bar,children:a.jsx("div",{className:Kn.fill,style:{width:`${Math.max(0,Math.min(100,i))}%`,backgroundColor:d(i)}})}),a.jsxs("span",{className:Kn.percent,style:{color:d(i)},children:[i,"%"]})]})]})}const i2="_list_qoxnj_1",o2="_empty_qoxnj_27",Gf={list:i2,empty:o2};function l2(){const e=F(c=>c.currentResourceTab),t=F(c=>c.staff),n=F(c=>c.equipment),s=F(c=>c.currentSite),r=F(c=>c.projects),i=s?t.filter(c=>c.site_id===s.id&&c.active):t.filter(c=>c.active),o=s?n.filter(c=>c.site_id===s.id&&c.active):n.filter(c=>c.active),l=e==="staff"?i:o;return l.length===0?a.jsx("div",{className:Gf.empty,children:a.jsxs("p",{children:["No ",e," found"]})}):a.jsx("div",{className:Gf.list,children:l.map(c=>a.jsx(r2,{resource:c,type:e,projects:r},c.id))})}const c2="_panel_10ury_1",d2="_collapsed_10ury_14",u2="_collapseBtn_10ury_19",f2="_content_10ury_52",h2="_header_10ury_63",m2="_title_10ury_71",ha={panel:c2,collapsed:d2,collapseBtn:u2,content:f2,header:h2,title:m2};function p2(){const e=F(s=>s.resourcePanelCollapsed),t=F(s=>s.setResourcePanelCollapsed),n=()=>{t(!e)};return a.jsxs("aside",{className:`${ha.panel} ${e?ha.collapsed:""}`,children:[a.jsx("button",{className:ha.collapseBtn,onClick:n,title:e?"Expand panel":"Collapse panel","aria-label":e?"Expand panel":"Collapse panel",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})}),a.jsxs("div",{className:ha.content,children:[a.jsx("div",{className:ha.header,children:a.jsx("h2",{className:ha.title,children:"Resources"})}),a.jsx(Qj,{}),a.jsx(l2,{})]})]})}const yg=g.createContext(null);function g2({children:e}){const[t,n]=g.useState(null),[s,r]=g.useState(null),i=g.useRef(null),o=F(u=>u.setProjects),l=g.useCallback(()=>{n(null),r(null),i.current&&i.current.parentNode&&(i.current.parentNode.removeChild(i.current),i.current=null)},[]),c=g.useCallback((u,y,m,x,w,b)=>{u.stopPropagation(),u.dataTransfer.effectAllowed="move",u.dataTransfer.setData("text/plain",JSON.stringify({type:y,id:m}));const S=u.currentTarget,N=S.getBoundingClientRect(),D=S.cloneNode(!0);D.style.cssText=`
      position: absolute;
      top: -1000px;
      left: -1000px;
      width: ${N.width}px;
      opacity: 0.9;
      background: var(--bg-tertiary);
      border-radius: 4px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.4);
      pointer-events: none;
    `,document.body.appendChild(D),i.current=D,u.dataTransfer.setDragImage(D,20,N.height/2),n({type:y,id:m,projectId:x,parentId:w,parentType:b}),requestAnimationFrame(()=>{S.style.opacity="0.4"})},[]),d=g.useCallback((u,y,m)=>{if(!t||t.type!==y||t.id===m)return;u.preventDefault(),u.stopPropagation(),u.dataTransfer.dropEffect="move";const w=u.currentTarget.getBoundingClientRect(),b=w.top+w.height/2,S=u.clientY<b?"before":"after";r({type:y,id:m,position:S})},[t]),f=g.useCallback(u=>{u.preventDefault();const y=u.relatedTarget;u.currentTarget.contains(y)||r(null)},[]),h=g.useCallback(async(u,y,m,x,w,b)=>{if(u.preventDefault(),u.stopPropagation(),!t||!s||t.id===m){l();return}const S=x.map(L=>L.id),N=S.indexOf(t.id);let D=S.indexOf(m);if(N===-1||D===-1){l();return}S.splice(N,1),D=S.indexOf(m),s.position==="after"&&(D+=1),S.splice(D,0,t.id);try{y==="phase"?await Xe(`/api/projects/${t.projectId}/phases/reorder`,{phase_order:S}):await Xe(`/api/subphases/${w}/reorder`,{parent_type:b,subphase_order:S});const L=await Ke();o(L)}catch(L){console.error("Failed to reorder:",L)}l()},[t,s,l,o]),p=g.useCallback(u=>{u.preventDefault();const y=u.currentTarget;y.style.opacity="",l()},[l]),_=g.useCallback((u,y)=>(t==null?void 0:t.type)===u&&(t==null?void 0:t.id)===y,[t]),v=g.useCallback((u,y)=>(s==null?void 0:s.type)===u&&(s==null?void 0:s.id)===y?s.position:null,[s]);return a.jsx(yg.Provider,{value:{dragState:t,dropTarget:s,handleDragStart:c,handleDragOver:d,handleDragLeave:f,handleDrop:h,handleDragEnd:p,isDragging:_,getDropPosition:v},children:e})}function vg(){const e=g.useContext(yg);if(!e)throw new Error("useReorder must be used within ReorderProvider");return e}const _2="_row_11tp0_1",y2="_typeBadge_11tp0_12",v2="_staff_11tp0_25",x2="_equipment_11tp0_30",w2="_icon_11tp0_35",j2="_name_11tp0_43",S2="_detail_11tp0_52",k2="_allocation_11tp0_56",wn={row:_2,typeBadge:y2,staff:v2,equipment:x2,icon:w2,name:j2,detail:S2,allocation:k2},Ya=g.memo(function({type:t,name:n,role:s,equipmentType:r,allocation:i,depth:o,phaseType:l,phaseColor:c}){const d=o*16+28;return t==="phase-staff"?a.jsxs("div",{className:wn.row,style:{paddingLeft:d},children:[a.jsxs("span",{className:wn.typeBadge,style:{backgroundColor:c?`${c}33`:"rgba(139, 92, 246, 0.2)",color:c||"var(--accent-purple)"},children:[" ",l||"Phase"]}),a.jsx("span",{className:wn.name,title:n,children:n}),i!==void 0&&a.jsxs("span",{className:wn.allocation,children:[i,"%"]})]}):a.jsxs("div",{className:wn.row,style:{paddingLeft:d},children:[a.jsx("span",{className:`${wn.typeBadge} ${wn[t]}`,children:t==="staff"?"STAFF":"EQUIP"}),a.jsxs("span",{className:wn.name,title:`${n}${s?` - ${s}`:""}${r?` - ${r}`:""}`,children:[n,(s||r)&&a.jsxs("span",{className:wn.detail,children:["  ",s||r]})]}),t==="staff"&&i!==void 0&&a.jsxs("span",{className:wn.allocation,children:[i,"%"]})]})}),N2="_phantomRow_uvscd_3",b2="_typeBadge_uvscd_19",C2="_instructions_uvscd_28",D2="_cancelBtn_uvscd_37",pr={phantomRow:N2,typeBadge:b2,instructions:C2,cancelBtn:D2};function tu({onComplete:e,onCancel:t}){const n=Z(l=>l.phantomSiblingMode);if(!n)return null;const{type:s,phantomColor:r,dependencyType:i}=n,o=i==="SS"?"Start-to-Start":"Finish-to-Start";return a.jsxs("div",{className:pr.phantomRow,onClick:l=>{l.target.closest(`.${pr.cancelBtn}`)||(l.stopPropagation(),e())},children:[a.jsxs("span",{className:pr.typeBadge,style:{backgroundColor:`${r}40`,color:r},children:["New ",s==="phase"?"Phase":"Subphase"]}),a.jsxs("span",{className:pr.instructions,children:["Move & click to place... (",o,")"]}),a.jsx("button",{className:pr.cancelBtn,onClick:l=>{l.stopPropagation(),t()},title:"Cancel (Esc)",children:a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})}const $2="_popover_1m2ej_3",E2="_header_1m2ej_14",T2="_title_1m2ej_21",P2="_calculatedNote_1m2ej_27",M2="_sliderContainer_1m2ej_33",I2="_valueDisplay_1m2ej_40",L2="_sliderWrapper_1m2ej_50",A2="_sliderTrack_1m2ej_58",R2="_sliderInput_1m2ej_69",B2="_tickMarks_1m2ej_122",F2="_tick_1m2ej_122",O2="_quickSelect_1m2ej_134",H2="_quickBtn_1m2ej_140",q2="_active_1m2ej_159",z2="_actions_1m2ej_165",W2="_clearBtn_1m2ej_173",U2="_applyBtn_1m2ej_191",We={popover:$2,header:E2,title:T2,calculatedNote:P2,sliderContainer:M2,valueDisplay:I2,sliderWrapper:L2,sliderTrack:A2,sliderInput:R2,tickMarks:B2,tick:F2,quickSelect:O2,quickBtn:H2,active:q2,actions:z2,clearBtn:W2,applyBtn:U2};function V2({value:e,onChange:t,onClose:n,anchorEl:s,isCalculated:r=!1}){const[i,o]=g.useState(e??0),l=g.useRef(null);g.useEffect(()=>{if(!s||!l.current)return;const p=s.getBoundingClientRect(),_=l.current;_.style.top=`${p.bottom+8}px`,_.style.left=`${p.left}px`;const v=_.getBoundingClientRect();v.right>window.innerWidth-16&&(_.style.left=`${window.innerWidth-v.width-16}px`),v.bottom>window.innerHeight-16&&(_.style.top=`${p.top-v.height-8}px`)},[s]),g.useEffect(()=>{const p=v=>{l.current&&!l.current.contains(v.target)&&n()},_=v=>{v.key==="Escape"&&n()};return document.addEventListener("mousedown",p),document.addEventListener("keydown",_),()=>{document.removeEventListener("mousedown",p),document.removeEventListener("keydown",_)}},[n]);const c=p=>{const _=parseInt(p.target.value,10),v=Math.round(_/5)*5;o(v)},d=()=>{t(i),n()},f=()=>{t(-1),n()},h=[0,25,50,75,100];return a.jsxs("div",{ref:l,className:We.popover,children:[a.jsxs("div",{className:We.header,children:[a.jsx("span",{className:We.title,children:"Set Completion"}),r&&a.jsx("span",{className:We.calculatedNote,children:"Currently calculated from children"})]}),a.jsxs("div",{className:We.sliderContainer,children:[a.jsxs("div",{className:We.valueDisplay,children:[i,"%"]}),a.jsxs("div",{className:We.sliderWrapper,children:[a.jsx("div",{className:We.sliderTrack,style:{width:`${i}%`}}),a.jsx("input",{type:"range",min:"0",max:"100",step:"5",value:i,onChange:c,className:We.sliderInput})]}),a.jsxs("div",{className:We.tickMarks,children:[a.jsx("span",{className:We.tick,children:"0"}),a.jsx("span",{className:We.tick,children:"25"}),a.jsx("span",{className:We.tick,children:"50"}),a.jsx("span",{className:We.tick,children:"75"}),a.jsx("span",{className:We.tick,children:"100"})]})]}),a.jsx("div",{className:We.quickSelect,children:h.map(p=>a.jsxs("button",{type:"button",className:`${We.quickBtn} ${i===p?We.active:""}`,onClick:()=>o(p),children:[p,"%"]},p))}),a.jsxs("div",{className:We.actions,children:[a.jsx("button",{type:"button",className:We.clearBtn,onClick:f,children:"Clear"}),a.jsx("button",{type:"button",className:We.applyBtn,onClick:d,children:"Apply"})]})]})}const G2="_row_1tac0_1",Q2="_dragging_1tac0_20",Y2="_dropBefore_1tac0_24",X2="_dropAfter_1tac0_36",K2="_dragHandle_1tac0_49",Z2="_expandBtn_1tac0_76",J2="_expanded_1tac0_106",eS="_wbsLevel_1tac0_110",tS="_completionBadge_1tac0_136",nS="_manual_1tac0_149",sS="_calculated_1tac0_160",aS="_empty_1tac0_170",rS="_colorDot_1tac0_182",iS="_name_1tac0_190",oS="_dateDisplay_1tac0_199",It={row:G2,dragging:Q2,dropBefore:Y2,dropAfter:X2,dragHandle:K2,expandBtn:Z2,expanded:J2,wbsLevel:eS,completionBadge:tS,manual:nS,calculated:sS,empty:aS,colorDot:rS,name:iS,dateDisplay:oS};function lS(e,t){const n={month:"short",day:"numeric"},s=new Date(e).toLocaleDateString("en-US",n),r=new Date(t).toLocaleDateString("en-US",n);return`${s} - ${r}`}function bo(e){if(!e)return{completion:null,isCalculated:!1};const t=e.children||[];let n=!1;for(const s of t){if(!s)continue;const r=bo(s);if(r&&r.completion!==null){n=!0;break}}if(n){let s=0,r=0;for(const i of t){if(!i)continue;const o=bo(i),l=Math.max(1,Math.ceil((new Date(i.end_date).getTime()-new Date(i.start_date).getTime())/(1e3*60*60*24))),c=o.completion??0;r+=c*l,s+=l}if(s>0)return{completion:Math.round(r/s),isCalculated:!0}}return{completion:e.completion??null,isCalculated:!1}}const xg=g.memo(function({subphase:t,phaseId:n,projectId:s,depth:r,wbsLevel:i=1,siblings:o,parentId:l,parentType:c}){var V,G,re;const d=F(se=>se.expandedSubphases),f=F(se=>se.toggleSubphaseExpanded),h=F(se=>se.staff),p=F(se=>se.equipment),_=Z(se=>se.openSubphaseModal),v=Z(se=>se.triggerScrollToDate),u=F(se=>se.projects),y=F(se=>se.setProjects),[m,x]=g.useState(null),w=!!m,{handleDragStart:b,handleDragOver:S,handleDragLeave:N,handleDrop:D,handleDragEnd:L,isDragging:T,getDropPosition:j}=vg(),$=d.has(t.id),P=se=>{se.stopPropagation(),f(t.id)},k=()=>{_(t,n,s)},E=g.useCallback(se=>{se.stopPropagation(),v(t.start_date)},[t.start_date,v]),I=g.useCallback(se=>{se.stopPropagation(),!bo(t).isCalculated&&x(se.currentTarget)},[t]),M=g.useCallback((se,ve,st)=>se.map(yt=>yt.id===ve?{...yt,completion:st}:yt.children&&yt.children.length>0?{...yt,children:M(yt.children,ve,st)}:yt),[]),B=g.useCallback(async se=>{try{const ve=se===-1?null:se;await Ps(t.id,{completion:ve});const st=u.map(yt=>{var la;return yt.id!==s?yt:{...yt,phases:(la=yt.phases)==null?void 0:la.map(Ms=>Ms.id!==n?Ms:{...Ms,children:M(Ms.children||[],t.id,ve)})}});y(st)}catch(ve){console.error("Failed to update completion:",ve)}},[t.id,s,n,u,y,M]),C=(((V=t.children)==null?void 0:V.length)??0)>0||(((G=t.staffAssignments)==null?void 0:G.length)??0)>0||(((re=t.equipmentAssignments)==null?void 0:re.length)??0)>0,R=r*16+8,A=g.useMemo(()=>lS(t.start_date,t.end_date),[t.start_date,t.end_date]),H=g.useMemo(()=>bo(t),[t]),z=Z(se=>se.showContextMenu),K=g.useCallback(se=>{se.preventDefault(),z("subphase",t.id,se.clientX,se.clientY,s,n)},[z,t.id,s,n]),Q=g.useCallback(se=>{b(se,"subphase",t.id,s,l,c)},[b,t.id,s,l,c]),Y=g.useCallback(se=>{S(se,"subphase",t.id)},[S,t.id]),J=g.useCallback(se=>{D(se,"subphase",t.id,o,l,c)},[D,t.id,o,l,c]),ne=T("subphase",t.id),O=j("subphase",t.id);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`${It.row} ${ne?It.dragging:""} ${O?It[`drop${O.charAt(0).toUpperCase()+O.slice(1)}`]:""}`,style:{paddingLeft:R},"data-subphase-id":t.id,onDragOver:Y,onDragLeave:N,onDrop:J,onDoubleClick:k,onContextMenu:K,children:[a.jsx("div",{className:It.dragHandle,draggable:!0,onDragStart:Q,onDragEnd:L,title:"Drag to reorder",children:a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("circle",{cx:"9",cy:"6",r:"2"}),a.jsx("circle",{cx:"15",cy:"6",r:"2"}),a.jsx("circle",{cx:"9",cy:"12",r:"2"}),a.jsx("circle",{cx:"15",cy:"12",r:"2"}),a.jsx("circle",{cx:"9",cy:"18",r:"2"}),a.jsx("circle",{cx:"15",cy:"18",r:"2"})]})}),a.jsx("button",{className:`${It.expandBtn} ${$?It.expanded:""}`,onClick:P,disabled:!C,children:C&&a.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})}),a.jsx("button",{className:`${It.completionBadge} ${H.completion!==null?H.isCalculated?It.calculated:It.manual:It.empty}`,onClick:I,title:H.completion!==null?H.isCalculated?"Calculated from children":"Click to edit":"Click to set completion",children:H.completion!==null?`${H.completion}%`:""}),a.jsxs("button",{className:It.wbsLevel,style:{backgroundColor:t.color},onClick:E,title:`Level ${i} - Click to scroll to start date`,children:["L",i]}),a.jsx("span",{className:It.name,title:t.name,children:t.name}),a.jsx("span",{className:It.dateDisplay,children:A})]}),w&&Ud.createPortal(a.jsx(V2,{value:t.completion??null,onChange:B,onClose:()=>x(null),anchorEl:m,isCalculated:H.isCalculated}),document.body),$&&a.jsxs(a.Fragment,{children:[a.jsx(cS,{subphases:t.children??[],phaseId:n,projectId:s,depth:r+1,wbsLevel:i+1,parentId:t.id,parentType:"subphase"}),(t.staffAssignments??[]).map(se=>{const ve=h.find(st=>st.id===se.staff_id);return a.jsx(Ya,{type:"staff",name:(ve==null?void 0:ve.name)||"Unknown",role:ve==null?void 0:ve.role,allocation:se.allocation,depth:r+1},`staff-${se.id}`)}),(t.equipmentAssignments??[]).map(se=>{const ve=p.find(st=>st.id===se.equipment_id);return a.jsx(Ya,{type:"equipment",name:(ve==null?void 0:ve.name)||"Unknown",equipmentType:ve==null?void 0:ve.type,depth:r+1},`equip-${se.id}`)})]})]})});function cS({subphases:e,phaseId:t,projectId:n,depth:s,wbsLevel:r,parentId:i,parentType:o}){const l=Z(h=>h.phantomSiblingMode),{completePhantom:c,cancelPhantom:d}=ii(),f=(l==null?void 0:l.type)==="subphase"&&l.projectId===n?l.sourceId:null;return a.jsx(a.Fragment,{children:e.map(h=>a.jsxs(g.Fragment,{children:[a.jsx(xg,{subphase:h,phaseId:t,projectId:n,depth:s,wbsLevel:r,siblings:e,parentId:i,parentType:o}),f===h.id&&a.jsx(tu,{onComplete:c,onCancel:d})]},h.id))})}const dS="_row_11xi9_1",uS="_dragging_11xi9_20",fS="_dropBefore_11xi9_24",hS="_dropAfter_11xi9_36",mS="_dragHandle_11xi9_49",pS="_expandBtn_11xi9_76",gS="_expanded_11xi9_106",_S="_completionBadge_11xi9_110",yS="_manual_11xi9_123",vS="_calculated_11xi9_134",xS="_empty_11xi9_144",wS="_typeBadge_11xi9_156",jS="_colorDot_11xi9_169",SS="_name_11xi9_176",kS="_dateDisplay_11xi9_185",Qt={row:dS,dragging:uS,dropBefore:fS,dropAfter:hS,dragHandle:mS,expandBtn:pS,expanded:gS,completionBadge:_S,manual:yS,calculated:vS,empty:xS,typeBadge:wS,colorDot:jS,name:SS,dateDisplay:kS};function NS(e,t){const n={month:"short",day:"numeric"},s=new Date(e).toLocaleDateString("en-US",n),r=new Date(t).toLocaleDateString("en-US",n);return`${s} - ${r}`}function Wc(e){if(!e)return{completion:null,isCalculated:!1};const t=e.children||[];let n=!1;for(const s of t){if(!s)continue;const r=Wc(s);if(r&&r.completion!==null){n=!0;break}}if(n){let s=0,r=0;for(const i of t){if(!i)continue;const o=Wc(i),l=Math.max(1,Math.ceil((new Date(i.end_date).getTime()-new Date(i.start_date).getTime())/(1e3*60*60*24))),c=o.completion??0;r+=c*l,s+=l}if(s>0)return{completion:Math.round(r/s),isCalculated:!0}}return{completion:e.completion??null,isCalculated:!1}}const bS=g.memo(function({phase:t,projectId:n,depth:s,phases:r}){var I,M,B;const i=F(C=>C.expandedPhases),o=F(C=>C.togglePhaseExpanded),l=F(C=>C.staff),c=F(C=>C.equipment),d=Z(C=>C.openPhaseModal),{handleDragStart:f,handleDragOver:h,handleDragLeave:p,handleDrop:_,handleDragEnd:v,isDragging:u,getDropPosition:y}=vg(),m=i.has(t.id),x=C=>{C.stopPropagation(),o(t.id)},w=()=>{d(t,n)},b=(((I=t.children)==null?void 0:I.length)??0)>0||(((M=t.staffAssignments)==null?void 0:M.length)??0)>0||(((B=t.equipmentAssignments)==null?void 0:B.length)??0)>0,S=s*16+8,N=g.useMemo(()=>t.is_milestone?new Date(t.start_date).toLocaleDateString("en-US",{month:"short",day:"numeric"}):NS(t.start_date,t.end_date),[t.start_date,t.end_date,t.is_milestone]),D=g.useMemo(()=>Wc(t),[t]),L=Z(C=>C.showContextMenu),T=g.useCallback(C=>{C.preventDefault(),L("phase",t.id,C.clientX,C.clientY,n)},[L,t.id,n]),j=g.useCallback(C=>{f(C,"phase",t.id,n)},[f,t.id,n]),$=g.useCallback(C=>{h(C,"phase",t.id)},[h,t.id]),P=g.useCallback(C=>{_(C,"phase",t.id,r)},[_,t.id,r]),k=u("phase",t.id),E=y("phase",t.id);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`${Qt.row} ${k?Qt.dragging:""} ${E?Qt[`drop${E.charAt(0).toUpperCase()+E.slice(1)}`]:""}`,style:{paddingLeft:S},"data-phase-id":t.id,onDragOver:$,onDragLeave:p,onDrop:P,onDoubleClick:w,onContextMenu:T,children:[a.jsx("div",{className:Qt.dragHandle,draggable:!0,onDragStart:j,onDragEnd:v,title:"Drag to reorder",children:a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"currentColor",children:[a.jsx("circle",{cx:"9",cy:"6",r:"2"}),a.jsx("circle",{cx:"15",cy:"6",r:"2"}),a.jsx("circle",{cx:"9",cy:"12",r:"2"}),a.jsx("circle",{cx:"15",cy:"12",r:"2"}),a.jsx("circle",{cx:"9",cy:"18",r:"2"}),a.jsx("circle",{cx:"15",cy:"18",r:"2"})]})}),a.jsx("button",{className:`${Qt.expandBtn} ${m?Qt.expanded:""}`,onClick:x,disabled:!b,children:b&&a.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})}),a.jsx("span",{className:`${Qt.completionBadge} ${D.completion!==null?D.isCalculated?Qt.calculated:Qt.manual:Qt.empty}`,title:D.completion!==null?D.isCalculated?"Calculated from children":"Click to edit":"Click to set completion",children:D.completion!==null?`${D.completion}%`:""}),a.jsxs("span",{className:Qt.typeBadge,style:{backgroundColor:`${t.color}33`,color:t.color},children:[t.is_milestone?"":"",t.name]}),a.jsx("span",{className:Qt.dateDisplay,children:N})]}),m&&a.jsxs(a.Fragment,{children:[a.jsx(CS,{subphases:t.children??[],phaseId:t.id,projectId:n,depth:s+1}),(t.staffAssignments??[]).map(C=>{const R=l.find(A=>A.id===C.staff_id);return a.jsx(Ya,{type:"phase-staff",name:(R==null?void 0:R.name)||"Unknown",role:R==null?void 0:R.role,allocation:C.allocation,depth:s+1,phaseType:t.name,phaseColor:t.color},`staff-${C.id}`)}),(t.equipmentAssignments??[]).map(C=>{const R=c.find(A=>A.id===C.equipment_id);return a.jsx(Ya,{type:"equipment",name:(R==null?void 0:R.name)||"Unknown",equipmentType:R==null?void 0:R.type,depth:s+1},`equip-${C.id}`)})]})]})});function CS({subphases:e,phaseId:t,projectId:n,depth:s}){const r=Z(c=>c.phantomSiblingMode),{completePhantom:i,cancelPhantom:o}=ii(),l=(r==null?void 0:r.type)==="subphase"&&r.projectId===n&&r.parentType==="phase"&&r.parentId===t?r.sourceId:null;return a.jsx(a.Fragment,{children:e.map(c=>a.jsxs(g.Fragment,{children:[a.jsx(xg,{subphase:c,phaseId:t,projectId:n,depth:s,wbsLevel:1,siblings:e,parentId:t,parentType:"phase"}),l===c.id&&a.jsx(tu,{onComplete:i,onCancel:o})]},c.id))})}const DS="_row_dgvy4_1",$S="_unconfirmed_dgvy4_17",ES="_name_dgvy4_21",TS="_levelControls_dgvy4_26",PS="_levelBtn_dgvy4_36",MS="_status_dgvy4_107",IS="_confirmed_dgvy4_115",LS="_pending_dgvy4_119",AS="_completionBadge_dgvy4_124",RS="_info_dgvy4_139",BS="_meta_dgvy4_155",FS="_pm_dgvy4_164",OS="_customer_dgvy4_168",HS="_children_dgvy4_186",vt={row:DS,unconfirmed:$S,name:ES,levelControls:TS,levelBtn:PS,status:MS,confirmed:IS,pending:LS,completionBadge:AS,info:RS,meta:BS,pm:FS,customer:OS,children:HS};function Uc(e){if(!e)return{completion:null,isCalculated:!1};const t=e.children||[];let n=!1;for(const s of t){if(!s)continue;const r=Uc(s);if(r&&r.completion!==null){n=!0;break}}if(n){let s=0,r=0;for(const i of t){if(!i)continue;const o=Uc(i),l=Math.max(1,Math.ceil((new Date(i.end_date).getTime()-new Date(i.start_date).getTime())/(1e3*60*60*24))),c=o.completion??0;r+=c*l,s+=l}if(s>0)return{completion:Math.round(r/s),isCalculated:!0}}return{completion:e.completion??null,isCalculated:!1}}function qS(e){const t=e.phases??[];if(t.length===0)return null;let n=0,s=0;return t.forEach(r=>{const i=Uc(r),o=new Date(r.start_date),l=new Date(r.end_date),c=Math.max(1,(l.getTime()-o.getTime())/(1e3*60*60*24)),d=i.completion??0;n+=d*c,s+=c}),s>0?Math.round(n/s):null}const zS=g.memo(function({project:t}){const n=F(S=>S.expandedProjects),s=F(S=>S.expandedPhases),r=F(S=>S.expandedSubphases),i=F(S=>S.toggleProjectExpanded),o=F(S=>S.expandProjectLevel),l=F(S=>S.collapseProjectLevel),c=F(S=>S.staff),d=F(S=>S.equipment),f=Z(S=>S.openProjectModal),h=n.has(t.id),p=g.useMemo(()=>qS(t),[t]),_=g.useMemo(()=>{if(!n.has(t.id))return 0;const S=t.phases??[];if(!S.some(L=>s.has(L.id)))return 1;let D=!1;return S.forEach(L=>{const T=j=>{j==null||j.forEach($=>{r.has($.id)&&(D=!0),T($.children)})};T(L.children)}),D?3:2},[t,n,s,r]),v=g.useMemo(()=>{const S=t.phases??[];let N=1;return S.forEach(D=>{var L;if(((L=D.children)==null?void 0:L.length)>0){N=Math.max(N,2);const T=(j,$)=>{j==null||j.forEach(P=>{var k;N=Math.max(N,$),((k=P.children)==null?void 0:k.length)>0&&T(P.children,$+1)})};T(D.children,3)}}),N},[t]),u=S=>{S.stopPropagation(),i(t.id)},y=S=>{S.stopPropagation(),o(t.id)},m=S=>{S.stopPropagation(),l(t.id)},x=()=>{f(t)},w=Z(S=>S.showContextMenu),b=g.useCallback(S=>{S.preventDefault(),w("project",t.id,S.clientX,S.clientY)},[w,t.id]);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`${vt.row} ${t.confirmed?"":vt.unconfirmed}`,"data-project-id":t.id,onDoubleClick:x,onContextMenu:b,children:[a.jsxs("div",{className:vt.levelControls,onClick:S=>S.stopPropagation(),children:[a.jsx("button",{className:vt.levelBtn,onClick:m,disabled:_===0,title:"Collapse one level",children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})})}),a.jsx("button",{className:vt.levelBtn,onClick:y,disabled:_>=v,title:"Expand one level",children:a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]}),a.jsx("span",{className:`${vt.status} ${t.confirmed?vt.confirmed:vt.pending}`,title:t.confirmed?"Confirmed":"Unconfirmed",onClick:u}),p!==null&&a.jsxs("span",{className:vt.completionBadge,title:"Project completion (calculated from phases)",children:[p,"%"]}),a.jsxs("div",{className:vt.info,onClick:u,children:[a.jsx("span",{className:vt.name,title:t.name,children:t.name}),a.jsxs("span",{className:vt.meta,children:[t.pm_name&&a.jsx("span",{className:vt.pm,children:t.pm_name}),t.customer&&a.jsxs("span",{className:vt.customer,children:["  ",t.customer]})]})]})]}),h&&a.jsxs("div",{className:vt.children,children:[a.jsx(WS,{phases:t.phases??[],projectId:t.id}),(t.staffAssignments??[]).map(S=>{const N=c.find(D=>D.id===S.staff_id);return a.jsx(Ya,{type:"staff",name:(N==null?void 0:N.name)||"Unknown",role:N==null?void 0:N.role,allocation:S.allocation,depth:1},`staff-${S.id}`)}),(t.equipmentAssignments??[]).map(S=>{const N=d.find(D=>D.id===S.equipment_id);return a.jsx(Ya,{type:"equipment",name:(N==null?void 0:N.name)||"Unknown",equipmentType:N==null?void 0:N.type,depth:1},`equip-${S.id}`)})]})]})});function WS({phases:e,projectId:t}){const n=Z(o=>o.phantomSiblingMode),{completePhantom:s,cancelPhantom:r}=ii(),i=(n==null?void 0:n.type)==="phase"&&n.projectId===t?n.sourceId:null;return a.jsx(a.Fragment,{children:e.map(o=>a.jsxs(g.Fragment,{children:[a.jsx(bS,{phase:o,projectId:t,depth:1,phases:e}),i===o.id&&a.jsx(tu,{onComplete:s,onCancel:r})]},o.id))})}const US="_panel_18bwh_1",VS="_header_18bwh_10",GS="_headerLeft_18bwh_21",QS="_headerTitle_18bwh_27",YS="_headerCount_18bwh_33",XS="_headerActions_18bwh_41",KS="_importBtn_18bwh_47",ZS="_newProjectBtn_18bwh_68",JS="_body_18bwh_91",ek="_empty_18bwh_116",tk="_emptyHint_18bwh_131",ln={panel:US,header:VS,headerLeft:GS,headerTitle:QS,headerCount:YS,headerActions:XS,importBtn:KS,newProjectBtn:ZS,body:JS,empty:ek,emptyHint:tk},nk=g.forwardRef(function({projects:t,width:n},s){const r=Z(c=>c.openProjectModal),i=Z(c=>c.setActiveModal),o=F(c=>c.currentUser),l=(o==null?void 0:o.role)==="admin"||(o==null?void 0:o.role)==="superuser";return a.jsx(g2,{children:a.jsxs("div",{className:ln.panel,style:{width:n},children:[a.jsxs("div",{className:ln.header,children:[a.jsxs("div",{className:ln.headerLeft,children:[a.jsx("span",{className:ln.headerTitle,children:"Projects"}),a.jsx("span",{className:ln.headerCount,children:t.length})]}),l&&a.jsxs("div",{className:ln.headerActions,children:[a.jsx("button",{className:ln.importBtn,onClick:()=>i("importProject"),title:"Import Project",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a.jsx("polyline",{points:"17 8 12 3 7 8"}),a.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})}),a.jsxs("button",{className:ln.newProjectBtn,onClick:()=>r(),title:"New Project",children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),a.jsx("span",{children:"New"})]})]})]}),a.jsx("div",{ref:s,className:ln.body,children:t.length===0?a.jsxs("div",{className:ln.empty,children:[a.jsx("p",{children:"No projects found"}),a.jsx("p",{className:ln.emptyHint,children:l?'Click "New" to create a project':"No projects available for this site"})]}):t.map(c=>a.jsx(zS,{project:c},c.id))})]})})}),sk="_header_nqeoa_1",ak="_headerContent_nqeoa_7",rk="_primaryRow_nqeoa_12",ik="_primaryCell_nqeoa_18",ok="_current_nqeoa_32",lk="_secondaryRow_nqeoa_37",ck="_secondaryCell_nqeoa_42",dk="_weekend_nqeoa_54",uk="_holiday_nqeoa_58",fk="_today_nqeoa_63",hk="_dayLabel_nqeoa_69",mk="_weekLabelTop_nqeoa_74",pk="_weekLabelBottom_nqeoa_86",gk="_monthLabel_nqeoa_95",bt={header:sk,headerContent:ak,primaryRow:rk,primaryCell:ik,current:ok,secondaryRow:lk,secondaryCell:ck,weekend:dk,holiday:uk,today:fk,dayLabel:hk,weekLabelTop:mk,weekLabelBottom:pk,monthLabel:gk},oi=g.memo(function({headers:t,cells:n,cellWidth:s,totalWidth:r,viewMode:i}){const o=i==="week"||i==="month"||i==="quarter",l=i==="week"||i==="month";return a.jsx("div",{className:bt.header,children:a.jsxs("div",{className:bt.headerContent,style:{width:r},children:[a.jsx("div",{className:bt.primaryRow,children:t.primary.map((c,d)=>a.jsx("div",{className:`${bt.primaryCell} ${c.isCurrentPeriod?bt.current:""}`,style:{width:c.span*s},children:c.label},d))}),a.jsx("div",{className:bt.secondaryRow,children:n.map((c,d)=>a.jsxs("div",{className:`${bt.secondaryCell} ${c.isToday?bt.today:""} ${l&&c.isWeekend?bt.weekend:""} ${l&&c.isBankHoliday?bt.holiday:""}`,style:{width:s},title:l&&c.isBankHoliday?c.bankHolidayName:void 0,"data-date":c.dateStr,"data-date-end":c.dateEnd||void 0,children:[a.jsx("span",{className:bt.dayLabel,children:c.label}),o&&c.isFirstOfWeek&&a.jsxs("span",{className:i==="month"?bt.weekLabelBottom:bt.weekLabelTop,children:["W",c.weekNumber]}),c.isFirstOfMonth&&s<40&&a.jsx("span",{className:bt.monthLabel,children:c.monthLabel})]},d))})]})})}),_k="_bar_7th6k_1",yk="_confirmed_7th6k_34",vk="_unconfirmed_7th6k_39",xk="_label_7th6k_51",Pi={bar:_k,confirmed:yk,unconfirmed:vk,label:xk},wk=g.memo(function({left:t,width:n,name:s,confirmed:r,completion:i,projectId:o,startDate:l,endDate:c,onDragStart:d}){return a.jsx("div",{className:`${Pi.bar} ${r?Pi.confirmed:Pi.unconfirmed} gantt-bar`,style:{left:t,width:n},title:`${s}${i!=null?` (${i}%)`:""}
Drag to move project`,"data-project-id":o,"data-start":l,"data-end":c,onMouseDown:d,children:n>60&&a.jsx("span",{className:Pi.label,children:s})})}),jk="_bar_15lgi_1",Sk="_subphase_15lgi_22",kk="_label_15lgi_27",Nk="_completionBar_15lgi_47",bk="_resizeHandle_15lgi_64",Ck="_left_15lgi_88",Dk="_right_15lgi_93",$k="_milestone_15lgi_115",Ek="_milestoneDiamond_15lgi_131",Tk="_milestoneLabel_15lgi_143",Pk="_linkZone_15lgi_183",Mk="_start_15lgi_196",Ik="_end_15lgi_200",Lk="_linkingActive_15lgi_245",Ak="_linkingSource_15lgi_262",Rk="_milestoneZone_15lgi_273",xe={bar:jk,subphase:Sk,label:kk,completionBar:Nk,resizeHandle:bk,left:Ck,right:Dk,milestone:$k,milestoneDiamond:Ek,milestoneLabel:Tk,linkZone:Pk,start:Mk,end:Ik,linkingActive:Lk,linkingSource:Ak,milestoneZone:Rk},Qf=5;function Yf(e){return"touches"in e&&e.touches.length>0?{clientX:e.touches[0].clientX,clientY:e.touches[0].clientY}:"changedTouches"in e&&e.changedTouches.length>0?{clientX:e.changedTouches[0].clientX,clientY:e.changedTouches[0].clientY}:{clientX:e.clientX,clientY:e.clientY}}function Il(e,t="mousedown"){const n=e.touches[0]||e.changedTouches[0];return{...e,type:t,clientX:n.clientX,clientY:n.clientY,screenX:n.screenX,screenY:n.screenY,pageX:n.pageX,pageY:n.pageY,button:0,buttons:1}}const wg=g.memo(function({left:t,width:n,color:s,name:r,isSubphase:i=!1,isMilestone:o=!1,completion:l=null,phaseId:c,projectId:d,onDragStart:f,onResizeStart:h,onClick:p,onLinkZoneClick:_,isLinkingSource:v=!1,isLinkingActive:u=!1,onPhantomStart:y}){const m=g.useRef(null),x=g.useRef({isDragging:!1,startX:0,startY:0,hasMoved:!1,originalEvent:null,isTouch:!1}),w=i?16:20,b=g.useCallback(P=>{if(P.target.classList.contains(xe.resizeHandle))return;P.preventDefault();const E="touches"in P,I=Yf(P),M=E?Il(P):P;x.current={isDragging:!0,startX:I.clientX,startY:I.clientY,hasMoved:!1,originalEvent:M,isTouch:E};const B=R=>{const A=x.current;if(!A.isDragging)return;const H=Yf(R),z=Math.abs(H.clientX-A.startX),K=Math.abs(H.clientY-A.startY);!A.hasMoved&&(z>Qf||K>Qf)&&(A.hasMoved=!0,"touches"in R&&R.preventDefault(),f&&m.current&&A.originalEvent&&f(A.originalEvent,m.current))},C=()=>{const R=x.current;document.removeEventListener("mousemove",B),document.removeEventListener("mouseup",C),document.removeEventListener("touchmove",B),document.removeEventListener("touchend",C),document.removeEventListener("touchcancel",C),!R.hasMoved&&p&&R.originalEvent&&p(R.originalEvent),x.current={isDragging:!1,startX:0,startY:0,hasMoved:!1,originalEvent:null,isTouch:!1}};document.addEventListener("mousemove",B),document.addEventListener("mouseup",C),document.addEventListener("touchmove",B,{passive:!1}),document.addEventListener("touchend",C),document.addEventListener("touchcancel",C)},[f,p]),S=g.useCallback(P=>{P.stopPropagation(),P.preventDefault(),x.current.hasMoved=!0;const E="touches"in P?Il(P):P;h&&m.current&&h(E,"left",m.current)},[h]),N=g.useCallback(P=>{P.stopPropagation(),P.preventDefault(),x.current.hasMoved=!0;const E="touches"in P?Il(P):P;h&&m.current&&h(E,"right",m.current)},[h]),D=g.useCallback(P=>{if(P.stopPropagation(),P.preventDefault(),P.shiftKey&&y){y("start");return}_&&_(P,"start")},[_,y]),L=g.useCallback(P=>{if(P.stopPropagation(),P.preventDefault(),P.shiftKey&&y){y("end");return}_&&_(P,"end")},[_,y]);if(o){const P=i?{"data-subphase-id":c,"data-project-id":d}:{"data-phase-id":c,"data-project-id":d};return a.jsxs("div",{ref:m,className:`${xe.milestone} ${i?xe.subphase:""} ${v?xe.linkingSource:""}`,style:{left:t+n/2-12},title:r,onMouseDown:b,onTouchStart:b,...P,children:[_&&a.jsx("div",{className:`${xe.linkZone} ${xe.start} ${xe.milestoneZone} ${u?xe.linkingActive:""}`,onClick:D,onMouseDown:k=>k.stopPropagation(),onTouchStart:k=>k.stopPropagation(),title:"Click to start linking (SS or SF)"}),a.jsx("div",{className:xe.milestoneDiamond,style:{backgroundColor:s}}),r&&a.jsx("span",{className:xe.milestoneLabel,children:r}),_&&a.jsx("div",{className:`${xe.linkZone} ${xe.end} ${xe.milestoneZone} ${u?xe.linkingActive:""}`,onClick:L,onMouseDown:k=>k.stopPropagation(),onTouchStart:k=>k.stopPropagation(),title:"Click to start linking (FS or FF)"})]})}const T=l!==null&&l>=0,j=T?Math.min(100,Math.max(0,l)):0,$=i?{"data-subphase-id":c,"data-project-id":d}:{"data-phase-id":c,"data-project-id":d};return a.jsxs("div",{ref:m,className:`${xe.bar} ${i?xe.subphase:""} ${v?xe.linkingSource:""}`,style:{left:t,width:n,height:w,backgroundColor:s},title:T?`${r} (${l}%)`:r,onMouseDown:b,onTouchStart:b,...$,children:[T&&j>0&&a.jsx("div",{className:xe.completionBar,style:{width:`${j}%`}}),_&&a.jsx("div",{className:`${xe.linkZone} ${xe.start} ${u?xe.linkingActive:""}`,onClick:D,onMouseDown:P=>P.stopPropagation(),onTouchStart:P=>P.stopPropagation(),title:"Click to start linking (SS or SF)"}),!o&&h&&a.jsx("div",{className:`${xe.resizeHandle} ${xe.left}`,onMouseDown:S,onTouchStart:S}),n>40&&a.jsx("span",{className:xe.label,children:r}),!o&&h&&a.jsx("div",{className:`${xe.resizeHandle} ${xe.right}`,onMouseDown:N,onTouchStart:N}),_&&a.jsx("div",{className:`${xe.linkZone} ${xe.end} ${u?xe.linkingActive:""}`,onClick:L,onMouseDown:P=>P.stopPropagation(),onTouchStart:P=>P.stopPropagation(),title:"Click to start linking (FS or FF)"})]})}),Bk="_row_17spb_1",Fk="_projectRow_17spb_8",Ok="_assignmentBar_17spb_16",Hk="_staff_17spb_32",qk="_equipment_17spb_36",zk="_interactive_17spb_41",Wk="_dragging_17spb_53",Uk="_resizeHandle_17spb_59",Vk="_left_17spb_75",Gk="_right_17spb_80",Qk="_phaseStaff_17spb_86",Yk="_subphaseStaff_17spb_91",Xk="_barLabel_17spb_97",Kk="_vacationCellMarker_17spb_107",Zk="_phantomRow_17spb_130",Pe={row:Bk,projectRow:Fk,assignmentBar:Ok,staff:Hk,equipment:qk,interactive:zk,dragging:Wk,resizeHandle:Uk,left:Vk,right:Gk,phaseStaff:Qk,subphaseStaff:Yk,barLabel:Xk,vacationCellMarker:Kk,phantomRow:Zk};function Jk(e){const t=e.phases??[];if(t.length===0)return null;let n=0,s=0;return t.forEach(r=>{const i=r.completion;if(i!=null){const o=new Date(r.start_date),l=new Date(r.end_date),c=Math.max(1,(l.getTime()-o.getTime())/(1e3*60*60*24));n+=i*c,s+=c}}),s>0?Math.round(n/s):null}const eN=g.memo(function({project:t,cells:n,cellWidth:s,isExpanded:r,expandedPhases:i,expandedSubphases:o}){const{openPhaseModal:l,openSubphaseModal:c,setEditingPhase:d,setEditingSubphase:f}=Z(),h=Z(O=>O.phantomSiblingMode),p=F(O=>O.viewMode),{startProjectDrag:_,startPhaseDrag:v,startSubphaseDrag:u,startStaffAssignmentDrag:y,startEquipmentAssignmentDrag:m}=K0(),{startPhaseResize:x,startSubphaseResize:w,startStaffAssignmentResize:b,startEquipmentAssignmentResize:S}=Z0(),{isLinkingDependency:N,linkingFrom:D,handleLinkZoneClick:L}=sw(),{startPhantom:T,isPhantomMode:j}=ii(),$=g.useMemo(()=>{if(!t.start_date||!t.end_date){let O=null,V=null;return(t.phases??[]).forEach(G=>{(!O||G.start_date<O)&&(O=G.start_date),(!V||G.end_date>V)&&(V=G.end_date)}),O&&V?Mt(O,V,n,s,p):null}return Mt(t.start_date,t.end_date,n,s,p)},[t,n,s,p]),P=g.useMemo(()=>Jk(t),[t]),k=g.useCallback(O=>{if(!t.start_date||!t.end_date){console.warn("Project has no dates, cannot drag");return}_(O,t.id,t.start_date,t.end_date)},[_,t.id,t.start_date,t.end_date]),E=g.useCallback((O,V,G)=>{v(O,V.id,t.id,V.start_date,V.end_date,V.is_milestone,G)},[v,t.id]),I=g.useCallback((O,V,G,re)=>{x(O,V.id,t.id,G,V.start_date,V.end_date,re)},[x,t.id]),M=g.useCallback(O=>{d(O),l(O,t.id)},[d,l,t.id]),B=g.useCallback((O,V,G,re)=>{u(O,V.id,t.id,G,V.start_date,V.end_date,V.is_milestone,re)},[u,t.id]),C=g.useCallback((O,V,G,re)=>{w(O,V.id,t.id,G,V.start_date,V.end_date,re)},[w,t.id]),R=g.useCallback((O,V)=>{f(O),c(O,V,t.id)},[f,c,t.id]),A=g.useCallback((O,V,G,re)=>{y(O,V,t.id,G,re)},[y,t.id]),H=g.useCallback((O,V,G,re,se)=>{b(O,V,t.id,G,re,se)},[b,t.id]),z=g.useCallback((O,V,G,re)=>{m(O,V,t.id,G,re)},[m,t.id]),K=g.useCallback((O,V,G,re,se)=>{S(O,V,t.id,G,re,se)},[S,t.id]),Q=g.useCallback((O,V,G,re)=>{L(O,t.id,V,G,re)},[L,t.id]),Y=g.useCallback((O,V,G)=>{j||N||T({projectId:t.id,sourceId:O,type:V,zone:G})},[T,t.id,j,N]),J=(D==null?void 0:D.projectId)===t.id?D.itemId:null,ne=(D==null?void 0:D.projectId)===t.id?D.itemType:null;return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:`${Pe.row} ${Pe.projectRow}`,"data-project-id":t.id,children:$&&a.jsx(wk,{left:$.left,width:$.width,name:t.name,confirmed:t.confirmed,completion:P,projectId:t.id,startDate:t.start_date||"",endDate:t.end_date||"",onDragStart:k})}),r&&a.jsxs(a.Fragment,{children:[(t.phases??[]).map(O=>{const V=(h==null?void 0:h.type)==="phase"&&h.projectId===t.id&&h.sourceId===O.id;return a.jsxs(g.Fragment,{children:[a.jsx(tN,{phase:O,projectId:t.id,cells:n,cellWidth:s,viewMode:p,isExpanded:i.has(O.id),expandedSubphases:o,depth:1,onPhaseDragStart:E,onPhaseResizeStart:I,onPhaseClick:M,onSubphaseDragStart:B,onSubphaseResizeStart:C,onSubphaseClick:R,onLinkZoneClick:Q,isLinkingDependency:N,linkingFromId:J,linkingFromType:ne,onPhantomStart:Y}),V&&a.jsx("div",{className:Pe.phantomRow})]},O.id)}),(t.staffAssignments??[]).map(O=>a.jsx("div",{className:Pe.row,children:a.jsx(Xa,{assignmentId:O.id,assignmentType:"staff",startDate:O.start_date,endDate:O.end_date,cells:n,cellWidth:s,viewMode:p,type:"staff",name:O.staff_name,allocation:O.allocation,staffId:O.staff_id,interactive:!0,onDragStart:V=>A(V,O.id,O.start_date,O.end_date),onResizeStart:(V,G)=>H(V,O.id,G,O.start_date,O.end_date)})},`staff-${O.id}`)),(t.equipmentAssignments??[]).map(O=>a.jsx("div",{className:Pe.row,children:a.jsx(Xa,{assignmentId:O.id,assignmentType:"equipment",startDate:O.start_date,endDate:O.end_date,cells:n,cellWidth:s,viewMode:p,type:"equipment",name:O.equipment_name,interactive:!0,onDragStart:V=>z(V,O.id,O.start_date,O.end_date),onResizeStart:(V,G)=>K(V,O.id,G,O.start_date,O.end_date)})},`equip-${O.id}`))]})]})}),tN=g.memo(function({phase:t,projectId:n,cells:s,cellWidth:r,viewMode:i,isExpanded:o,expandedSubphases:l,depth:c,onPhaseDragStart:d,onPhaseResizeStart:f,onPhaseClick:h,onSubphaseDragStart:p,onSubphaseResizeStart:_,onSubphaseClick:v,onLinkZoneClick:u,isLinkingDependency:y,linkingFromId:m,linkingFromType:x,onPhantomStart:w}){const b=Z(P=>P.phantomSiblingMode),S=g.useMemo(()=>Mt(t.start_date,t.end_date,s,r,i),[t.start_date,t.end_date,s,r,i]),N=g.useCallback((P,k)=>{d(P,t,k)},[d,t]),D=g.useCallback((P,k,E)=>{f(P,t,k,E)},[f,t]),L=g.useCallback(P=>{P.stopPropagation(),h(t)},[h,t]),T=g.useCallback((P,k)=>{u(P,t.id,"phase",k)},[u,t.id]),j=g.useCallback(P=>{w(t.id,"phase",P)},[w,t.id]),$=y&&x==="phase"&&m===t.id;return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:Pe.row,"data-phase-id":t.id,children:S&&a.jsx(wg,{left:S.left,width:S.width,color:t.color,name:t.name,isMilestone:!!t.is_milestone,completion:t.completion,phaseId:t.id,projectId:n,startDate:t.start_date,endDate:t.end_date,onDragStart:N,onResizeStart:t.is_milestone?void 0:D,onClick:L,onLinkZoneClick:T,isLinkingSource:$,isLinkingActive:y,onPhantomStart:j})}),o&&a.jsxs(a.Fragment,{children:[(t.children??[]).map(P=>{const k=(b==null?void 0:b.type)==="subphase"&&b.projectId===n&&b.parentType==="phase"&&b.parentId===t.id&&b.sourceId===P.id;return a.jsxs(g.Fragment,{children:[a.jsx(nN,{subphase:P,phaseId:t.id,projectId:n,cells:s,cellWidth:r,viewMode:i,isExpanded:l.has(P.id),expandedSubphases:l,depth:c+1,onSubphaseDragStart:p,onSubphaseResizeStart:_,onSubphaseClick:v,onLinkZoneClick:u,isLinkingDependency:y,linkingFromId:m,linkingFromType:x,onPhantomStart:w}),k&&a.jsx("div",{className:Pe.phantomRow})]},P.id)}),(t.staffAssignments??[]).map(P=>a.jsx("div",{className:Pe.row,children:a.jsx(Xa,{assignmentId:P.id,assignmentType:"staff",startDate:t.start_date,endDate:t.end_date,cells:s,cellWidth:r,viewMode:i,type:"phase-staff",name:P.staff_name,allocation:P.allocation,phaseColor:t.color,staffId:P.staff_id})},`staff-${P.id}`)),(t.equipmentAssignments??[]).map(P=>a.jsx("div",{className:Pe.row,children:a.jsx(Xa,{assignmentId:P.id,assignmentType:"equipment",startDate:t.start_date,endDate:t.end_date,cells:s,cellWidth:r,viewMode:i,type:"equipment",name:P.equipment_name})},`equip-${P.id}`))]})]})}),nN=g.memo(function e({subphase:t,phaseId:n,projectId:s,cells:r,cellWidth:i,viewMode:o,isExpanded:l,expandedSubphases:c,depth:d,onSubphaseDragStart:f,onSubphaseResizeStart:h,onSubphaseClick:p,onLinkZoneClick:_,isLinkingDependency:v,linkingFromId:u,linkingFromType:y,onPhantomStart:m}){const x=Z(j=>j.phantomSiblingMode),w=g.useMemo(()=>Mt(t.start_date,t.end_date,r,i,o),[t.start_date,t.end_date,r,i,o]),b=g.useCallback((j,$)=>{f(j,t,n,$)},[f,t,n]),S=g.useCallback((j,$,P)=>{h(j,t,$,P)},[h,t]),N=g.useCallback(j=>{j.stopPropagation(),p(t,n)},[p,t,n]),D=g.useCallback((j,$)=>{_(j,t.id,"subphase",$)},[_,t.id]),L=g.useCallback(j=>{m(t.id,"subphase",j)},[m,t.id]),T=v&&y==="subphase"&&u===t.id;return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:Pe.row,"data-subphase-id":t.id,children:w&&a.jsx(wg,{left:w.left,width:w.width,color:t.color,name:t.name,isSubphase:!0,isMilestone:!!t.is_milestone,completion:t.completion,phaseId:t.id,projectId:s,startDate:t.start_date,endDate:t.end_date,onDragStart:b,onResizeStart:t.is_milestone?void 0:S,onClick:N,onLinkZoneClick:D,isLinkingSource:T,isLinkingActive:v,onPhantomStart:L})}),l&&a.jsxs(a.Fragment,{children:[(t.children??[]).map(j=>{const $=(x==null?void 0:x.type)==="subphase"&&x.projectId===s&&x.sourceId===j.id;return a.jsxs(g.Fragment,{children:[a.jsx(e,{subphase:j,phaseId:n,projectId:s,cells:r,cellWidth:i,viewMode:o,isExpanded:c.has(j.id),expandedSubphases:c,depth:d+1,onSubphaseDragStart:f,onSubphaseResizeStart:h,onSubphaseClick:p,onLinkZoneClick:_,isLinkingDependency:v,linkingFromId:u,linkingFromType:y,onPhantomStart:m}),$&&a.jsx("div",{className:Pe.phantomRow})]},j.id)}),(t.staffAssignments??[]).map(j=>a.jsx("div",{className:Pe.row,children:a.jsx(Xa,{assignmentId:j.id,assignmentType:"staff",startDate:t.start_date,endDate:t.end_date,cells:r,cellWidth:i,viewMode:o,type:"subphase-staff",name:j.staff_name,allocation:j.allocation,phaseColor:t.color,staffId:j.staff_id})},`staff-${j.id}`)),(t.equipmentAssignments??[]).map(j=>a.jsx("div",{className:Pe.row,children:a.jsx(Xa,{assignmentId:j.id,assignmentType:"equipment",startDate:t.start_date,endDate:t.end_date,cells:r,cellWidth:i,viewMode:o,type:"equipment",name:j.equipment_name})},`equip-${j.id}`))]})]})}),Xa=g.memo(function({assignmentId:t,assignmentType:n,startDate:s,endDate:r,cells:i,cellWidth:o,viewMode:l,type:c,name:d,allocation:f,phaseColor:h,staffId:p,onDragStart:_,onResizeStart:v,interactive:u=!1}){const y=F(j=>j.vacations),m=g.useMemo(()=>Mt(s,r,i,o,l),[s,r,i,o,l]),x=g.useMemo(()=>{if(!p||n!=="staff")return[];const j=y.filter(P=>P.staff_id===p);if(j.length===0)return[];const $=[];return i.forEach((P,k)=>{const E=new Date(P.date),I=new Date(E);I.setDate(I.getDate()+1);const M=j.find(B=>{const C=new Date(B.start_date),R=new Date(B.end_date);return R.setDate(R.getDate()+1),C<I&&R>E});if(M){const B=$[$.length-1],C=k*o;B&&B.left+B.width===C&&B.title===(M.description||"Vacation")?B.width+=o:$.push({left:C,width:o,title:M.description||"Vacation"})}}),$},[p,n,y,i,o]);if(!m)return null;const w=c==="phase-staff",b=c==="subphase-staff",S=c==="phase-staff"||c==="subphase-staff"?"staff":c,N={left:m.left,width:m.width};w&&(N.opacity=.7,h&&(N.background=h),N.border="1px dashed rgba(255,255,255,0.4)"),b&&(N.opacity=.7,N.height="14px",h&&(N.background=h));const D=d?f?`${d} (${f}%)`:d:f?`${f}%`:"",L=j=>{j.target.classList.contains("resize-handle")||_&&_(j)},T=(j,$)=>{j.stopPropagation(),v&&v(j,$)};return a.jsxs(a.Fragment,{children:[x.map((j,$)=>a.jsx("div",{className:Pe.vacationCellMarker,style:{left:j.left,width:j.width},title:j.title},`vac-${$}`)),a.jsxs("div",{className:`${Pe.assignmentBar} ${Pe[S]} ${w?Pe.phaseStaff:""} ${b?Pe.subphaseStaff:""} ${u?Pe.interactive:""}`,style:N,title:u?`${D}
Drag to move`:D,"data-assignment-id":t,"data-assignment-type":n,"data-start":s,"data-end":r,onMouseDown:u?L:void 0,children:[u&&a.jsx("div",{className:`${Pe.resizeHandle} ${Pe.left} resize-handle`,onMouseDown:j=>T(j,"left")}),a.jsx("span",{className:Pe.barLabel,children:D}),u&&a.jsx("div",{className:`${Pe.resizeHandle} ${Pe.right} resize-handle`,onMouseDown:j=>T(j,"right")})]})]})}),sN="_line_16bxs_1",aN="_marker_16bxs_11",Xf={line:sN,marker:aN},rN=g.memo(function({position:t}){return a.jsx("div",{className:Xf.line,style:{left:t},children:a.jsx("div",{className:Xf.marker})})}),iN="_popup_17gls_3",oN="_header_17gls_15",lN="_typeLabel_17gls_24",cN="_closeButton_17gls_30",dN="_content_17gls_50",uN="_connection_17gls_54",fN="_fromTo_17gls_66",hN="_name_17gls_71",mN="_footer_17gls_79",pN="_deleteButton_17gls_85",Lt={popup:iN,header:oN,typeLabel:lN,closeButton:cN,content:dN,connection:uN,fromTo:fN,name:hN,footer:mN,deleteButton:pN},gN={FS:"Finish-to-Start",SS:"Start-to-Start",FF:"Finish-to-Finish",SF:"Start-to-Finish"},_N=g.memo(function({visible:t,x:n,y:s,dependencyType:r,fromName:i,toName:o,onClose:l,onDelete:c}){const d=g.useRef(null);g.useEffect(()=>{if(!t)return;const _=u=>{d.current&&!d.current.contains(u.target)&&l()},v=setTimeout(()=>{document.addEventListener("mousedown",_)},100);return()=>{clearTimeout(v),document.removeEventListener("mousedown",_)}},[t,l]),g.useEffect(()=>{if(!t)return;const _=v=>{v.key==="Escape"&&l()};return document.addEventListener("keydown",_),()=>document.removeEventListener("keydown",_)},[t,l]);const f=g.useCallback(()=>{confirm(`Remove this ${r} dependency?`)&&c()},[r,c]);if(!t)return null;const h=Math.min(n,window.innerWidth-250),p=Math.min(s,window.innerHeight-180);return a.jsxs("div",{ref:d,className:Lt.popup,style:{left:h,top:p},children:[a.jsxs("div",{className:Lt.header,children:[a.jsx("span",{className:Lt.typeLabel,children:gN[r]}),a.jsx("button",{className:Lt.closeButton,onClick:l,title:"Close",children:""})]}),a.jsxs("div",{className:Lt.content,children:[a.jsxs("div",{className:Lt.connection,children:[a.jsx("span",{className:Lt.fromTo,children:"From:"}),a.jsx("span",{className:Lt.name,children:i})]}),a.jsxs("div",{className:Lt.connection,children:[a.jsx("span",{className:Lt.fromTo,children:"To:"}),a.jsx("span",{className:Lt.name,children:o})]})]}),a.jsx("div",{className:Lt.footer,children:a.jsx("button",{className:Lt.deleteButton,onClick:f,children:"Delete Dependency"})})]})}),yN="_layer_7cyyn_5",vN="_dependency_7cyyn_16",xN="_arrow_7cyyn_20",wN="_hitArea_7cyyn_24",Mi={layer:yN,dependency:vN,arrow:xN,hitArea:wN},jN=g.memo(function({projects:t,cells:n,cellWidth:s,rowPositions:r}){const i=F(S=>S.viewMode),o=F(S=>S.setProjects),l=g.useRef(null),[c,d]=g.useState(new Map),[f,h]=g.useState(null);g.useEffect(()=>{const S=requestAnimationFrame(()=>{var j;if(!l.current)return;const N=(j=l.current.parentElement)==null?void 0:j.querySelector('[class*="rows"]');if(!N)return;const D=new Map;N.querySelectorAll("[data-phase-id]").forEach($=>{const P=$.getAttribute("data-phase-id");if(P){const k=$.getBoundingClientRect(),E=N.getBoundingClientRect();D.set(`phase-${P}`,{top:k.top-E.top,height:k.height})}}),N.querySelectorAll("[data-subphase-id]").forEach($=>{const P=$.getAttribute("data-subphase-id");if(P){const k=$.getBoundingClientRect(),E=N.getBoundingClientRect();D.set(`subphase-${P}`,{top:k.top-E.top,height:k.height})}}),d(D)});return()=>cancelAnimationFrame(S)},[t,r]);const p=c.size>0?c:r,_=g.useMemo(()=>z0(t),[t]),v=g.useMemo(()=>_.filter(S=>{const N=`${S.fromType}-${S.fromId}`,D=`${S.toType}-${S.toId}`;return r.has(N)&&r.has(D)}),[_,r]),u=g.useMemo(()=>{const S=new Map;return t.forEach(N=>{(N.phases??[]).forEach(D=>{S.set(`phase-${D.id}`,{start_date:D.start_date,end_date:D.end_date,color:D.color});const L=(T,j)=>{(T??[]).forEach($=>{var P;S.set(`subphase-${$.id}`,{start_date:$.start_date,end_date:$.end_date,color:$.color||j}),(P=$.children)!=null&&P.length&&L($.children,$.color||j)})};L(D.children,D.color)})}),S},[t]),y=g.useMemo(()=>v.map(S=>{const N=`${S.fromType}-${S.fromId}`,D=`${S.toType}-${S.toId}`,L=p.get(N),T=p.get(D),j=u.get(N),$=u.get(D);if(!L||!T||!j||!$)return null;const P=Mt(j.start_date,j.end_date,n,s,i),k=Mt($.start_date,$.end_date,n,s,i);if(!P||!k)return null;const{sourceEdge:E,targetEdge:I}=V0(S.type),M=E==="start"?P.left:P.left+P.width,B=I==="start"?k.left:k.left+k.width,C=L.top+L.height/2,R=T.top+T.height/2,A=U0(M,C,B,R,S.type);return{...S,path:A,fromX:M,fromY:C,toX:B,toY:R,sourceColor:j.color}}).filter(S=>S!==null),[v,p,u,n,s,i]),m=g.useMemo(()=>{const S=new Map;return t.forEach(N=>{(N.phases??[]).forEach(D=>{S.set(`phase-${D.id}`,D.name);const L=T=>{(T??[]).forEach(j=>{var $;S.set(`subphase-${j.id}`,j.name),($=j.children)!=null&&$.length&&L(j.children)})};L(D.children)})}),S},[t]),x=g.useCallback((S,N)=>{if(!N)return;const D=m.get(`${N.fromType}-${N.fromId}`)||"Unknown",L=m.get(`${N.toType}-${N.toId}`)||"Unknown";h({id:N.id,type:N.type,fromId:N.fromId,toId:N.toId,fromType:N.fromType,toType:N.toType,projectId:N.projectId,fromName:D,toName:L,x:S.clientX,y:S.clientY})},[m]),w=g.useCallback(()=>{h(null)},[]),b=g.useCallback(async()=>{if(f)try{const S=t.map(D=>{if(D.id!==f.projectId)return D;if(f.toType==="phase")return{...D,phases:(D.phases??[]).map(L=>{if(L.id!==f.toId)return L;const T=(L.dependencies??[]).filter(j=>!(j.id===f.fromId&&j.type===f.type));return{...L,dependencies:T}})};{const L=T=>T.map(j=>{var $;if(j.id===f.toId){const P=(j.dependencies??[]).filter(k=>!(k.id===f.fromId&&k.type===f.type));return{...j,dependencies:P}}return($=j.children)!=null&&$.length?{...j,children:L(j.children)}:j});return{...D,phases:(D.phases??[]).map(T=>({...T,children:L(T.children??[])}))}}});o(S),h(null);const N=t.find(D=>D.id===f.projectId);if(!N)return;if(f.toType==="phase"){const D=(N.phases??[]).find(L=>L.id===f.toId);if(D){const L=(D.dependencies??[]).filter(T=>!(T.id===f.fromId&&T.type===f.type));await ia(f.toId,{start_date:D.start_date,end_date:D.end_date,dependencies:L})}}else{const D=T=>{var j;for(const $ of T){if($.id===f.toId)return $;if((j=$.children)!=null&&j.length){const P=D($.children);if(P)return P}}return null};let L=null;for(const T of N.phases??[])if(L=D(T.children??[]),L)break;if(L){const T=(L.dependencies??[]).filter(j=>!(j.id===f.fromId&&j.type===f.type));await Ps(f.toId,{start_date:L.start_date,end_date:L.end_date,dependencies:T})}}}catch(S){console.error("Failed to delete dependency:",S);const N=await Ke();o(N)}},[f,t,o]);return a.jsxs(a.Fragment,{children:[a.jsx("svg",{ref:l,className:Mi.layer,style:y.length===0?{display:"none"}:void 0,children:y.map(S=>{if(!S)return null;const N=W0[S.type],D=S.sourceColor||"#ec4899",L=`arrow-${S.id}`;return a.jsxs("g",{className:Mi.dependency,children:[a.jsx("defs",{children:a.jsx("marker",{id:L,markerWidth:"6",markerHeight:"5",refX:"5",refY:"2.5",orient:"auto",markerUnits:"strokeWidth",children:a.jsx("polygon",{points:"0 0, 6 2.5, 0 5",fill:D})})}),a.jsx("path",{d:S.path,stroke:D,strokeWidth:"1.5",fill:"none",strokeLinejoin:"round",strokeLinecap:"round",strokeDasharray:N.dashArray,markerEnd:`url(#${L})`,className:Mi.arrow}),a.jsx("path",{d:S.path,stroke:"transparent",strokeWidth:"10",fill:"none",className:Mi.hitArea,"data-dependency-id":S.id,onClick:T=>x(T,S)})]},S.id)})}),a.jsx(_N,{visible:f!==null,x:(f==null?void 0:f.x)??0,y:(f==null?void 0:f.y)??0,dependencyType:(f==null?void 0:f.type)??"FS",fromName:(f==null?void 0:f.fromName)??"",toName:(f==null?void 0:f.toName)??"",onClose:w,onDelete:b})]})}),SN="_lagIndicator_1so8k_5",kN="_positive_1so8k_18",NN="_negative_1so8k_23",bN="_resizeIndicator_1so8k_29",CN="_duration_1so8k_47",DN="_date_1so8k_52",ma={lagIndicator:SN,positive:kN,negative:NN,resizeIndicator:bN,duration:CN,date:DN};function $N(e){const t=new Date(e),n=t.getDate(),s=t.toLocaleString("en-GB",{month:"short"}),r=t.getFullYear();return`${n} ${s} ${r}`}const EN=g.memo(function({visible:t,left:n,top:s,type:r,lagDays:i,date:o,duration:l,edge:c}){if(!t)return null;if(r==="drag"&&i!==void 0){const d=i>=0,f=d?`+${i}d`:`${i}d`;return a.jsx("div",{className:`${ma.lagIndicator} ${d?ma.positive:ma.negative}`,style:{left:n,top:s},children:f})}if(r==="resize"&&o){const d=c==="left"?"translateX(-100%)":"translateX(0)";return a.jsxs("div",{className:ma.resizeIndicator,style:{left:n,top:s,transform:d},children:[a.jsxs("span",{className:ma.duration,children:[l,"d"]}),a.jsx("span",{className:ma.date,children:$N(o)})]})}return null}),TN="_overlay_yits3_3",PN="_phantomRow_yits3_11",MN="_phantomBar_yits3_22",IN="_barLabel_yits3_40",LN="_indicator_yits3_51",AN="_positive_yits3_70",RN="_negative_yits3_74",BN="_lag_yits3_78",FN="_depType_yits3_82",ON="_arrowSvg_yits3_90",Yt={overlay:TN,phantomRow:PN,phantomBar:MN,barLabel:IN,indicator:LN,positive:AN,negative:RN,lag:BN,depType:FN,arrowSvg:ON};function HN(e,t,n){const s=t==="phase"?"data-phase-id":"data-subphase-id",r=n.querySelector(`[${s}="${e}"]`);if(!r)return null;const i=r.querySelector('[class*="phaseBar"], [class*="bar"]');if(!i)return null;const o=i.getBoundingClientRect(),l=n.getBoundingClientRect();return{left:o.left-l.left+n.scrollLeft,width:o.width,top:r.offsetTop,height:r.clientHeight||32}}function qN(e,t){for(const n of e){const s=jg(n.children||[],t);if(s)return s}return null}function jg(e,t){for(const n of e){if(n.id===t)return n;if(n.children&&n.children.length>0){const s=jg(n.children,t);if(s)return s}}return null}function Ll(e){const t=e.split("T")[0];return new Date(t+"T12:00:00")}function zN({cells:e,cellWidth:t,viewMode:n,timelineRef:s,containerWidth:r,containerHeight:i,phantomRowTop:o}){const l=Z(j=>j.phantomSiblingMode),c=Z(j=>j.updatePhantomPosition),d=F(j=>j.projects),{completePhantom:f}=ii(),[h,p]=g.useState(null);g.useEffect(()=>{if(!l||!s.current){p(null);return}const{sourceId:j,type:$}=l,P=()=>{if(s.current){const E=HN(j,$,s.current);p(E)}},k=requestAnimationFrame(()=>{P(),requestAnimationFrame(P)});return()=>cancelAnimationFrame(k)},[l,s]);const _=g.useCallback(j=>{if(!l||!s.current)return;const{siblingDurationDays:$}=l,P=s.current.getBoundingClientRect(),k=s.current.scrollLeft,E=j.clientX-P.left+k;if(e.length===0)return;const I=new Date(e[0].date);I.setHours(0,0,0,0);const M=e[e.length-1],B=new Date(M.date);B.setHours(23,59,59,999);const C=e.length*t,A=(B.getTime()-I.getTime())/C,H=($-1)*24*60*60*1e3,z=H/A/2,K=E-z,Q=Math.max(0,Math.min(K,C-H/A)),Y=I.getTime()+Q*A,J=new Date(Y);J.setHours(0,0,0,0);const ne=En(J,$-1);c(be(J,"yyyy-MM-dd"),be(ne,"yyyy-MM-dd"))},[l,s,e,t,c]),v=g.useCallback(j=>{if(!l)return;const $=j.target;($.closest(`.${Yt.phantomRow}`)||$.closest(`.${Yt.phantomBar}`))&&(j.preventDefault(),j.stopPropagation(),f())},[l,f]);g.useEffect(()=>{if(!l||!s.current)return;const j=s.current;return j.addEventListener("mousemove",_),j.addEventListener("click",v,!0),()=>{j.removeEventListener("mousemove",_),j.removeEventListener("click",v,!0)}},[l,_,v,s]);const u=g.useMemo(()=>{if(!l)return null;const{phantomStart:j,phantomEnd:$,phantomColor:P,type:k,dependencyType:E,sourceId:I,projectId:M}=l,B=Mt(j,$,e,t,n);if(!B)return null;const C=d.find(Q=>Q.id===M);if(!C)return null;let R;if(k==="phase"?R=(C.phases||[]).find(Q=>Q.id===I):R=qN(C.phases||[],I)||void 0,!R)return null;const A=Ll(j),H=Ll(R.start_date),z=Ll(R.end_date);let K;if(E==="SS")K=Ns(A,H);else{const Q=En(z,1);K=Ns(A,Q)}return{barPosition:B,phantomColor:P,type:k,dependencyType:E,lagDays:K,sourceBar:h}},[l,e,t,n,d,h]);if(!l||!u||!u.sourceBar)return null;const{barPosition:y,phantomColor:m,type:x,dependencyType:w,lagDays:b,sourceBar:S}=u,N=b>=0?`+${b}d`:`${b}d`,D=o??S.top+S.height,L=24,T=D+(32-L)/2;return a.jsxs("div",{className:Yt.overlay,children:[a.jsx("div",{className:Yt.phantomRow,style:{top:D,width:r},onClick:j=>{j.stopPropagation(),f()}}),a.jsx("div",{className:Yt.phantomBar,style:{left:y.left,top:T,width:y.width,height:L,backgroundColor:`${m}80`,borderColor:m},onClick:j=>{j.stopPropagation(),f()},children:a.jsxs("span",{className:Yt.barLabel,children:["New ",x==="phase"?"Phase":"Subphase"]})}),a.jsxs("div",{className:`${Yt.indicator} ${b>=0?Yt.positive:Yt.negative}`,style:{left:y.left+y.width/2,top:D-28,borderColor:m},children:[a.jsx("span",{className:Yt.lag,children:N}),a.jsx("span",{className:Yt.depType,children:w})]}),a.jsxs("svg",{className:Yt.arrowSvg,width:r,height:i,children:[a.jsx("defs",{children:a.jsx("marker",{id:"phantomArrowhead",markerWidth:"8",markerHeight:"6",refX:"7",refY:"3",orient:"auto",markerUnits:"strokeWidth",children:a.jsx("path",{d:"M0,0 L0,6 L8,3 z",fill:m})})}),a.jsx("path",{d:WN(S,{left:y.left,top:T+L/2},w),stroke:m,strokeWidth:"2",fill:"none",strokeDasharray:"5,3",markerEnd:"url(#phantomArrowhead)",opacity:"0.8"})]})]})}function WN(e,t,n){const r=e.top+e.height/2;let i;n==="SS"?i=e.left:i=e.left+e.width;const o=t.left,l=t.top;if(n==="SS"){const c=Math.min(i,o)-15;return`M${i},${r} H${c} V${l} H${o}`}else if(o>i+15){const c=i+(o-i)/2;return`M${i},${r} H${c} V${l} H${o}`}else{const c=i+15,d=Math.max(r,l)+20;return`M${i},${r} H${c} V${d} H${o-15} V${l} H${o}`}}const UN="_body_rjtw9_1",VN="_content_rjtw9_25",GN="_grid_rjtw9_32",QN="_gridCell_rjtw9_61",YN="_weekend_rjtw9_69",XN="_holiday_rjtw9_73",KN="_rows_rjtw9_77",Zn={body:UN,content:VN,grid:GN,gridCell:QN,weekend:YN,holiday:XN,rows:KN},ZN=g.forwardRef(function({cells:t,projects:n,cellWidth:s,totalWidth:r,viewMode:i},o){const l=F(w=>w.expandedProjects),c=F(w=>w.expandedPhases),d=F(w=>w.expandedSubphases),f=Z(w=>w.dragIndicator),h=Z(w=>w.phantomSiblingMode),p=g.useRef(null),_=w=>{p.current=w,typeof o=="function"?o(w):o&&(o.current=w)},v=g.useMemo(()=>q0(t,s),[t,s]),u=h?{projectId:h.projectId,sourceId:h.sourceId,type:h.type,parentId:h.parentId,parentType:h.parentType}:null,y=g.useMemo(()=>Q0(n,l,c,d,u),[n,l,c,d,u]),m=i==="week"||i==="month",x=y.totalHeight+100;return a.jsx("div",{ref:_,className:Zn.body,children:a.jsxs("div",{className:Zn.content,style:{width:r,"--cell-width":`${s}px`},children:[a.jsxs("div",{className:Zn.grid,children:[m&&t.map((w,b)=>w.isWeekend?a.jsx("div",{className:`${Zn.gridCell} ${Zn.weekend}`,style:{left:b*s,width:s}},`weekend-${b}`):null),m&&t.map((w,b)=>w.isBankHoliday?a.jsx("div",{className:`${Zn.gridCell} ${Zn.holiday}`,style:{left:b*s,width:s}},`holiday-${b}`):null)]}),v!==null&&a.jsx(rN,{position:v}),a.jsx("div",{className:Zn.rows,children:n.map(w=>a.jsx(eN,{project:w,cells:t,cellWidth:s,isExpanded:l.has(w.id),expandedPhases:c,expandedSubphases:d},w.id))}),a.jsx(jN,{projects:n,cells:t,cellWidth:s,rowPositions:y.positions}),h&&a.jsx(zN,{cells:t,cellWidth:s,viewMode:i,timelineRef:p,containerWidth:r,containerHeight:x,phantomRowTop:y.phantomRowTop}),a.jsx(EN,{visible:f.visible,left:f.left,top:f.top,type:f.type,lagDays:f.lagDays,date:f.date,duration:f.duration,edge:f.edge})]})})}),JN="_timeline_tdbou_1",eb="_horizontalScroll_tdbou_9",tb="_scrollContent_tdbou_32",Al={timeline:JN,horizontalScroll:eb,scrollContent:tb},nb=200,sb=g.forwardRef(function({cells:t,headers:n,projects:s,cellWidth:r,viewMode:i},o){const l=t.length*r,c=g.useRef(null),d=Z($=>$.scrollToTodayTrigger),f=Z($=>$.scrollToDateTrigger),h=Z($=>$.clearScrollToDateTrigger),p=Z($=>$.zoomTrigger),_=Z($=>$.clearZoomTrigger),v=F($=>$.timelineScrollLeft),u=F($=>$.setTimelineScrollLeft),y=g.useRef(!1),m=g.useRef(null),x=g.useRef(i),w=g.useRef(r),b=g.useRef(null),S=g.useRef(0);lw({containerRef:c,cellWidth:r});const N=g.useCallback(()=>{const $=c.current;if(!$||t.length===0)return null;const P=$.scrollLeft,k=Math.floor(P/r),E=t[Math.min(k,t.length-1)];return(E==null?void 0:E.dateStr)||null},[t,r]),D=g.useCallback(()=>{const $=c.current;if(!$||t.length===0)return null;const P=$.scrollLeft+$.clientWidth/2,k=Math.floor(P/r),E=t[Math.min(k,t.length-1)];return(E==null?void 0:E.dateStr)||null},[t,r]),L=g.useCallback($=>{const P=c.current;if(!P||t.length===0)return;let k=t.findIndex(I=>I.dateStr>=$);k===-1?k=t.length-1:k>0&&t[k].dateStr!==$&&(k=k-1);const E=k*r;P.scrollLeft=E},[t,r]),T=g.useCallback($=>{const P=c.current;if(!P||t.length===0)return;let k=t.findIndex(M=>M.dateStr>=$);k===-1&&(k=t.length-1);const I=k*r+r/2-P.clientWidth/2;P.scrollLeft=Math.max(0,I)},[t,r]);g.useEffect(()=>{const $=c.current;!$||y.current||(v>0?requestAnimationFrame(()=>{$.scrollLeft=v,y.current=!0,b.current=N()}):y.current=!0)},[v,N]),g.useEffect(()=>{if(!p||p.timestamp===S.current)return;S.current=p.timestamp;const $=c.current;if(!$){_();return}const P=D();_(),P&&requestAnimationFrame(()=>{T(P),u($.scrollLeft)})},[p,_,D,T,u]),g.useEffect(()=>{x.current!==i&&y.current&&b.current&&requestAnimationFrame(()=>{L(b.current);const P=c.current;P&&u(P.scrollLeft)}),x.current=i,w.current=r},[i,r,L,u]);const j=g.useCallback(()=>{const $=c.current;!$||!y.current||(b.current=N(),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{u($.scrollLeft)},nb))},[u,N]);return g.useEffect(()=>{if(d===0)return;const $=c.current;if(!$)return;const P=t.findIndex(k=>k.isToday);if(P!==-1){const k=$.clientWidth,E=P*r,I=Math.max(0,E-k/2+r/2);$.scrollTo({left:I,behavior:"smooth"})}},[d,t,r]),g.useEffect(()=>{if(!f)return;const $=c.current;if(!$)return;const P=f.date;let k=t.findIndex(E=>E.dateStr>=P);if(k===-1&&(k=t.length-1),k!==-1){const E=$.clientWidth,I=k*r,M=Math.max(0,I-E/4);$.scrollTo({left:M,behavior:"smooth"})}h()},[f,t,r,h]),g.useEffect(()=>()=>{m.current&&clearTimeout(m.current)},[]),a.jsx("div",{className:Al.timeline,children:a.jsx("div",{ref:c,className:Al.horizontalScroll,onScroll:j,children:a.jsxs("div",{className:Al.scrollContent,style:{width:l},children:[a.jsx(oi,{headers:n,cells:t,cellWidth:r,totalWidth:l,viewMode:i}),a.jsx(ZN,{ref:o,cells:t,projects:s,cellWidth:r,totalWidth:l,viewMode:i})]})})})});function ab(e,t){const n=g.useCallback((s,r)=>{s==="project"&&t.current?t.current.scrollTop=r:s==="timeline"&&e.current&&(e.current.scrollTop=r)},[e,t]);g.useEffect(()=>{const s=e.current,r=t.current;if(!s||!r)return;let i=!1;const o=()=>{i||(i=!0,n("project",s.scrollTop),requestAnimationFrame(()=>{i=!1}))},l=()=>{i||(i=!0,n("timeline",r.scrollTop),requestAnimationFrame(()=>{i=!1}))};return s.addEventListener("scroll",o,{passive:!0}),r.addEventListener("scroll",l,{passive:!0}),()=>{s.removeEventListener("scroll",o),r.removeEventListener("scroll",l)}},[e,t,n])}const rb="_container_7cm3p_1",ib="_resizer_7cm3p_8",Kf={container:rb,resizer:ib};function Zf(){const e=g.useRef(null),t=g.useRef(null),[n,s]=g.useState(320),r=F(u=>u.projects),i=F(u=>u.currentSite),o=F(u=>u.viewMode),l=F(u=>u.currentDate),c=F(u=>u.cellWidth),d=F(u=>u.bankHolidayDates),f=F(u=>u.bankHolidays),h=g.useMemo(()=>r.filter(u=>u.site_id===(i==null?void 0:i.id)&&!u.archived).sort((u,y)=>u.confirmed!==y.confirmed?u.confirmed?-1:1:u.name.localeCompare(y.name)),[r,i]),p=g.useMemo(()=>ai(l,o,d,f),[l,o,d,f]),_=g.useMemo(()=>ri(p,o),[p,o]);ab(e,t);const v=u=>{u.preventDefault();const y=u.clientX,m=n,x=b=>{const S=b.clientX-y,N=Math.max(200,Math.min(600,m+S));s(N)},w=()=>{document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",w),document.body.style.cursor="",document.body.style.userSelect=""};document.addEventListener("mousemove",x),document.addEventListener("mouseup",w),document.body.style.cursor="col-resize",document.body.style.userSelect="none"};return a.jsxs("div",{className:Kf.container,children:[a.jsx(nk,{ref:e,projects:h,width:n}),a.jsx("div",{className:Kf.resizer,onMouseDown:v}),a.jsx(sb,{ref:t,cells:p,headers:_,projects:h,cellWidth:c,viewMode:o})]})}const ob="_tooltip_1u2qd_3",lb="_title_1u2qd_28",cb="_row_1u2qd_37",db="_label_1u2qd_46",Ct={tooltip:ob,title:lb,row:cb,label:db};function Jf(e,t,n){const s=Gn(e),r=Gn(t),i=Ns(r,s)+1;let o=0,l=0;try{const c=yx({start:s,end:r});for(const d of c){const f=be(d,"yyyy-MM-dd"),h=n.has(f),p=Jp(d);h?l++:p||o++}}catch{o=i}return{totalDays:i,workDays:o,holidays:l}}function Co(e){if(!e)return{completion:null,isCalculated:!1};const t=e.children??[];let n=!1;for(const s of t){const r=Co(s);if(r&&r.completion!==null){n=!0;break}}if(n){let s=0,r=0;for(const i of t){const o=Co(i),l=Gn(i.start_date),c=Gn(i.end_date),d=Math.max(1,Ns(c,l)+1),f=o.completion??0;s+=f*d,r+=d}if(r>0)return{completion:Math.round(s/r),isCalculated:!0}}return{completion:e.completion??null,isCalculated:!1}}function ub(e,t){const n=Gn(e),s=Gn(t);return`${be(n,"MMM d, yyyy")} - ${be(s,"MMM d, yyyy")}`}function fb(e,t){return e.find(n=>(n.phases??[]).some(s=>s.id===t))??null}function hb(e,t){for(const n of e){const s=(n.phases??[]).find(r=>r.id===t);if(s)return s}return null}function mb(e,t){for(const n of e)for(const s of n.phases??[]){const r=Sg(s.children??[],t);if(r)return{subphase:r,project:n,parentPhase:s}}return null}function Sg(e,t){var n;for(const s of e){if(s.id===t)return s;if((n=s.children)!=null&&n.length){const r=Sg(s.children,t);if(r)return r}}return null}function pb(e){var n,s,r;let t=e;for(;t;){if(t.classList.contains("linkZone")||(s=(n=t.className)==null?void 0:n.includes)!=null&&s.call(n,"linkZone")||(r=t.getAttribute("title"))!=null&&r.includes("linking"))return!0;if(t.dataset.phaseId||t.dataset.subphaseId)break;t=t.parentElement}return!1}function gb(){const[e,t]=g.useState(null),[n,s]=g.useState(!1),r=F(h=>h.projects),i=F(h=>h.bankHolidayDates),o=g.useRef(null);g.useEffect(()=>{const h=_=>{_.key==="Shift"&&s(!0)},p=_=>{_.key==="Shift"&&(s(!1),t(null),o.current=null)};return window.addEventListener("keydown",h),window.addEventListener("keyup",p),()=>{window.removeEventListener("keydown",h),window.removeEventListener("keyup",p)}},[]);const l=g.useCallback((h,p,_)=>{const v=hb(r,h),u=fb(r,h);if(v&&u){const{totalDays:y,workDays:m,holidays:x}=Jf(v.start_date,v.end_date,i),w=Co(v);t({type:"phase",title:v.name,projectName:u.name,startDate:v.start_date,endDate:v.end_date,completion:w.completion,isCalculatedCompletion:w.isCalculated,workDays:m,totalDays:y,holidays:x,x:p,y:_})}},[r,i]),c=g.useCallback((h,p,_)=>{const v=mb(r,h);if(v){const{subphase:u,project:y,parentPhase:m}=v,{totalDays:x,workDays:w,holidays:b}=Jf(u.start_date,u.end_date,i),S=Co(u);t({type:"subphase",title:u.name,projectName:y.name,parentName:m.name,startDate:u.start_date,endDate:u.end_date,completion:S.completion,isCalculatedCompletion:S.isCalculated,workDays:w,totalDays:x,holidays:b,x:p,y:_})}},[r,i]);if(g.useEffect(()=>{const h=p=>{if(!n){e&&(t(null),o.current=null);return}const _=p.target;if(pb(_)){t(null),o.current=null;return}const v=_.closest("[data-phase-id], [data-subphase-id]");if(!v){t(null),o.current=null;return}if(!(window.getComputedStyle(v).position==="absolute"||v.classList.toString().includes("bar")||v.classList.toString().includes("Bar"))){t(null),o.current=null;return}const m=v.getBoundingClientRect();if(p.clientX<m.left||p.clientX>m.right||p.clientY<m.top||p.clientY>m.bottom){t(null),o.current=null;return}if(v===o.current&&e){t(b=>b?{...b,x:p.clientX,y:p.clientY}:null);return}o.current=v;const x=v.dataset.phaseId,w=v.dataset.subphaseId;x?l(parseInt(x),p.clientX,p.clientY):w&&c(parseInt(w),p.clientX,p.clientY)};return document.addEventListener("mousemove",h),()=>{document.removeEventListener("mousemove",h)}},[n,e,l,c]),!e||!n)return null;const d=e.completion!==null?`${e.completion}%${e.isCalculatedCompletion?" (calc)":""}`:"",f={left:Math.min(e.x+15,window.innerWidth-280),top:Math.min(e.y+15,window.innerHeight-200)};return a.jsxs("div",{className:Ct.tooltip,style:f,children:[a.jsx("div",{className:Ct.title,children:e.title}),a.jsxs("div",{className:Ct.row,children:[a.jsx("span",{className:Ct.label,children:"Project:"}),a.jsx("span",{children:e.projectName})]}),e.parentName&&a.jsxs("div",{className:Ct.row,children:[a.jsx("span",{className:Ct.label,children:"Parent:"}),a.jsx("span",{children:e.parentName})]}),a.jsxs("div",{className:Ct.row,children:[a.jsx("span",{className:Ct.label,children:"Period:"}),a.jsx("span",{children:ub(e.startDate,e.endDate)})]}),a.jsxs("div",{className:Ct.row,children:[a.jsx("span",{className:Ct.label,children:"Completion:"}),a.jsx("span",{children:d})]}),a.jsxs("div",{className:Ct.row,children:[a.jsx("span",{className:Ct.label,children:"Work days:"}),a.jsxs("span",{children:[e.workDays," days",e.holidays>0&&` (excl. ${e.holidays} hol.)`]})]}),a.jsxs("div",{className:Ct.row,children:[a.jsx("span",{className:Ct.label,children:"Total:"}),a.jsxs("span",{children:[e.totalDays," days"]})]})]})}const _b="_body_1qodq_3",yb="_content_1qodq_23",vb="_grid_1qodq_29",xb="_gridCell_1qodq_56",wb="_weekend_1qodq_64",jb="_holiday_1qodq_68",Sb="_today_1qodq_72",kb="_rows_1qodq_78",Nb="_staffWrapper_1qodq_84",bb="_bankHolidaysWrapper_1qodq_89",Cb="_row_1qodq_78",Db="_bar_1qodq_100",$b="_vacationBar_1qodq_118",Eb="_assignmentBar_1qodq_124",Tb="_barLabel_1qodq_128",Pb="_detailBar_1qodq_140",Mb="_vacationDetailBar_1qodq_146",Ib="_assignmentDetailBar_1qodq_151",Lb="_holidayDetailBar_1qodq_155",Ab="_customHolidayBar_1qodq_160",Rb="_workloadCell_1qodq_166",Bb="_overloaded_1qodq_176",Fb="_vacation_1qodq_118",Ob="_conflict_1qodq_182",Hb="_workloadIndicator_1qodq_188",qb="_full_1qodq_203",zb="_partial_1qodq_208",fe={body:_b,content:yb,grid:vb,gridCell:xb,weekend:wb,holiday:jb,today:Sb,rows:kb,staffWrapper:Nb,bankHolidaysWrapper:bb,row:Cb,bar:Db,vacationBar:$b,assignmentBar:Eb,barLabel:Tb,detailBar:Pb,vacationDetailBar:Mb,assignmentDetailBar:Ib,holidayDetailBar:Lb,customHolidayBar:Ab,workloadCell:Rb,overloaded:Bb,vacation:Fb,conflict:Ob,workloadIndicator:Hb,full:qb,partial:zb},Wb=g.forwardRef(function({staff:t,assignmentsMap:n,vacationsMap:s,rowHeights:r,expandedStaff:i,expandedBankHolidays:o,cells:l,cellWidth:c,totalWidth:d,viewMode:f},h){const p=F(y=>y.bankHolidays),_=F(y=>y.currentUser),v=f==="week"||f==="month",u=y=>_?_.role==="admin"||_.role==="superuser"?!0:_.id===y:!1;return a.jsx("div",{ref:h,className:fe.body,children:a.jsxs("div",{className:fe.content,style:{width:d,"--cell-width":`${c}px`},children:[a.jsxs("div",{className:fe.grid,children:[v&&l.map((y,m)=>y.isWeekend?a.jsx("div",{className:`${fe.gridCell} ${fe.weekend}`,style:{left:m*c,width:c}},`weekend-${m}`):null),v&&l.map((y,m)=>y.isBankHoliday?a.jsx("div",{className:`${fe.gridCell} ${fe.holiday}`,style:{left:m*c,width:c}},`holiday-${m}`):null),l.map((y,m)=>y.isToday?a.jsx("div",{className:`${fe.gridCell} ${fe.today}`,style:{left:m*c,width:c}},`today-${m}`):null)]}),a.jsxs("div",{className:fe.rows,children:[t.map(y=>{const m=i.has(y.id),x=s.get(y.id)||[],w=n.get(y.id)||[],b=u(y.id);return a.jsxs("div",{className:fe.staffWrapper,children:[a.jsx(Ub,{staffMember:y,assignments:w,vacations:x,rowHeight:r.get(y.id)||44,cells:l,cellWidth:c,viewMode:f}),m&&a.jsxs(a.Fragment,{children:[x.map(S=>a.jsx(Vb,{vacation:S,cells:l,cellWidth:c,viewMode:f},`v-${S.id}`)),b&&a.jsx("div",{className:fe.row,style:{height:qn}}),w.map(S=>a.jsx(Gb,{assignment:S,cells:l,cellWidth:c,viewMode:f},`a-${S.id}-${S.level}`)),w.length===0&&x.length===0&&!b&&a.jsx("div",{className:fe.row,style:{height:qn}})]})]},y.id)}),a.jsx(Qb,{isExpanded:o,holidays:p,cells:l,cellWidth:c,viewMode:f})]})]})})});function Ub({assignments:e,vacations:t,rowHeight:n,cells:s,cellWidth:r,viewMode:i}){const{openVacationModal:o}=Z(),l=J0(e,t,s),c=i==="week"||i==="month",d=g.useMemo(()=>{const p=[];e.forEach(u=>{let y=u.projectName;u.phaseName&&(y+=` - ${u.phaseName}`),y+=` (${u.allocation}%)`,p.push({type:"assignment",id:u.id,startDate:u.start_date,endDate:u.end_date,label:y,allocation:u.allocation,data:u})}),t.forEach(u=>{p.push({type:"vacation",id:u.id,startDate:u.start_date,endDate:u.end_date,label:u.description||"Vacation",data:u})}),p.sort((u,y)=>u.startDate.localeCompare(y.startDate));const _=[];p.forEach(u=>{let y=!1;for(const m of _)if(u.startDate>m.end){m.end=u.endDate,m.items.push(u),y=!0;break}y||_.push({end:u.endDate,items:[u]})});const v=[];return _.forEach((u,y)=>{u.items.forEach(m=>{const x=Mt(m.startDate,m.endDate,s,r,i);x&&v.push({type:m.type,id:m.id,left:x.left,width:x.width,top:Gc+y*(Vc+kg),label:m.label,allocation:m.allocation,data:m.data})})}),v},[e,t,s,r,i]),f=p=>{p.type==="vacation"&&o(p.data)},h=n-Qc;return a.jsxs("div",{className:fe.row,style:{height:n},children:[c&&l.map((p,_)=>p.total===0&&!p.isOnVacation?null:a.jsx("div",{className:`${fe.workloadCell} ${fe[p.state]}`,style:{left:_*r,width:r,top:h,height:Qc,...tw(p)},title:ew(p),children:a.jsx("div",{className:`${fe.workloadIndicator} ${fe[p.state]}`,children:p.state==="vacation"?"OFF":p.state==="conflict"?"0%":`${p.total}%`})},`workload-${_}`)),d.map((p,_)=>a.jsx("div",{className:`${fe.bar} ${p.type==="vacation"?fe.vacationBar:fe.assignmentBar}`,style:{left:p.left,width:p.width,top:p.top,height:Vc},title:p.label,onClick:()=>f(p),children:a.jsx("span",{className:fe.barLabel,children:p.label})},`${p.type}-${p.id}-${_}`))]})}function Vb({vacation:e,cells:t,cellWidth:n,viewMode:s}){const r=g.useMemo(()=>Mt(e.start_date,e.end_date,t,n,s),[e,t,n,s]);return r?a.jsx("div",{className:fe.row,style:{height:qn},children:a.jsx("div",{className:`${fe.detailBar} ${fe.vacationDetailBar}`,style:{left:r.left,width:r.width,height:20,top:6},title:e.description||"Vacation"})}):a.jsx("div",{className:fe.row,style:{height:qn}})}function Gb({assignment:e,cells:t,cellWidth:n,viewMode:s}){const r=g.useMemo(()=>Mt(e.start_date,e.end_date,t,n,s),[e,t,n,s]);return r?a.jsx("div",{className:fe.row,style:{height:qn},children:a.jsx("div",{className:`${fe.detailBar} ${fe.assignmentDetailBar}`,style:{left:r.left,width:r.width,height:20,top:6},title:`${e.projectName} (${e.allocation}%)`})}):a.jsx("div",{className:fe.row,style:{height:qn}})}function Qb({isExpanded:e,holidays:t,cells:n,cellWidth:s,viewMode:r}){const o=F(c=>c.currentUser),l=(o==null?void 0:o.role)==="admin"||(o==null?void 0:o.role)==="superuser";return a.jsxs("div",{className:fe.bankHolidaysWrapper,children:[a.jsx("div",{className:fe.row,style:{height:44}}),e&&a.jsxs(a.Fragment,{children:[t.map(c=>{const d=Mt(c.date,c.end_date||c.date,n,s,r);return a.jsx("div",{className:fe.row,style:{height:qn},children:d&&a.jsx("div",{className:`${fe.detailBar} ${fe.holidayDetailBar} ${c.is_custom?fe.customHolidayBar:""}`,style:{left:d.left,width:d.width,height:20,top:6},title:c.name})},c.id)}),t.length===0&&a.jsx("div",{className:fe.row,style:{height:qn}}),l&&a.jsx("div",{className:fe.row,style:{height:qn}})]})]})}const Yb="_container_5ioyr_3",Xb="_panel_5ioyr_11",Kb="_panelHeader_5ioyr_20",Zb="_headerLeft_5ioyr_31",Jb="_headerTitle_5ioyr_37",eC="_headerCount_5ioyr_43",tC="_panelBody_5ioyr_51",nC="_empty_5ioyr_71",sC="_staffWrapper_5ioyr_83",aC="_bankHolidaysWrapper_5ioyr_88",rC="_staffRow_5ioyr_94",iC="_expandIcon_5ioyr_109",oC="_expanded_5ioyr_120",lC="_status_5ioyr_124",cC="_available_5ioyr_131",dC="_overloaded_5ioyr_135",uC="_staffInfo_5ioyr_139",fC="_staffName_5ioyr_145",hC="_staffMeta_5ioyr_154",mC="_overloadedText_5ioyr_159",pC="_rowActions_5ioyr_164",gC="_iconBtn_5ioyr_171",_C="_expandedContent_5ioyr_193",yC="_detailRow_5ioyr_198",vC="_clickable_5ioyr_212",xC="_detailType_5ioyr_221",wC="_vacation_5ioyr_230",jC="_allocation_5ioyr_235",SC="_bankHoliday_5ioyr_88",kC="_detailName_5ioyr_247",NC="_dateBadge_5ioyr_255",bC="_deleteBtn_5ioyr_261",CC="_addRow_5ioyr_282",DC="_addIcon_5ioyr_291",$C="_addText_5ioyr_300",EC="_vacationRow_5ioyr_305",TC="_customHoliday_5ioyr_310",PC="_deleteAction_5ioyr_315",MC="_bankHolidaysRow_5ioyr_342",IC="_bankHolidayStatus_5ioyr_347",LC="_noAssignments_5ioyr_351",AC="_timeline_5ioyr_357",RC="_timelineScroll_5ioyr_365",BC="_timelineContent_5ioyr_387",FC="_confirmOverlay_5ioyr_395",OC="_confirmModal_5ioyr_409",HC="_confirmIcon_5ioyr_419",qC="_confirmTitle_5ioyr_431",zC="_confirmText_5ioyr_438",WC="_confirmWarning_5ioyr_449",UC="_confirmActions_5ioyr_455",VC="_confirmCancel_5ioyr_461",GC="_confirmDelete_5ioyr_462",X={container:Yb,panel:Xb,panelHeader:Kb,headerLeft:Zb,headerTitle:Jb,headerCount:eC,panelBody:tC,empty:nC,staffWrapper:sC,bankHolidaysWrapper:aC,staffRow:rC,expandIcon:iC,expanded:oC,status:lC,available:cC,overloaded:dC,staffInfo:uC,staffName:fC,staffMeta:hC,overloadedText:mC,rowActions:pC,iconBtn:gC,expandedContent:_C,detailRow:yC,clickable:vC,detailType:xC,vacation:wC,allocation:jC,bankHoliday:SC,detailName:kC,dateBadge:NC,deleteBtn:bC,addRow:CC,addIcon:DC,addText:$C,vacationRow:EC,customHoliday:TC,deleteAction:PC,bankHolidaysRow:MC,bankHolidayStatus:IC,noAssignments:LC,timeline:AC,timelineScroll:RC,timelineContent:BC,confirmOverlay:FC,confirmModal:OC,confirmIcon:HC,confirmTitle:qC,confirmText:zC,confirmWarning:WC,confirmActions:UC,confirmCancel:VC,confirmDelete:GC};function QC({isExpanded:e,onToggle:t}){const n=F(_=>_.currentSite),s=F(_=>_.currentUser),r=F(_=>_.bankHolidays),i=F(_=>_.setBankHolidays),{openModal:o}=Z(),l=(s==null?void 0:s.role)==="admin"||(s==null?void 0:s.role)==="superuser",c=r.reduce((_,v)=>{const u=v.year||new Date(v.date).getFullYear();return _[u]||(_[u]=[]),_[u].push(v),_},{}),d=_=>new Date(_).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"}),f=()=>{if(r.length===0)return;const _=["BEGIN:VCALENDAR","VERSION:2.0","PRODID:-//Milestone//Bank Holidays//EN","CALSCALE:GREGORIAN","METHOD:PUBLISH"];r.forEach(m=>{const x=m.date.replace(/-/g,""),w=new Date(m.end_date||m.date);w.setDate(w.getDate()+1);const b=w.toISOString().split("T")[0].replace(/-/g,"");_.push("BEGIN:VEVENT"),_.push(`UID:bankholiday-${m.id}@milestone`),_.push(`DTSTART;VALUE=DATE:${x}`),_.push(`DTEND;VALUE=DATE:${b}`),_.push(`SUMMARY:${m.name.replace(/,/g,"\\,")}`),_.push("TRANSP:TRANSPARENT"),_.push("END:VEVENT")}),_.push("END:VCALENDAR");const v=new Blob([_.join(`\r
`)],{type:"text/calendar"}),u=URL.createObjectURL(v),y=document.createElement("a");y.href=u,y.download=`bank-holidays-${(n==null?void 0:n.name)||"site"}.ics`,document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(u)},h=()=>{o("customHoliday")},p=async _=>{if(n&&confirm("Delete this custom holiday?"))try{await Up(n.id,_);const v=await ks(n.id),u=$n(v);i(v,u)}catch(v){console.error("Failed to delete custom holiday:",v),alert("Failed to delete custom holiday")}};return a.jsxs("div",{className:X.bankHolidaysWrapper,children:[a.jsxs("div",{className:`${X.staffRow} ${X.bankHolidaysRow}`,onClick:t,children:[a.jsx("div",{className:`${X.expandIcon} ${e?X.expanded:""}`,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})}),a.jsx("div",{className:`${X.status} ${X.bankHolidayStatus}`}),a.jsxs("div",{className:X.staffInfo,children:[a.jsx("div",{className:X.staffName,children:"Bank Holidays"}),a.jsxs("div",{className:X.staffMeta,children:[a.jsx("span",{children:(n==null?void 0:n.name)||"Site"}),a.jsx("span",{children:"  "}),a.jsxs("span",{children:[r.length," holidays"]})]})]}),a.jsxs("div",{className:X.rowActions,onClick:_=>_.stopPropagation(),children:[a.jsx("button",{className:X.iconBtn,onClick:f,title:"Export to Outlook",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a.jsx("polyline",{points:"7 10 12 15 17 10"}),a.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]})}),l&&a.jsx("button",{className:X.iconBtn,onClick:h,title:"Add custom holiday",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})]}),e&&a.jsxs("div",{className:X.expandedContent,children:[Object.keys(c).sort().map(_=>c[Number(_)].map(v=>{const u=v.end_date&&v.end_date!==v.date?`${d(v.date)} - ${d(v.end_date)}`:d(v.date);return a.jsxs("div",{className:`${X.detailRow} ${v.is_custom?X.customHoliday:""}`,children:[a.jsx("span",{className:`${X.detailType} ${X.bankHoliday}`,children:v.is_custom?"Custom":"Holiday"}),a.jsx("span",{className:X.detailName,children:v.name}),a.jsx("span",{className:X.dateBadge,children:u}),l&&v.is_custom&&a.jsx("button",{className:X.deleteAction,onClick:y=>{y.stopPropagation(),p(v.id)},title:"Delete custom holiday",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},v.id)})),r.length===0&&a.jsx("div",{className:X.detailRow,children:a.jsx("span",{className:X.noAssignments,children:"No holidays loaded"})}),l&&a.jsxs("div",{className:`${X.detailRow} ${X.addRow}`,onClick:h,children:[a.jsx("span",{className:X.addIcon,children:a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),a.jsx("span",{className:X.addText,children:"Add custom holiday"})]})]})]})}const eh=44,qn=32,Vc=14,kg=2,Gc=4,Qc=18;function YC(){const e=g.useRef(null),t=g.useRef(null),n=F(A=>A.staff),s=F(A=>A.projects),r=F(A=>A.vacations),i=F(A=>A.setVacations),o=F(A=>A.currentSite),l=F(A=>A.currentUser),c=F(A=>A.viewMode),d=F(A=>A.currentDate),f=F(A=>A.cellWidth),h=F(A=>A.bankHolidayDates),p=F(A=>A.bankHolidays),{openVacationModal:_}=Z(),[v,u]=g.useState(new Set),[y,m]=g.useState(!1),[x,w]=g.useState(null),[b,S]=g.useState(!1);Jo(e,t);const N=g.useMemo(()=>n.filter(A=>A.site_id===(o==null?void 0:o.id)&&A.active!==!1).sort((A,H)=>A.name.localeCompare(H.name)),[n,o]),D=g.useMemo(()=>ai(d,c,h,p),[d,c,h,p]),L=g.useMemo(()=>ri(D,c),[D,c]),T=D.length*f,j=g.useMemo(()=>{const A=new Map;return N.forEach(H=>A.set(H.id,[])),s.forEach(H=>{var z,K;H.archived||((z=H.staffAssignments)==null||z.forEach(Q=>{const Y=A.get(Q.staff_id)||[];Y.push({...Q,projectName:H.name,projectId:H.id,level:"project"}),A.set(Q.staff_id,Y)}),(K=H.phases)==null||K.forEach(Q=>{var Y,J;(Y=Q.staffAssignments)==null||Y.forEach(ne=>{const O=A.get(ne.staff_id)||[];O.push({...ne,start_date:ne.start_date||Q.start_date,end_date:ne.end_date||Q.end_date,projectName:H.name,projectId:H.id,phaseName:Q.name,phaseId:Q.id,level:"phase"}),A.set(ne.staff_id,O)}),(J=Q.children)==null||J.forEach(ne=>{var O;(O=ne.staffAssignments)==null||O.forEach(V=>{const G=A.get(V.staff_id)||[];G.push({...V,start_date:V.start_date||ne.start_date,end_date:V.end_date||ne.end_date,projectName:H.name,projectId:H.id,phaseName:Q.name,phaseId:Q.id,subphaseName:ne.name,subphaseId:ne.id,level:"subphase"}),A.set(V.staff_id,G)})})}))}),A},[s,N]),$=g.useMemo(()=>{const A=new Map;return N.forEach(H=>A.set(H.id,[])),r.forEach(H=>{const z=A.get(H.staff_id)||[];z.push(H),A.set(H.staff_id,z)}),A},[r,N]),P=g.useMemo(()=>{const A=new Map;return N.forEach(H=>{const z=j.get(H.id)||[],K=$.get(H.id)||[],Q=XC(z,K),J=(Q>0?Gc+(Vc+kg)*Q:0)+Qc+Gc;A.set(H.id,Math.max(eh,J))}),A},[N,j,$]),k=A=>100-(j.get(A)||[]).reduce((K,Q)=>K+(Q.allocation||0),0),E=g.useCallback(A=>{u(H=>{const z=new Set(H);return z.has(A)?z.delete(A):z.add(A),z})},[]),I=g.useCallback(A=>l?l.role==="admin"||l.role==="superuser"?!0:l.id===A:!1,[l]),M=(A,H)=>{const z=new Date(A),K=new Date(H),Q=Y=>Y.toLocaleDateString("en-GB",{day:"numeric",month:"short"});return A===H?Q(z):`${Q(z)} - ${Q(K)}`},B=g.useCallback((A,H,z)=>{w({vacationId:A,staffName:H,description:z})},[]),C=g.useCallback(async()=>{if(x){S(!0);try{await pv(x.vacationId);const A=await Xd();i(A),w(null)}catch(A){console.error("Failed to delete vacation:",A)}finally{S(!1)}}},[x,i]),R=g.useCallback(()=>{w(null)},[]);return a.jsxs("div",{className:X.container,children:[a.jsxs("div",{className:X.panel,children:[a.jsx("div",{className:X.panelHeader,children:a.jsxs("div",{className:X.headerLeft,children:[a.jsx("span",{className:X.headerTitle,children:"Staff"}),a.jsx("span",{className:X.headerCount,children:N.length})]})}),a.jsxs("div",{className:X.panelBody,ref:e,children:[N.length===0?a.jsx("div",{className:X.empty,children:a.jsx("p",{children:"No staff found"})}):N.map(A=>{const H=k(A.id),z=P.get(A.id)||eh,K=v.has(A.id),Q=$.get(A.id)||[],Y=j.get(A.id)||[],J=I(A.id);return a.jsxs("div",{className:X.staffWrapper,children:[a.jsxs("div",{className:X.staffRow,style:{height:z},onClick:()=>E(A.id),children:[a.jsx("div",{className:`${X.expandIcon} ${K?X.expanded:""}`,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"9 18 15 12 9 6"})})}),a.jsx("div",{className:`${X.status} ${H>0?X.available:X.overloaded}`}),a.jsxs("div",{className:X.staffInfo,children:[a.jsx("div",{className:X.staffName,children:A.name}),a.jsxs("div",{className:X.staffMeta,children:[a.jsx("span",{children:A.role||"No title"}),a.jsx("span",{children:"  "}),a.jsxs("span",{className:H<=0?X.overloadedText:"",children:[H,"% available"]})]})]})]}),K&&a.jsxs("div",{className:X.expandedContent,children:[Q.map(ne=>a.jsxs("div",{className:`${X.detailRow} ${J?X.clickable:""} ${X.vacationRow}`,onClick:J?()=>_(ne,A.id):void 0,children:[a.jsx("span",{className:`${X.detailType} ${X.vacation}`,children:"Vacation"}),a.jsx("span",{className:X.detailName,children:ne.description||"Time Off"}),a.jsx("span",{className:X.dateBadge,children:M(ne.start_date,ne.end_date)}),J&&a.jsx("span",{className:X.deleteBtn,onClick:O=>{O.stopPropagation(),B(ne.id,A.name,ne.description||"Time Off")},title:"Delete vacation",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]},`v-${ne.id}`)),J&&a.jsxs("div",{className:`${X.detailRow} ${X.addRow}`,onClick:()=>_(void 0,A.id),children:[a.jsx("span",{className:X.addIcon,children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}),a.jsx("span",{className:X.addText,children:"Add vacation / time off"})]}),Y.map(ne=>a.jsxs("div",{className:`${X.detailRow} ${X.clickable}`,children:[a.jsxs("span",{className:`${X.detailType} ${X.allocation}`,children:[ne.allocation,"%"]}),a.jsxs("span",{className:X.detailName,children:[ne.projectName,ne.phaseName&&`  ${ne.phaseName}`]}),a.jsx("span",{className:X.dateBadge,children:M(ne.start_date,ne.end_date)})]},`a-${ne.id}-${ne.level}`)),Y.length===0&&Q.length===0&&!J&&a.jsx("div",{className:X.detailRow,children:a.jsx("span",{className:X.noAssignments,children:"No assignments"})})]})]},A.id)}),a.jsx(QC,{isExpanded:y,onToggle:()=>m(!y)})]})]}),a.jsx("div",{className:X.timeline,children:a.jsx("div",{className:X.timelineScroll,children:a.jsxs("div",{className:X.timelineContent,style:{width:T},children:[a.jsx(oi,{headers:L,cells:D,cellWidth:f,totalWidth:T,viewMode:c}),a.jsx(Wb,{ref:t,staff:N,assignmentsMap:j,vacationsMap:$,rowHeights:P,expandedStaff:v,expandedBankHolidays:y,cells:D,cellWidth:f,totalWidth:T,viewMode:c})]})})}),x&&a.jsx("div",{className:X.confirmOverlay,onClick:R,children:a.jsxs("div",{className:X.confirmModal,onClick:A=>A.stopPropagation(),children:[a.jsx("div",{className:X.confirmIcon,children:a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 6h18"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}),a.jsx("path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),a.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),a.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]})}),a.jsx("h3",{className:X.confirmTitle,children:"Delete Vacation"}),a.jsxs("p",{className:X.confirmText,children:["Are you sure you want to delete ",a.jsx("strong",{children:x.description})," for ",a.jsx("strong",{children:x.staffName}),"?"]}),a.jsx("p",{className:X.confirmWarning,children:"This action cannot be undone."}),a.jsxs("div",{className:X.confirmActions,children:[a.jsx("button",{className:X.confirmCancel,onClick:R,disabled:b,children:"Cancel"}),a.jsx("button",{className:X.confirmDelete,onClick:C,disabled:b,children:b?"Deleting...":"Delete"})]})]})})]})}function XC(e,t){if(e.length===0&&t.length===0)return 0;const n=[...e.map(o=>({start:o.start_date,end:o.end_date})),...t.map(o=>({start:o.start_date,end:o.end_date}))];if(n.length===0)return 0;const s=[];n.forEach(o=>{o.start&&o.end&&(s.push({date:o.start,type:"start"}),s.push({date:o.end,type:"end"}))}),s.sort((o,l)=>o.date!==l.date?o.date.localeCompare(l.date):o.type==="start"?-1:1);let r=0,i=0;return s.forEach(o=>{o.type==="start"?(i++,r=Math.max(r,i)):i--}),r}const KC="_body_jm4k4_3",ZC="_content_jm4k4_23",JC="_grid_jm4k4_29",eD="_gridCell_jm4k4_56",tD="_weekend_jm4k4_64",nD="_holiday_jm4k4_68",sD="_today_jm4k4_72",aD="_rows_jm4k4_78",rD="_row_jm4k4_78",iD="_bookingBar_jm4k4_91",oD="_barLabel_jm4k4_112",Rt={body:KC,content:ZC,grid:JC,gridCell:eD,weekend:tD,holiday:nD,today:sD,rows:aD,row:rD,bookingBar:iD,barLabel:oD},lD=g.forwardRef(function({equipment:t,bookingsMap:n,cells:s,cellWidth:r,totalWidth:i,viewMode:o},l){const c=o==="week"||o==="month";return a.jsx("div",{ref:l,className:Rt.body,children:a.jsxs("div",{className:Rt.content,style:{width:i,"--cell-width":`${r}px`},children:[a.jsxs("div",{className:Rt.grid,children:[c&&s.map((d,f)=>d.isWeekend?a.jsx("div",{className:`${Rt.gridCell} ${Rt.weekend}`,style:{left:f*r,width:r}},`weekend-${f}`):null),c&&s.map((d,f)=>d.isBankHoliday?a.jsx("div",{className:`${Rt.gridCell} ${Rt.holiday}`,style:{left:f*r,width:r}},`holiday-${f}`):null),s.map((d,f)=>d.isToday?a.jsx("div",{className:`${Rt.gridCell} ${Rt.today}`,style:{left:f*r,width:r}},`today-${f}`):null)]}),a.jsx("div",{className:Rt.rows,children:t.map(d=>a.jsx(cD,{equipment:d,bookings:n.get(d.id)||[],cells:s,cellWidth:r,viewMode:o},d.id))})]})})});function cD({bookings:e,cells:t,cellWidth:n,viewMode:s}){const r=g.useMemo(()=>e.map(i=>{const o=Mt(i.start_date,i.end_date,t,n,s);return o?{...i,left:o.left,width:o.width}:null}).filter(Boolean),[e,t,n,s]);return a.jsx("div",{className:Rt.row,children:r.map(i=>i&&a.jsx("div",{className:Rt.bookingBar,style:{left:i.left,width:i.width},title:`${i.projectName}${i.phaseName?` - ${i.phaseName}`:""}`,children:a.jsx("span",{className:Rt.barLabel,children:i.projectName})},`booking-${i.id}`))})}const dD="_container_873dq_3",uD="_panel_873dq_11",fD="_panelHeader_873dq_20",hD="_headerTitle_873dq_31",mD="_headerCount_873dq_37",pD="_panelBody_873dq_45",gD="_empty_873dq_65",_D="_equipmentRow_873dq_77",yD="_status_873dq_86",vD="_available_873dq_93",xD="_booked_873dq_97",wD="_equipmentInfo_873dq_101",jD="_equipmentName_873dq_107",SD="_equipmentMeta_873dq_116",kD="_timeline_873dq_122",ND="_timelineScroll_873dq_130",bD="_timelineContent_873dq_152",at={container:dD,panel:uD,panelHeader:fD,headerTitle:hD,headerCount:mD,panelBody:pD,empty:gD,equipmentRow:_D,status:yD,available:vD,booked:xD,equipmentInfo:wD,equipmentName:jD,equipmentMeta:SD,timeline:kD,timelineScroll:ND,timelineContent:bD};function CD(){const e=g.useRef(null),t=g.useRef(null),n=F(y=>y.equipment),s=F(y=>y.projects),r=F(y=>y.currentSite),i=F(y=>y.viewMode),o=F(y=>y.currentDate),l=F(y=>y.cellWidth),c=F(y=>y.bankHolidayDates),d=F(y=>y.bankHolidays);Jo(e,t);const f=g.useMemo(()=>n.filter(y=>y.site_id===(r==null?void 0:r.id)).sort((y,m)=>y.name.localeCompare(m.name)),[n,r]),h=g.useMemo(()=>ai(o,i,c,d),[o,i,c,d]),p=g.useMemo(()=>ri(h,i),[h,i]),_=h.length*l,v=g.useMemo(()=>{const y=new Map;return f.forEach(m=>y.set(m.id,[])),s.forEach(m=>{var x,w;m.archived||((x=m.equipmentAssignments)==null||x.forEach(b=>{const S=y.get(b.equipment_id)||[];S.push({...b,projectName:m.name,projectId:m.id,level:"project"}),y.set(b.equipment_id,S)}),(w=m.phases)==null||w.forEach(b=>{var S;(S=b.equipmentAssignments)==null||S.forEach(N=>{const D=y.get(N.equipment_id)||[];D.push({...N,start_date:N.start_date||b.start_date,end_date:N.end_date||b.end_date,projectName:m.name,projectId:m.id,phaseName:b.name,phaseId:b.id,level:"phase"}),y.set(N.equipment_id,D)})}))}),y},[s,f]),u=y=>(v.get(y)||[]).length>0?100:0;return a.jsxs("div",{className:at.container,children:[a.jsxs("div",{className:at.panel,children:[a.jsxs("div",{className:at.panelHeader,children:[a.jsx("span",{className:at.headerTitle,children:"Equipment"}),a.jsx("span",{className:at.headerCount,children:f.length})]}),a.jsx("div",{className:at.panelBody,ref:e,children:f.length===0?a.jsx("div",{className:at.empty,children:a.jsx("p",{children:"No equipment found"})}):f.map(y=>{const m=u(y.id);return a.jsxs("div",{className:at.equipmentRow,children:[a.jsx("div",{className:`${at.status} ${m>0?at.booked:at.available}`}),a.jsxs("div",{className:at.equipmentInfo,children:[a.jsx("div",{className:at.equipmentName,children:y.name}),a.jsxs("div",{className:at.equipmentMeta,children:[a.jsx("span",{children:y.type||"Equipment"}),a.jsx("span",{children:"  "}),a.jsx("span",{children:m>0?"In use":"Available"})]})]})]},y.id)})})]}),a.jsx("div",{className:at.timeline,children:a.jsx("div",{className:at.timelineScroll,children:a.jsxs("div",{className:at.timelineContent,style:{width:_},children:[a.jsx(oi,{headers:p,cells:h,cellWidth:l,totalWidth:_,viewMode:i}),a.jsx(lD,{ref:t,equipment:f,bookingsMap:v,cells:h,cellWidth:l,totalWidth:_,viewMode:i})]})})})]})}const DD="_body_11czp_3",$D="_content_11czp_23",ED="_grid_11czp_29",TD="_gridCell_11czp_56",PD="_weekend_11czp_64",MD="_holiday_11czp_68",ID="_today_11czp_72",LD="_rows_11czp_78",AD="_siteRow_11czp_84",RD="_currentSite_11czp_90",BD="_projectRow_11czp_95",FD="_bar_11czp_102",OD="_confirmed_11czp_128",HD="_unconfirmed_11czp_133",qD="_masked_11czp_146",zD="_barLabel_11czp_150",et={body:DD,content:$D,grid:ED,gridCell:TD,weekend:PD,holiday:MD,today:ID,rows:LD,siteRow:AD,currentSite:RD,projectRow:BD,bar:FD,confirmed:OD,unconfirmed:HD,masked:qD,barLabel:zD},WD=g.forwardRef(function({rows:t,cells:n,cellWidth:s,totalWidth:r,viewMode:i},o){const l=i==="week"||i==="month";return a.jsx("div",{ref:o,className:et.body,children:a.jsxs("div",{className:et.content,style:{width:r,"--cell-width":`${s}px`},children:[a.jsxs("div",{className:et.grid,children:[l&&n.map((c,d)=>c.isWeekend?a.jsx("div",{className:`${et.gridCell} ${et.weekend}`,style:{left:d*s,width:s}},`weekend-${d}`):null),l&&n.map((c,d)=>c.isBankHoliday?a.jsx("div",{className:`${et.gridCell} ${et.holiday}`,style:{left:d*s,width:s}},`holiday-${d}`):null),n.map((c,d)=>c.isToday?a.jsx("div",{className:`${et.gridCell} ${et.today}`,style:{left:d*s,width:s}},`today-${d}`):null)]}),a.jsx("div",{className:et.rows,children:t.map(c=>c.type==="site"?a.jsx("div",{className:`${et.siteRow} ${c.isCurrentSite?et.currentSite:""}`},`site-row-${c.site.id}`):a.jsx(UD,{row:c,cells:n,cellWidth:s,viewMode:i},`project-row-${c.project.id}`))})]})})});function UD({row:e,cells:t,cellWidth:n,viewMode:s}){const{project:r,isCurrentSite:i,displayName:o}=e,l=g.useMemo(()=>!r.start_date||!r.end_date?null:Mt(r.start_date,r.end_date,t,n,s),[r.start_date,r.end_date,t,n,s]);return a.jsx("div",{className:et.projectRow,children:l&&a.jsx("div",{className:`${et.bar} ${r.confirmed?et.confirmed:et.unconfirmed} ${i?"":et.masked}`,style:{left:l.left,width:l.width},title:i?r.name:"Confidential",children:a.jsx("span",{className:et.barLabel,children:i?o:"Project"})})})}const VD="_container_144fl_3",GD="_panel_144fl_11",QD="_panelHeader_144fl_20",YD="_headerTitle_144fl_31",XD="_panelBody_144fl_37",KD="_siteRow_144fl_58",ZD="_currentSite_144fl_68",JD="_siteIndicator_144fl_72",e$="_current_144fl_68",t$="_siteInfo_144fl_84",n$="_siteName_144fl_89",s$="_siteMeta_144fl_95",a$="_projectRow_144fl_101",r$="_masked_144fl_110",i$="_status_144fl_114",o$="_confirmed_144fl_121",l$="_unconfirmed_144fl_125",c$="_projectInfo_144fl_129",d$="_projectName_144fl_135",u$="_projectMeta_144fl_143",f$="_timeline_144fl_149",h$="_timelineScroll_144fl_157",m$="_timelineContent_144fl_179",Ie={container:VD,panel:GD,panelHeader:QD,headerTitle:YD,panelBody:XD,siteRow:KD,currentSite:ZD,siteIndicator:JD,current:e$,siteInfo:t$,siteName:n$,siteMeta:s$,projectRow:a$,masked:r$,status:i$,confirmed:o$,unconfirmed:l$,projectInfo:c$,projectName:d$,projectMeta:u$,timeline:f$,timelineScroll:h$,timelineContent:m$};function p$(){const e=g.useRef(null),t=g.useRef(null),n=F(u=>u.sites),s=F(u=>u.projects),r=F(u=>u.currentSite),i=F(u=>u.viewMode),o=F(u=>u.currentDate),l=F(u=>u.cellWidth),c=F(u=>u.bankHolidayDates),d=F(u=>u.bankHolidays);Jo(e,t);const f=g.useMemo(()=>ai(o,i,c,d),[o,i,c,d]),h=g.useMemo(()=>ri(f,i),[f,i]),p=f.length*l,_=g.useMemo(()=>{const u=new Map;return n.forEach(y=>{u.set(y.id,[])}),s.forEach(y=>{if(y.archived)return;const m=u.get(y.site_id)||[];m.push(y),u.set(y.site_id,m)}),u.forEach((y,m)=>{u.set(m,y.sort((x,w)=>x.name.localeCompare(w.name)))}),u},[n,s]),v=g.useMemo(()=>{const u=[];return n.forEach(y=>{const m=y.id===(r==null?void 0:r.id),x=_.get(y.id)||[];u.push({type:"site",site:y,isCurrentSite:m,projectCount:x.length}),x.forEach(w=>{u.push({type:"project",project:w,site:y,isCurrentSite:m,displayName:m?w.name:"Confidential Project",displayCustomer:m?w.customer||"":"***"})})}),u},[n,_,r]);return a.jsxs("div",{className:Ie.container,children:[a.jsxs("div",{className:Ie.panel,children:[a.jsx("div",{className:Ie.panelHeader,children:a.jsx("span",{className:Ie.headerTitle,children:"Cross-Site Overview"})}),a.jsx("div",{className:Ie.panelBody,ref:e,children:v.map(u=>u.type==="site"?a.jsxs("div",{className:`${Ie.siteRow} ${u.isCurrentSite?Ie.currentSite:""}`,children:[a.jsx("div",{className:`${Ie.siteIndicator} ${u.isCurrentSite?Ie.current:""}`}),a.jsxs("div",{className:Ie.siteInfo,children:[a.jsx("div",{className:Ie.siteName,children:u.site.name}),a.jsxs("div",{className:Ie.siteMeta,children:[u.projectCount," projects"]})]})]},`site-${u.site.id}`):a.jsxs("div",{className:`${Ie.projectRow} ${u.isCurrentSite?"":Ie.masked}`,children:[a.jsx("div",{className:`${Ie.status} ${u.project.confirmed?Ie.confirmed:Ie.unconfirmed}`}),a.jsxs("div",{className:Ie.projectInfo,children:[a.jsx("div",{className:Ie.projectName,children:u.displayName}),u.displayCustomer&&a.jsx("div",{className:Ie.projectMeta,children:u.displayCustomer})]})]},`project-${u.project.id}`))})]}),a.jsx("div",{className:Ie.timeline,children:a.jsx("div",{className:Ie.timelineScroll,children:a.jsxs("div",{className:Ie.timelineContent,style:{width:p},children:[a.jsx(oi,{headers:h,cells:f,cellWidth:l,totalWidth:p,viewMode:i}),a.jsx(WD,{ref:t,rows:v,cells:f,cellWidth:l,totalWidth:p,viewMode:i})]})})})]})}const g$="_row_ku0c1_3",_$="_specialCell_ku0c1_29",y$="_weekend_ku0c1_37",v$="_bankHoliday_ku0c1_41",x$="_today_ku0c1_45",w$="_bar_ku0c1_52",j$="_confirmed_ku0c1_77",S$="_unconfirmed_ku0c1_82",jn={row:g$,specialCell:_$,weekend:y$,bankHoliday:v$,today:x$,bar:w$,confirmed:j$,unconfirmed:S$};function k$({project:e,cells:t,cellWidth:n,totalWidth:s,showHighlighting:r}){const i=g.useMemo(()=>{if(!e.start_date||!e.end_date||t.length===0)return null;const o=new Date(e.start_date),l=new Date(e.end_date);o.setHours(0,0,0,0),l.setHours(0,0,0,0);const c=t[0].date,d=t[t.length-1].date;if(l<c||o>d)return null;let f=0;for(let v=0;v<t.length;v++){if(t[v].date>=o){f=v;break}v===t.length-1&&(f=v)}o<c&&(f=0);let h=t.length-1;for(let v=t.length-1;v>=0;v--)if(t[v].date<=l){h=v;break}const p=f*n,_=Math.max((h-f+1)*n,n);return{left:p,width:_}},[e.start_date,e.end_date,t,n]);return a.jsxs("div",{className:jn.row,style:{width:s,"--cell-width":`${n}px`},children:[r&&t.map((o,l)=>o.isWeekend?a.jsx("div",{className:`${jn.specialCell} ${jn.weekend}`,style:{left:l*n,width:n}},`weekend-${l}`):null),r&&t.map((o,l)=>o.isBankHoliday?a.jsx("div",{className:`${jn.specialCell} ${jn.bankHoliday}`,style:{left:l*n,width:n}},`holiday-${l}`):null),t.map((o,l)=>o.isToday?a.jsx("div",{className:`${jn.specialCell} ${jn.today}`,style:{left:l*n,width:n}},`today-${l}`):null),i&&a.jsx("div",{className:`${jn.bar} ${e.confirmed?jn.confirmed:jn.unconfirmed}`,style:{left:i.left,width:i.width},children:e.name})]})}const N$="_container_1h039_3",b$="_projectPanel_1h039_11",C$="_panelHeader_1h039_21",D$="_panelContent_1h039_34",$$="_emptyState_1h039_58",E$="_projectRow_1h039_70",T$="_projectMain_1h039_75",P$="_expandPlaceholder_1h039_83",M$="_status_1h039_92",I$="_confirmed_1h039_99",L$="_unconfirmed_1h039_103",A$="_projectInfo_1h039_107",R$="_projectName_1h039_113",B$="_projectMeta_1h039_122",F$="_pmName_1h039_130",O$="_editBtn_1h039_134",H$="_timelineWrapper_1h039_155",q$="_timelineScroll_1h039_163",z$="_timelineContent_1h039_185",W$="_timelineBody_1h039_192",U$="_timelineBodyContent_1h039_212",V$="_emptyTimeline_1h039_217",Fe={container:N$,projectPanel:b$,panelHeader:C$,panelContent:D$,emptyState:$$,projectRow:E$,projectMain:T$,expandPlaceholder:P$,status:M$,confirmed:I$,unconfirmed:L$,projectInfo:A$,projectName:R$,projectMeta:B$,pmName:F$,editBtn:O$,timelineWrapper:H$,timelineScroll:q$,timelineContent:z$,timelineBody:W$,timelineBodyContent:U$,emptyTimeline:V$};function G$(){const e=g.useRef(null),t=g.useRef(null),n=F(u=>u.projects),s=F(u=>u.currentSite),r=F(u=>u.viewMode),i=F(u=>u.currentDate),o=F(u=>u.cellWidth),l=F(u=>u.bankHolidayDates),c=F(u=>u.bankHolidays),d=Z(u=>u.openProjectModal);Jo(e,t);const f=g.useMemo(()=>n.filter(u=>u.archived&&u.site_id===(s==null?void 0:s.id)).sort((u,y)=>u.name.localeCompare(y.name)),[n,s]),h=g.useMemo(()=>ai(i,r,l,c),[i,r,l,c]),p=g.useMemo(()=>ri(h,r),[h,r]),_=h.length*o,v=r==="week"||r==="month";return a.jsxs("div",{className:Fe.container,children:[a.jsxs("div",{className:Fe.projectPanel,children:[a.jsx("div",{className:Fe.panelHeader,children:"Archived Projects"}),a.jsx("div",{className:Fe.panelContent,ref:e,children:f.length===0?a.jsx("div",{className:Fe.emptyState,children:a.jsx("p",{children:"No archived projects"})}):f.map(u=>a.jsx("div",{className:Fe.projectRow,"data-project-id":u.id,children:a.jsxs("div",{className:Fe.projectMain,children:[a.jsx("div",{className:Fe.expandPlaceholder,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24"})}),a.jsx("div",{className:`${Fe.status} ${u.confirmed?Fe.confirmed:Fe.unconfirmed}`}),a.jsxs("div",{className:Fe.projectInfo,children:[a.jsx("div",{className:Fe.projectName,children:u.name}),a.jsxs("div",{className:Fe.projectMeta,children:[a.jsx("span",{className:Fe.pmName,children:u.pm_name||"No PM"}),a.jsx("span",{children:"  "}),a.jsx("span",{children:u.customer||"No customer"})]})]}),a.jsx("button",{className:Fe.editBtn,onClick:y=>{y.stopPropagation(),d(u)},title:"Edit project",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})})]})},u.id))})]}),a.jsx("div",{className:Fe.timelineWrapper,children:a.jsx("div",{className:Fe.timelineScroll,children:a.jsxs("div",{className:Fe.timelineContent,style:{width:_},children:[a.jsx(oi,{headers:p,cells:h,cellWidth:o,totalWidth:_,viewMode:r}),a.jsx("div",{className:Fe.timelineBody,ref:t,children:a.jsx("div",{className:Fe.timelineBodyContent,style:{width:_,"--cell-width":`${o}px`},children:f.length===0?a.jsx("div",{className:Fe.emptyTimeline}):f.map(u=>a.jsx(k$,{project:u,cells:h,cellWidth:o,totalWidth:_,showHighlighting:v},u.id))})})]})})})]})}const Q$="_container_16j28_1",Y$="_body_16j28_11",X$="_main_16j28_18",Rl={container:Q$,body:Y$,main:X$};function K$(){const e=F(s=>s.currentView);uw();const t=()=>{switch(e){case"gantt":return a.jsx(Zf,{});case"staff":return a.jsx(YC,{});case"equipment":return a.jsx(CD,{});case"crosssite":return a.jsx(p$,{});case"archived":return a.jsx(G$,{});default:return a.jsx(Zf,{})}},n=e==="gantt";return a.jsxs("div",{className:Rl.container,children:[a.jsx(pj,{}),a.jsxs("div",{className:Rl.body,children:[a.jsx(zj,{}),a.jsx("main",{className:Rl.main,children:t()}),n&&a.jsx(p2,{})]}),a.jsx(gb,{})]})}const Z$="_overlay_4c1e4_1",J$="_fadeIn_4c1e4_1",eE="_modal_4c1e4_14",tE="_slideIn_4c1e4_1",nE="_sm_4c1e4_30",sE="_md_4c1e4_35",aE="_lg_4c1e4_40",rE="_xl_4c1e4_45",iE="_full_4c1e4_50",oE="_header_4c1e4_57",lE="_title_4c1e4_66",cE="_closeBtn_4c1e4_73",dE="_body_4c1e4_98",uE="_footer_4c1e4_104",Jn={overlay:Z$,fadeIn:J$,modal:eE,slideIn:tE,sm:nE,md:sE,lg:aE,xl:rE,full:iE,header:oE,title:lE,closeBtn:cE,body:dE,footer:uE};function _t({isOpen:e,onClose:t,title:n,children:s,size:r="md",footer:i,closeOnOverlayClick:o=!0,closeOnEscape:l=!0}){const c=g.useRef(null),d=g.useRef(null),f=g.useRef(!1),h=g.useRef(t);h.current=t;const p=g.useCallback(v=>{o&&v.target===c.current&&h.current()},[o]);if(g.useEffect(()=>{if(!e||!l)return;const v=u=>{u.key==="Escape"&&h.current()};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[e,l]),g.useEffect(()=>{var v;return e&&!f.current?(document.body.style.overflow="hidden",(v=d.current)==null||v.focus(),f.current=!0):!e&&f.current&&(document.body.style.overflow="",f.current=!1),()=>{f.current&&(document.body.style.overflow="")}},[e]),!e)return null;const _=[Jn.modal,Jn[r]].join(" ");return Ud.createPortal(a.jsx("div",{ref:c,className:Jn.overlay,onClick:p,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:a.jsxs("div",{ref:d,className:_,tabIndex:-1,children:[a.jsxs("div",{className:Jn.header,children:[a.jsx("h2",{id:"modal-title",className:Jn.title,children:n}),a.jsx("button",{className:Jn.closeBtn,onClick:t,"aria-label":"Close modal",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsx("div",{className:Jn.body,children:s}),i&&a.jsx("div",{className:Jn.footer,children:i})]})}),document.body)}const fE="_button_4ftbf_1",hE="_sm_4ftbf_21",mE="_md_4ftbf_27",pE="_lg_4ftbf_33",gE="_primary_4ftbf_40",_E="_secondary_4ftbf_53",yE="_danger_4ftbf_64",vE="_ghost_4ftbf_73",xE="_icon_4ftbf_83",wE="_disabled_4ftbf_107",jE="_loading_4ftbf_113",SE="_content_4ftbf_117",kE="_spinner_4ftbf_123",NE="_spin_4ftbf_123",In={button:fE,sm:hE,md:mE,lg:pE,primary:gE,secondary:_E,danger:yE,ghost:vE,icon:xE,disabled:wE,loading:jE,content:SE,spinner:kE,spin:NE},ae=g.forwardRef(({variant:e="primary",size:t="md",loading:n=!1,icon:s,iconPosition:r="left",children:i,className:o,disabled:l,...c},d)=>{const f=[In.button,In[e],In[t],n&&In.loading,l&&In.disabled,o].filter(Boolean).join(" ");return a.jsxs("button",{ref:d,className:f,disabled:n||l,...c,children:[n&&a.jsx("span",{className:In.spinner}),!n&&s&&r==="left"&&a.jsx("span",{className:In.icon,children:s}),i&&a.jsx("span",{className:In.content,children:i}),!n&&s&&r==="right"&&a.jsx("span",{className:In.icon,children:s})]})});ae.displayName="Button";function ke(e){return e?e.includes("T")?e.split("T")[0]:e:""}function Ca(e){if(!e)return"";try{const t=Gn(e);return be(t,"MM/dd/yyyy")}catch{return e}}function Yc(e,t){if(!e||!t)return 1;try{const n=Gn(e),s=Gn(t);return Ns(s,n)+1}catch{return 1}}function Ng(e,t){return e===t}function th(e,t){return!e||e.length===0?"":e.map(n=>{const s=`phase-${n.id}`,r=`subphase-${n.id}`;let i=t[s]||t[r];if(!i)return null;let o=`${i}${n.type}`;return n.lag&&n.lag!==0&&(o+=n.lag>0?`+${n.lag}d`:`${n.lag}d`),o}).filter(Boolean).join(",")}function bg(e,t,n,s,r){const i=e.filter(o=>o.parent_subphase_id===t);for(const o of i){const l=s.length+1,c=`subphase-${o.id}`;r[c]=l;const d=Ng(o.start_date,o.end_date);s.push({id:l,name:d?` ${o.name}`:o.name,outlineLevel:n,start:Ca(o.start_date),finish:Ca(o.end_date),duration:d?"0d":`${Yc(o.start_date,o.end_date)}d`,predecessors:"",percentComplete:o.completion||0,milestone:d?"Yes":"No",notes:"",internalId:c}),bg(e,o.id,n+1,s,r)}}function nh(e){const t=[];function n(s){if(s)for(const r of s)t.push(r),r.children&&n(r.children)}return n(e.children),t}function bE(e){const t=[],n={};for(const i of e){const o=t.length+1,l=`project-${i.id}`;n[l]=o,t.push({id:o,name:i.name,outlineLevel:1,start:Ca(i.start_date),finish:Ca(i.end_date),duration:`${Yc(i.start_date,i.end_date)}d`,predecessors:"",percentComplete:0,milestone:"No",notes:[i.customer?`Customer: ${i.customer}`:"",i.pm_name?`PM: ${i.pm_name}`:"",i.confirmed?"":"UNCONFIRMED"].filter(Boolean).join("; "),internalId:l});for(const c of i.phases||[]){const d=t.length+1,f=`phase-${c.id}`;n[f]=d;const h=Ng(c.start_date,c.end_date);t.push({id:d,name:h?` ${c.name}`:c.name,outlineLevel:2,start:Ca(c.start_date),finish:Ca(c.end_date),duration:h?"0d":`${Yc(c.start_date,c.end_date)}d`,predecessors:"",percentComplete:c.completion||0,milestone:h?"Yes":"No",notes:"",internalId:f});const p=nh(c);p.length>0&&bg(p,null,3,t,n)}}for(const i of e)for(const o of i.phases||[]){const l=t.find(d=>d.internalId===`phase-${o.id}`);l&&o.dependencies&&(l.predecessors=th(o.dependencies,n));const c=nh(o);for(const d of c){const f=t.find(h=>h.internalId===`subphase-${d.id}`);f&&d.dependencies&&(f.predecessors=th(d.dependencies,n))}}return[["ID","Name","Outline Level","Start","Finish","Duration","Predecessors","% Complete","Milestone","Notes"].join(","),...t.map(i=>[i.id,`"${i.name.replace(/"/g,'""')}"`,i.outlineLevel,i.start,i.finish,i.duration,i.predecessors,i.percentComplete,i.milestone,`"${i.notes.replace(/"/g,'""')}"`].join(","))].join(`
`)}function CE(e,t){const n=new Blob([e],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(n),r=document.createElement("a");r.href=s,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s)}function DE(e,t){const n=bE(e),s=be(new Date,"yyyy-MM-dd"),r=t?`${t.toLowerCase().replace(/\s+/g,"-")}-projects-${s}.csv`:`projects-export-${s}.csv`;CE(n,r)}function $E(e){const t=[];t.push('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'),t.push('<Project xmlns="http://schemas.microsoft.com/project">'),t.push(`  <Name>${Ii(e.name)}</Name>`),t.push(`  <Title>${Ii(e.name)}</Title>`),t.push(`  <Company>${Ii(e.customer||"")}</Company>`),e.start_date&&t.push(`  <StartDate>${e.start_date}T08:00:00</StartDate>`),e.end_date&&t.push(`  <FinishDate>${e.end_date}T17:00:00</FinishDate>`),t.push("  <ScheduleFromStart>1</ScheduleFromStart>"),t.push(`  <CurrentDate>${be(new Date,"yyyy-MM-dd'T'HH:mm:ss")}</CurrentDate>`),t.push("  <CalendarUID>1</CalendarUID>"),t.push("  <Calendars>"),t.push("    <Calendar>"),t.push("      <UID>1</UID>"),t.push("      <Name>Standard</Name>"),t.push("      <IsBaseCalendar>1</IsBaseCalendar>"),t.push("    </Calendar>"),t.push("  </Calendars>"),t.push("  <Tasks>");let n=0;const s=(r,i,o,l,c=!1,d=0)=>{n++,t.push("    <Task>"),t.push(`      <UID>${n}</UID>`),t.push(`      <ID>${n}</ID>`),t.push(`      <Name>${Ii(r)}</Name>`),t.push(`      <OutlineLevel>${l}</OutlineLevel>`),i&&t.push(`      <Start>${i}T08:00:00</Start>`),o&&t.push(`      <Finish>${o}T17:00:00</Finish>`),t.push(`      <Milestone>${c?"1":"0"}</Milestone>`),t.push(`      <PercentComplete>${d||0}</PercentComplete>`),t.push("    </Task>")};s(e.name,e.start_date,e.end_date,0);for(const r of e.phases||[]){const i=r.start_date===r.end_date;s(r.name,r.start_date,r.end_date,1,i,r.completion||0);const o=(l,c)=>{for(const d of l||[]){const f=d.start_date===d.end_date;s(d.name,d.start_date,d.end_date,c,f,d.completion||0),d.children&&d.children.length>0&&o(d.children,c+1)}};o(r.children,2)}return t.push("  </Tasks>"),t.push("  <Resources/>"),t.push("  <Assignments/>"),t.push("</Project>"),t.join(`
`)}function Ii(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function EE(e,t){const n=new Blob([e],{type:"application/xml;charset=utf-8;"}),s=URL.createObjectURL(n),r=document.createElement("a");r.href=s,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s)}function TE(e){const t=$E(e),n=`${e.name.replace(/\s+/g,"_")}.xml`;EE(t,n)}const PE="_form_b7hew_3",ME="_formGroup_b7hew_9",IE="_formRow_b7hew_15",LE="_label_b7hew_21",AE="_input_b7hew_27",RE="_checkbox_b7hew_63",BE="_phaseTags_b7hew_79",FE="_phaseTag_b7hew_79",OE="_selected_b7hew_102",HE="_error_b7hew_109",qE="_footer_b7hew_119",zE="_exportButtons_b7hew_126",WE="_actionButtons_b7hew_141",ue={form:PE,formGroup:ME,formRow:IE,label:LE,input:AE,checkbox:RE,phaseTags:BE,phaseTag:FE,selected:OE,error:HE,footer:qE,exportButtons:zE,actionButtons:WE};function UE(){const{activeModal:e,editingProject:t,closeModal:n}=Z(),{currentSite:s,staff:r,setProjects:i}=F(),o=e==="project",l=!!t,[c,d]=g.useState(""),[f,h]=g.useState(""),[p,_]=g.useState(""),[v,u]=g.useState(""),[y,m]=g.useState(""),[x,w]=g.useState(!1),[b,S]=g.useState(!1),[N,D]=g.useState(""),[L,T]=g.useState(""),[j,$]=g.useState(new Set),[P,k]=g.useState([]),[E,I]=g.useState(!1),[M,B]=g.useState(null),C=g.useMemo(()=>s?r.filter(O=>O.site_id===s.id):[],[r,s]);g.useEffect(()=>{o&&Sv().then(O=>{const G=O.filter(re=>re.is_active!==!1);k(G),l||$(new Set(G.map(re=>re.name)))}).catch(O=>console.error("Failed to load predefined phases:",O))},[o,l]),g.useEffect(()=>{var O,V;if(o){if(t)d(t.name),h(t.customer||""),_(((O=t.pm_id)==null?void 0:O.toString())||""),u(t.sales_pm||""),m(((V=t.volume)==null?void 0:V.toString())||""),w(t.confirmed),S(t.archived||!1),D(ke(t.start_date)),T(ke(t.end_date)),$(new Set);else{const G=new Date,re=new Date(G);re.setMonth(re.getMonth()+1),d(""),h(""),_(""),u(""),m(""),w(!1),S(!1),D(G.toISOString().split("T")[0]),T(re.toISOString().split("T")[0])}B(null)}},[o,t]);const R=O=>{$(V=>{const G=new Set(V);return G.has(O)?G.delete(O):G.add(O),G})},A=async O=>{if(O.preventDefault(),!c.trim()){B("Please enter a project name");return}if(!N||!L){B("Please select start and end dates");return}if(!s){B("No site selected");return}I(!0),B(null);try{const V=[];if(j.size>0&&!l){const se=new Date(N),ve=new Date(L),yt=(ve.getTime()-se.getTime())/j.size;let la=0;for(const Ms of P)if(j.has(Ms.name)){const Cg=new Date(se.getTime()+yt*la),su=new Date(se.getTime()+yt*(la+1)),Dg=su>ve?ve:su;V.push({type:Ms.name,start_date:Cg.toISOString().split("T")[0],end_date:Dg.toISOString().split("T")[0]}),la++}}const G={name:c.trim(),site_id:s.id,customer:f.trim()||null,pm_id:p?parseInt(p):null,sales_pm:v.trim()||null,volume:y?parseInt(y):null,confirmed:x,archived:b,start_date:N,end_date:L,phases:l?void 0:V};l&&t?await si(t.id,G):await V1(G);const re=await Ke();i(re),n()}catch(V){B(V instanceof Error?V.message:"Failed to save project")}finally{I(!1)}},[H,z]=g.useState(!1),K=F(O=>O.projects),Q=g.useMemo(()=>t?K.find(O=>O.id===t.id):null,[t,K]),Y=()=>{Q&&DE([Q],Q.name)},J=()=>{if(Q){z(!0);try{TE(Q)}catch(O){console.error("Export failed:",O),alert("Failed to export to MS Project format")}finally{z(!1)}}},ne=a.jsxs("div",{className:ue.footer,children:[l&&a.jsxs("div",{className:ue.exportButtons,children:[a.jsxs(ae,{variant:"secondary",onClick:Y,disabled:E||H,title:"Export to CSV (MS Project compatible)",children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a.jsx("polyline",{points:"7,10 12,15 17,10"}),a.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),"CSV"]}),a.jsxs(ae,{variant:"secondary",onClick:J,disabled:E||H,title:"Export to MS Project XML format",children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a.jsx("polyline",{points:"7,10 12,15 17,10"}),a.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),H?"Exporting...":"XML"]})]}),a.jsxs("div",{className:ue.actionButtons,children:[a.jsx(ae,{variant:"secondary",onClick:n,disabled:E,children:"Cancel"}),a.jsx(ae,{variant:"primary",onClick:A,disabled:E,children:E?"Saving...":l?"Save Changes":"Create Project"})]})]});return a.jsx(_t,{isOpen:o,onClose:n,title:l?"Edit Project":"New Project",size:"lg",footer:ne,children:a.jsxs("form",{onSubmit:A,className:ue.form,children:[M&&a.jsx("div",{className:ue.error,children:M}),a.jsxs("div",{className:ue.formGroup,children:[a.jsx("label",{className:ue.label,children:"Project Name *"}),a.jsx("input",{type:"text",className:ue.input,value:c,onChange:O=>d(O.target.value),placeholder:"Enter project name",autoFocus:!0})]}),a.jsxs("div",{className:ue.formRow,children:[a.jsxs("div",{className:ue.formGroup,children:[a.jsx("label",{className:ue.label,children:"Start Date *"}),a.jsx("input",{type:"date",className:ue.input,value:N,onChange:O=>D(O.target.value)})]}),a.jsxs("div",{className:ue.formGroup,children:[a.jsx("label",{className:ue.label,children:"End Date *"}),a.jsx("input",{type:"date",className:ue.input,value:L,onChange:O=>T(O.target.value)})]})]}),a.jsxs("div",{className:ue.formRow,children:[a.jsxs("div",{className:ue.formGroup,children:[a.jsx("label",{className:ue.label,children:"Project Manager"}),a.jsxs("select",{className:ue.input,value:p,onChange:O=>_(O.target.value),children:[a.jsx("option",{value:"",children:"Select PM"}),C.map(O=>a.jsx("option",{value:O.id,children:O.name},O.id))]})]}),a.jsxs("div",{className:ue.formGroup,children:[a.jsx("label",{className:ue.label,children:"Customer"}),a.jsx("input",{type:"text",className:ue.input,value:f,onChange:O=>h(O.target.value),placeholder:"Customer name"})]})]}),a.jsxs("div",{className:ue.formRow,children:[a.jsxs("div",{className:ue.formGroup,children:[a.jsx("label",{className:ue.label,children:"Sales PM"}),a.jsx("input",{type:"text",className:ue.input,value:v,onChange:O=>u(O.target.value),placeholder:"Sales contact"})]}),a.jsxs("div",{className:ue.formGroup,children:[a.jsx("label",{className:ue.label,children:"Project Volume (CHF)"}),a.jsx("input",{type:"number",className:ue.input,value:y,onChange:O=>m(O.target.value),placeholder:"0"})]})]}),!l&&a.jsxs("div",{className:ue.formGroup,children:[a.jsx("label",{className:ue.label,children:"Project Phases"}),a.jsx("div",{className:ue.phaseTags,children:P.map(O=>a.jsx("span",{className:`${ue.phaseTag} ${j.has(O.name)?ue.selected:""}`,onClick:()=>R(O.name),style:{"--phase-color":O.default_color||O.color||"var(--accent-blue)"},children:O.name},O.id))})]}),a.jsxs("div",{className:ue.formRow,children:[a.jsx("div",{className:ue.formGroup,children:a.jsxs("label",{className:ue.checkbox,children:[a.jsx("input",{type:"checkbox",checked:x,onChange:O=>w(O.target.checked)}),a.jsx("span",{children:"Project Confirmed"})]})}),l&&a.jsx("div",{className:ue.formGroup,children:a.jsxs("label",{className:ue.checkbox,children:[a.jsx("input",{type:"checkbox",checked:b,onChange:O=>S(O.target.checked)}),a.jsx("span",{children:"Archived"})]})})]})]})})}const VE="_form_1rm0y_3",GE="_formGroup_1rm0y_9",QE="_formRow_1rm0y_15",YE="_label_1rm0y_21",XE="_input_1rm0y_27",KE="_checkbox_1rm0y_63",ZE="_error_1rm0y_79",JE="_contextInfo_1rm0y_89",e4="_footer_1rm0y_102",t4="_footerRight_1rm0y_108",n4="_deleteBtn_1rm0y_113",s4="_assignmentsSection_1rm0y_118",a4="_assignmentsList_1rm0y_124",r4="_assignmentItem_1rm0y_131",i4="_assignmentName_1rm0y_140",o4="_assignmentAllocation_1rm0y_145",de={form:VE,formGroup:GE,formRow:QE,label:YE,input:XE,checkbox:KE,error:ZE,contextInfo:JE,footer:e4,footerRight:t4,deleteBtn:n4,assignmentsSection:s4,assignmentsList:a4,assignmentItem:r4,assignmentName:i4,assignmentAllocation:o4};function l4(e){const t=e.phases||[];if(t.length===0)return null;let n=null,s=null;for(const r of t){const i=new Date(r.start_date),o=new Date(r.end_date);(!n||i<n)&&(n=i),(!s||o>s)&&(s=o)}return n&&s?{start:n,end:s}:null}async function sh(e,t,n,s){if(!e.start_date||!e.end_date)return!1;const r=new Date(e.start_date),i=new Date(e.end_date);let o=r,l=i;if(t==="expand"&&n&&s)n<r&&(o=n),s>i&&(l=s);else if(t==="shrink"){const c=l4(e);c&&(o=c.start,l=c.end)}return o.getTime()!==r.getTime()||l.getTime()!==i.getTime()?(console.log("[PhaseModal] Cascading project dates:",{projectId:e.id,mode:t,oldStart:e.start_date,oldEnd:e.end_date,newStart:o.toISOString().split("T")[0],newEnd:l.toISOString().split("T")[0]}),await si(e.id,{start_date:o.toISOString().split("T")[0],end_date:l.toISOString().split("T")[0]}),!0):!1}function c4(){const{activeModal:e,editingPhase:t,modalContext:n,closeModal:s}=Z(),{projects:r,setProjects:i,ensureProjectExpanded:o}=F(),l=e==="phase",c=!!t,d=(t==null?void 0:t.project_id)||n.projectId,[f,h]=g.useState(""),[p,_]=g.useState(!1),[v,u]=g.useState(""),[y,m]=g.useState(""),[x,w]=g.useState(!1),[b,S]=g.useState(null),N=g.useMemo(()=>r.find(j=>j.id===d),[r,d]);g.useEffect(()=>{if(l){if(t)h(t.name),_(!!t.is_milestone),u(ke(t.start_date)),m(ke(t.end_date));else if(n.phantomPreset)h(""),_(!1),u(ke(n.phantomPreset.startDate)),m(ke(n.phantomPreset.endDate));else{const j=new Date().toISOString().split("T")[0],$=ke(N==null?void 0:N.start_date)||j,P=ke(N==null?void 0:N.end_date)||j;h(""),_(!1),u($),m(P)}S(null)}},[l,t,N,n.phantomPreset]),g.useEffect(()=>{p&&v&&m(v)},[p,v]);const D=async j=>{var $;if(j.preventDefault(),!f.trim()){S("Please enter a phase name");return}if(!v){S("Please select a start date");return}if(!p&&!y){S("Please select an end date");return}if(!d){S("No project selected");return}w(!0),S(null);try{const P={name:f.trim(),start_date:v,end_date:p?v:y,is_milestone:p,color:(t==null?void 0:t.color)||"#ec4899"};if(n.phantomPreset){const{predecessorId:E,dependencyType:I}=n.phantomPreset,M=($=N==null?void 0:N.phases)==null?void 0:$.find(B=>B.id===E);if(M){let B=0;const C=new Date(v),R=new Date(M.start_date.split("T")[0]),A=new Date(M.end_date.split("T")[0]);if(I==="SS")B=Math.round((C.getTime()-R.getTime())/(1e3*60*60*24));else{const z=new Date(A);z.setDate(z.getDate()+1),B=Math.round((C.getTime()-z.getTime())/(1e3*60*60*24))}P.dependencies=[{id:E,type:I,lag:B}];const H=M.order_index??0;P.order_index=H+1}else console.warn("[PhaseModal] sourcePhase not found for predecessorId:",E)}if(c&&t)await ia(t.id,P);else if(await Q1(d,P),o(d),N){const E=new Date(P.start_date),I=new Date(P.end_date);await sh(N,"expand",E,I)}const k=await Ke();i(k),s()}catch(P){S(P instanceof Error?P.message:"Failed to save phase")}finally{w(!1)}},L=async()=>{if(!(!c||!t||!d)&&confirm("Are you sure you want to delete this phase? This will also delete all subphases and assignments.")){w(!0),S(null);try{await Hp(t.id);const j=await Ke();if(N){const $=j.find(P=>P.id===N.id);if($)if(await sh($,"shrink")){const k=await Ke();i(k)}else i(j);else i(j)}else i(j);s()}catch(j){S(j instanceof Error?j.message:"Failed to delete phase")}finally{w(!1)}}},T=a.jsxs("div",{className:de.footer,children:[c&&a.jsx(ae,{variant:"danger",onClick:L,disabled:x,className:de.deleteBtn,children:"Delete Phase"}),a.jsxs("div",{className:de.footerRight,children:[a.jsx(ae,{variant:"secondary",onClick:s,disabled:x,children:"Cancel"}),a.jsx(ae,{variant:"primary",onClick:D,disabled:x,children:x?"Saving...":c?"Save Changes":"Add Phase"})]})]});return a.jsx(_t,{isOpen:l,onClose:s,title:c?"Edit Phase":"Add Phase",size:"md",footer:T,children:a.jsxs("form",{onSubmit:D,className:de.form,children:[b&&a.jsx("div",{className:de.error,children:b}),a.jsxs("div",{className:de.formGroup,children:[a.jsx("label",{className:de.label,children:"Phase Name *"}),a.jsx("input",{type:"text",className:de.input,value:f,onChange:j=>h(j.target.value),placeholder:"e.g., Preparation, Analytics, Trial, etc.",autoFocus:!0})]}),a.jsx("div",{className:de.formGroup,children:a.jsxs("label",{className:de.checkbox,children:[a.jsx("input",{type:"checkbox",checked:p,onChange:j=>_(j.target.checked)}),a.jsx("span",{children:"Milestone (single date, shown as diamond)"})]})}),a.jsxs("div",{className:de.formRow,children:[a.jsxs("div",{className:de.formGroup,children:[a.jsx("label",{className:de.label,children:p?"Date *":"Start Date *"}),a.jsx("input",{type:"date",className:de.input,value:v,onChange:j=>u(j.target.value)})]}),!p&&a.jsxs("div",{className:de.formGroup,children:[a.jsx("label",{className:de.label,children:"End Date *"}),a.jsx("input",{type:"date",className:de.input,value:y,onChange:j=>m(j.target.value)})]})]}),c&&(t==null?void 0:t.staffAssignments)&&t.staffAssignments.length>0&&a.jsxs("div",{className:de.assignmentsSection,children:[a.jsx("label",{className:de.label,children:"Assigned Staff"}),a.jsx("div",{className:de.assignmentsList,children:t.staffAssignments.map(j=>a.jsxs("div",{className:de.assignmentItem,children:[a.jsx("span",{className:de.assignmentName,children:j.staff_name||`Staff #${j.staff_id}`}),a.jsxs("span",{className:de.assignmentAllocation,children:[j.allocation,"%"]})]},j.id))})]})]})})}function Do(e,t){for(const n of e){const s=nu(n.children||[],t);if(s)return s}return null}function nu(e,t){for(const n of e){if(n.id===t)return n;if(n.children&&n.children.length>0){const s=nu(n.children,t);if(s)return s}}return null}function d4(e,t){for(const n of e)if(nu(n.children||[],t))return n;return null}function u4(e){const t=e.children||[];if(t.length===0)return null;let n=null,s=null;const r=i=>{for(const o of i){const l=new Date(o.start_date),c=new Date(o.end_date);(!n||l<n)&&(n=l),(!s||c>s)&&(s=c),o.children&&o.children.length>0&&r(o.children)}};return r(t),n&&s?{start:n,end:s}:null}function f4(e){const t=e.phases||[];if(t.length===0)return null;let n=null,s=null;for(const r of t){const i=new Date(r.start_date),o=new Date(r.end_date);(!n||i<n)&&(n=i),(!s||o>s)&&(s=o)}return n&&s?{start:n,end:s}:null}function h4(e){const t=e.children||[];if(t.length===0)return null;let n=null,s=null;const r=i=>{for(const o of i){const l=new Date(o.start_date),c=new Date(o.end_date);(!n||l<n)&&(n=l),(!s||c>s)&&(s=c),o.children&&o.children.length>0&&r(o.children)}};return r(t),n&&s?{start:n,end:s}:null}function m4(e,t){const n=[],s=Do(e,t);if(!s)return n;let r=s;for(;r&&r.parent_subphase_id;){const i=Do(e,r.parent_subphase_id);if(i)n.push(i),r=i;else break}return n}async function ah(e,t,n,s,r,i){var x;const o={subphasesUpdated:0,phaseUpdated:!1,projectUpdated:!1},l=(x=e.phases)==null?void 0:x.find(w=>w.id===t);if(!l||!e.start_date||!e.end_date)return o;let c=s,d=r;if(i){const w=m4(e.phases||[],i),b=Do(e.phases||[],i);b&&w.unshift(b);for(const S of w){const N=new Date(S.start_date),D=new Date(S.end_date);let L=N,T=D;if(n==="expand"&&c&&d)c<N&&(L=c),d>D&&(T=d);else if(n==="shrink"){const j=h4(S);j&&(L=j.start,T=j.end)}(L.getTime()!==N.getTime()||T.getTime()!==D.getTime())&&(console.log("[Cascade] Updating parent subphase dates:",{subphaseId:S.id,name:S.name,oldStart:S.start_date,oldEnd:S.end_date,newStart:L.toISOString().split("T")[0],newEnd:T.toISOString().split("T")[0]}),await Ps(S.id,{start_date:L.toISOString().split("T")[0],end_date:T.toISOString().split("T")[0]}),o.subphasesUpdated++,S.start_date=L.toISOString().split("T")[0],S.end_date=T.toISOString().split("T")[0]),c=L,d=T}}const f=new Date(l.start_date),h=new Date(l.end_date);let p=f,_=h;if(n==="expand"&&c&&d)c<f&&(p=c),d>h&&(_=d);else if(n==="shrink"){const w=u4(l);w&&(p=w.start,_=w.end)}(p.getTime()!==f.getTime()||_.getTime()!==h.getTime())&&(console.log("[Cascade] Updating phase dates:",{phaseId:t,oldStart:l.start_date,oldEnd:l.end_date,newStart:p.toISOString().split("T")[0],newEnd:_.toISOString().split("T")[0]}),await ia(t,{start_date:p.toISOString().split("T")[0],end_date:_.toISOString().split("T")[0]}),o.phaseUpdated=!0,l.start_date=p.toISOString().split("T")[0],l.end_date=_.toISOString().split("T")[0]);const v=new Date(e.start_date),u=new Date(e.end_date);let y=v,m=u;if(n==="expand")p<v&&(y=p),_>u&&(m=_);else if(n==="shrink"){const w=f4(e);w&&(y=w.start,m=w.end)}return(y.getTime()!==v.getTime()||m.getTime()!==u.getTime())&&(console.log("[Cascade] Updating project dates:",{projectId:e.id,oldStart:e.start_date,oldEnd:e.end_date,newStart:y.toISOString().split("T")[0],newEnd:m.toISOString().split("T")[0]}),await si(e.id,{start_date:y.toISOString().split("T")[0],end_date:m.toISOString().split("T")[0]}),o.projectUpdated=!0),o}function p4(){const{activeModal:e,editingSubphase:t,modalContext:n,closeModal:s}=Z(),{projects:r,setProjects:i,ensurePhaseExpanded:o,ensureSubphaseExpanded:l}=F(),c=e==="subphase",d=!!t,f=n.projectId,h=(t==null?void 0:t.parent_phase_id)||n.phaseId,p=n.subphaseId,[_,v]=g.useState(""),[u,y]=g.useState(!1),[m,x]=g.useState(""),[w,b]=g.useState(""),[S,N]=g.useState(!1),[D,L]=g.useState(null),T=g.useMemo(()=>f&&r.find(E=>E.id===f)||null,[r,f]),j=g.useMemo(()=>{var E;return!T||!h?null:((E=T.phases)==null?void 0:E.find(I=>I.id===h))||null},[T,h]);g.useEffect(()=>{if(c){if(t)v(t.name),y(!!t.is_milestone),x(ke(t.start_date)),b(ke(t.end_date));else if(n.phantomPreset)v(""),y(!1),x(ke(n.phantomPreset.startDate)),b(ke(n.phantomPreset.endDate));else{const E=new Date().toISOString().split("T")[0],I=ke(j==null?void 0:j.start_date)||E,M=ke(j==null?void 0:j.end_date)||E;v(""),y(!1),x(I),b(M)}L(null)}},[c,t,j,n.phantomPreset]),g.useEffect(()=>{u&&m&&b(m)},[u,m]);const $=async E=>{if(E.preventDefault(),!_.trim()){L("Please enter a subphase name");return}if(!m){L("Please select a start date");return}if(!u&&!w){L("Please select an end date");return}if(!h){L("No parent phase selected");return}N(!0),L(null);try{const I={name:_.trim(),start_date:m,end_date:u?m:w,is_milestone:u,color:(t==null?void 0:t.color)||(j==null?void 0:j.color)||"#ec4899"};if(n.phantomPreset){const{predecessorId:R,dependencyType:A}=n.phantomPreset,H=r.find(K=>K.id===f),z=Do((H==null?void 0:H.phases)||[],R);if(z){let K=0;const Q=new Date(m),Y=new Date(z.start_date.split("T")[0]),J=new Date(z.end_date.split("T")[0]);if(A==="SS")K=Math.round((Q.getTime()-Y.getTime())/(1e3*60*60*24));else{const O=new Date(J);O.setDate(O.getDate()+1),K=Math.round((Q.getTime()-O.getTime())/(1e3*60*60*24))}I.dependencies=[{id:R,type:A,lag:K}];const ne=z.order_index??0;I.order_index=ne+1}}let M=null,B;if(d&&t)await Ps(t.id,I);else if(p&&f)await X1(p,f,I),l(p),M=h||null,B=p;else if(h&&f)await Y1(h,f,I),o(h),M=h;else throw new Error("Missing phaseId or projectId");if(M&&!d&&T){const R=new Date(I.start_date),A=new Date(I.end_date);await ah(T,M,"expand",R,A,B)}const C=await Ke();i(C),s()}catch(I){L(I instanceof Error?I.message:"Failed to save subphase")}finally{N(!1)}},P=async()=>{if(!(!d||!t)&&confirm("Are you sure you want to delete this subphase? This will also delete all nested subphases and assignments.")){N(!0),L(null);try{const E=T?d4(T.phases||[],t.id):null,I=t.parent_subphase_id||void 0;await qp(t.id);const M=await Ke();if(E&&T){const B=M.find(C=>C.id===T.id);if(B){await ah(B,E.id,"shrink",void 0,void 0,I);const C=await Ke();i(C)}else i(M)}else i(M);s()}catch(E){L(E instanceof Error?E.message:"Failed to delete subphase")}finally{N(!1)}}},k=a.jsxs("div",{className:de.footer,children:[d&&a.jsx(ae,{variant:"danger",onClick:P,disabled:S,className:de.deleteBtn,children:"Delete Subphase"}),a.jsxs("div",{className:de.footerRight,children:[a.jsx(ae,{variant:"secondary",onClick:s,disabled:S,children:"Cancel"}),a.jsx(ae,{variant:"primary",onClick:$,disabled:S,children:S?"Saving...":d?"Save Changes":"Add Subphase"})]})]});return a.jsx(_t,{isOpen:c,onClose:s,title:d?"Edit Subphase":"Add Subphase",size:"md",footer:k,children:a.jsxs("form",{onSubmit:$,className:de.form,children:[D&&a.jsx("div",{className:de.error,children:D}),j&&a.jsxs("div",{className:de.contextInfo,children:["Parent: ",a.jsx("strong",{children:j.name})]}),a.jsxs("div",{className:de.formGroup,children:[a.jsx("label",{className:de.label,children:"Subphase Name *"}),a.jsx("input",{type:"text",className:de.input,value:_,onChange:E=>v(E.target.value),placeholder:"e.g., Task 1, Setup, Review, etc.",autoFocus:!0})]}),a.jsx("div",{className:de.formGroup,children:a.jsxs("label",{className:de.checkbox,children:[a.jsx("input",{type:"checkbox",checked:u,onChange:E=>y(E.target.checked)}),a.jsx("span",{children:"Milestone (single date, shown as diamond)"})]})}),a.jsxs("div",{className:de.formRow,children:[a.jsxs("div",{className:de.formGroup,children:[a.jsx("label",{className:de.label,children:u?"Date *":"Start Date *"}),a.jsx("input",{type:"date",className:de.input,value:m,onChange:E=>x(E.target.value)})]}),!u&&a.jsxs("div",{className:de.formGroup,children:[a.jsx("label",{className:de.label,children:"End Date *"}),a.jsx("input",{type:"date",className:de.input,value:w,onChange:E=>b(E.target.value)})]})]})]})})}const g4="_form_3pabh_3",_4="_formGroup_3pabh_9",y4="_formRow_3pabh_15",v4="_label_3pabh_21",x4="_input_3pabh_27",w4="_contextInfo_3pabh_48",j4="_error_3pabh_60",S4="_sliderContainer_3pabh_70",k4="_slider_3pabh_70",N4="_sliderLabels_3pabh_112",b4="_footer_3pabh_120",C4="_footerRight_3pabh_127",D4="_deleteBtn_3pabh_133",he={form:g4,formGroup:_4,formRow:y4,label:v4,input:x4,contextInfo:w4,error:j4,sliderContainer:S4,slider:k4,sliderLabels:N4,footer:b4,footerRight:C4,deleteBtn:D4};function $4(){const{activeModal:e,editingStaffAssignment:t,modalContext:n,closeModal:s}=Z(),{projects:r,staff:i,currentSite:o,setProjects:l}=F(),c=e==="staffAssignment",d=!!t,[f,h]=g.useState(""),[p,_]=g.useState(100),[v,u]=g.useState(""),[y,m]=g.useState(""),[x,w]=g.useState(!1),[b,S]=g.useState(null),N=(t==null?void 0:t.project_id)||n.projectId,D=(t==null?void 0:t.phase_id)||n.phaseId,L=(t==null?void 0:t.subphase_id)||n.subphaseId,T=g.useMemo(()=>o?i.filter(M=>M.site_id===o.id):[],[i,o]),j=g.useMemo(()=>{var B;if(!N)return null;const M=r.find(C=>C.id===N);return M?L?(R=>{for(const A of R||[]){const H=K=>{for(const Q of K||[]){if(Q.id===L)return Q;const Y=H(Q.children||[]);if(Y)return Y}return null},z=H(A.children||[]);if(z)return z}return null})(M.phases||[]):D?((B=M.phases)==null?void 0:B.find(C=>C.id===D))||null:M:null},[r,N,D,L]);g.useEffect(()=>{if(c){if(t)h(t.staff_id.toString()),_(t.allocation),u(ke(t.start_date)),m(ke(t.end_date));else{const M=new Date().toISOString().split("T")[0];h(""),_(100),u(ke(j==null?void 0:j.start_date)||M),m(ke(j==null?void 0:j.end_date)||M)}S(null)}},[c,t,j]);const $=async M=>{if(M.preventDefault(),!f){S("Please select a staff member");return}if(!v||!y){S("Please select start and end dates");return}if(p<1||p>100){S("Allocation must be between 1 and 100");return}w(!0),S(null);try{const B={staff_id:parseInt(f),allocation:p,start_date:v,end_date:y,project_id:N||void 0,phase_id:D||void 0,subphase_id:L||void 0};d&&t?await Qo(t.id,B):await K1(B);const C=await Ke();l(C),s()}catch(B){S(B instanceof Error?B.message:"Failed to save assignment")}finally{w(!1)}},P=async()=>{if(!(!d||!t)&&confirm("Are you sure you want to remove this staff assignment?")){w(!0),S(null);try{await Z1(t.id);const M=await Ke();l(M),s()}catch(M){S(M instanceof Error?M.message:"Failed to delete assignment")}finally{w(!1)}}},k=L?"Subphase":D?"Phase":"Project",E=(j==null?void 0:j.name)||"Unknown",I=a.jsxs("div",{className:he.footer,children:[d&&a.jsx(ae,{variant:"danger",onClick:P,disabled:x,className:he.deleteBtn,children:"Remove Assignment"}),a.jsxs("div",{className:he.footerRight,children:[a.jsx(ae,{variant:"secondary",onClick:s,disabled:x,children:"Cancel"}),a.jsx(ae,{variant:"primary",onClick:$,disabled:x,children:x?"Saving...":d?"Save Changes":"Assign Staff"})]})]});return a.jsx(_t,{isOpen:c,onClose:s,title:d?"Edit Staff Assignment":"Assign Staff",size:"md",footer:I,children:a.jsxs("form",{onSubmit:$,className:he.form,children:[b&&a.jsx("div",{className:he.error,children:b}),a.jsxs("div",{className:he.contextInfo,children:[k,": ",a.jsx("strong",{children:E})]}),a.jsxs("div",{className:he.formGroup,children:[a.jsx("label",{className:he.label,children:"Staff Member *"}),a.jsxs("select",{className:he.input,value:f,onChange:M=>h(M.target.value),disabled:d,children:[a.jsx("option",{value:"",children:"Select staff member"}),T.map(M=>a.jsxs("option",{value:M.id,children:[M.name," (",M.role||"No role",")"]},M.id))]})]}),a.jsxs("div",{className:he.formGroup,children:[a.jsxs("label",{className:he.label,children:["Allocation: ",p,"%"]}),a.jsxs("div",{className:he.sliderContainer,children:[a.jsx("input",{type:"range",className:he.slider,min:"1",max:"100",value:p,onChange:M=>_(parseInt(M.target.value))}),a.jsxs("div",{className:he.sliderLabels,children:[a.jsx("span",{children:"1%"}),a.jsx("span",{children:"50%"}),a.jsx("span",{children:"100%"})]})]})]}),a.jsxs("div",{className:he.formRow,children:[a.jsxs("div",{className:he.formGroup,children:[a.jsx("label",{className:he.label,children:"Start Date *"}),a.jsx("input",{type:"date",className:he.input,value:v,onChange:M=>u(M.target.value)})]}),a.jsxs("div",{className:he.formGroup,children:[a.jsx("label",{className:he.label,children:"End Date *"}),a.jsx("input",{type:"date",className:he.input,value:y,onChange:M=>m(M.target.value)})]})]})]})})}function E4(){const{activeModal:e,editingEquipmentAssignment:t,modalContext:n,closeModal:s}=Z(),{projects:r,equipment:i,currentSite:o,setProjects:l}=F(),c=e==="equipmentAssignment",d=!!t,[f,h]=g.useState(""),[p,_]=g.useState(""),[v,u]=g.useState(""),[y,m]=g.useState(!1),[x,w]=g.useState(null),b=(t==null?void 0:t.project_id)||n.projectId,S=(t==null?void 0:t.phase_id)||n.phaseId,N=(t==null?void 0:t.subphase_id)||n.subphaseId,D=g.useMemo(()=>o?i.filter(E=>E.site_id===o.id):[],[i,o]),L=g.useMemo(()=>{var I;if(!b)return null;const E=r.find(M=>M.id===b);return E?N?(B=>{for(const C of B||[]){const R=H=>{for(const z of H||[]){if(z.id===N)return z;const K=R(z.children||[]);if(K)return K}return null},A=R(C.children||[]);if(A)return A}return null})(E.phases||[]):S?((I=E.phases)==null?void 0:I.find(M=>M.id===S))||null:E:null},[r,b,S,N]);g.useEffect(()=>{if(c){if(t)h(t.equipment_id.toString()),_(ke(t.start_date)),u(ke(t.end_date));else{const E=new Date().toISOString().split("T")[0];h(""),_(ke(L==null?void 0:L.start_date)||E),u(ke(L==null?void 0:L.end_date)||E)}w(null)}},[c,t,L]);const T=async E=>{if(E.preventDefault(),!f){w("Please select equipment");return}if(!p||!v){w("Please select start and end dates");return}m(!0),w(null);try{const I={equipment_id:parseInt(f),start_date:p,end_date:v,project_id:b||void 0,phase_id:S||void 0,subphase_id:N||void 0};d&&t?await Yo(t.id,I):await J1(I);const M=await Ke();l(M),s()}catch(I){w(I instanceof Error?I.message:"Failed to save assignment")}finally{m(!1)}},j=async()=>{if(!(!d||!t)&&confirm("Are you sure you want to remove this equipment assignment?")){m(!0),w(null);try{await ev(t.id);const E=await Ke();l(E),s()}catch(E){w(E instanceof Error?E.message:"Failed to delete assignment")}finally{m(!1)}}},$=N?"Subphase":S?"Phase":"Project",P=(L==null?void 0:L.name)||"Unknown",k=a.jsxs("div",{className:he.footer,children:[d&&a.jsx(ae,{variant:"danger",onClick:j,disabled:y,className:he.deleteBtn,children:"Remove Assignment"}),a.jsxs("div",{className:he.footerRight,children:[a.jsx(ae,{variant:"secondary",onClick:s,disabled:y,children:"Cancel"}),a.jsx(ae,{variant:"primary",onClick:T,disabled:y,children:y?"Saving...":d?"Save Changes":"Assign Equipment"})]})]});return a.jsx(_t,{isOpen:c,onClose:s,title:d?"Edit Equipment Assignment":"Assign Equipment",size:"md",footer:k,children:a.jsxs("form",{onSubmit:T,className:he.form,children:[x&&a.jsx("div",{className:he.error,children:x}),a.jsxs("div",{className:he.contextInfo,children:[$,": ",a.jsx("strong",{children:P})]}),a.jsxs("div",{className:he.formGroup,children:[a.jsx("label",{className:he.label,children:"Equipment *"}),a.jsxs("select",{className:he.input,value:f,onChange:E=>h(E.target.value),disabled:d,children:[a.jsx("option",{value:"",children:"Select equipment"}),D.map(E=>a.jsxs("option",{value:E.id,children:[E.name," (",E.type||"No type",")"]},E.id))]})]}),a.jsxs("div",{className:he.formRow,children:[a.jsxs("div",{className:he.formGroup,children:[a.jsx("label",{className:he.label,children:"Start Date *"}),a.jsx("input",{type:"date",className:he.input,value:p,onChange:E=>_(E.target.value)})]}),a.jsxs("div",{className:he.formGroup,children:[a.jsx("label",{className:he.label,children:"End Date *"}),a.jsx("input",{type:"date",className:he.input,value:v,onChange:E=>u(E.target.value)})]})]})]})})}const T4="_content_ltqk2_3",P4="_error_ltqk2_9",M4="_staffDisplay_ltqk2_19",I4="_staffAvatar_ltqk2_29",L4="_staffInfo_ltqk2_43",A4="_staffName_ltqk2_50",R4="_staffRole_ltqk2_56",B4="_noStaff_ltqk2_62",F4="_section_ltqk2_76",O4="_sectionLabel_ltqk2_82",H4="_optional_ltqk2_90",q4="_dateRow_ltqk2_98",z4="_dateField_ltqk2_104",W4="_label_ltqk2_111",U4="_dateSeparator_ltqk2_117",V4="_input_ltqk2_127",G4="_duration_ltqk2_154",Q4="_footer_ltqk2_170",Y4="_exportBtn_ltqk2_181",Ee={content:T4,error:P4,staffDisplay:M4,staffAvatar:I4,staffInfo:L4,staffName:A4,staffRole:R4,noStaff:B4,section:F4,sectionLabel:O4,optional:H4,dateRow:q4,dateField:z4,label:W4,dateSeparator:U4,input:V4,duration:G4,footer:Q4,exportBtn:Y4},X4=g.memo(function({onCancel:t,onSaveAndExport:n,onSave:s,isSubmitting:r,canSubmit:i}){return a.jsxs("div",{className:Ee.footer,children:[a.jsx(ae,{type:"button",variant:"secondary",onClick:t,disabled:r,children:"Cancel"}),a.jsxs(ae,{type:"button",variant:"secondary",onClick:n,disabled:r||!i,title:"Save vacation and export to Outlook calendar",className:Ee.exportBtn,children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a.jsx("polyline",{points:"7 10 12 15 17 10"}),a.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),"Save & Export to Outlook"]}),a.jsx(ae,{type:"button",variant:"primary",onClick:s,disabled:r||!i,children:r?"Saving...":"Save"})]})});function K4(){var k;const{activeModal:e,editingVacation:t,modalContext:n,closeModal:s}=Z(),{staff:r,setVacations:i}=F(),o=e==="vacation",l=!!t,[c,d]=g.useState(null),[f,h]=g.useState(""),[p,_]=g.useState(""),[v,u]=g.useState(!1),[y,m]=g.useState(null),x=g.useRef(null),w=g.useRef(!1),b=g.useMemo(()=>c?r.find(E=>E.id===c):null,[r,c]);g.useEffect(()=>{if(o&&!w.current){if(w.current=!0,t)d(t.staff_id),h(ke(t.start_date)),_(ke(t.end_date)),x.current&&(x.current.value=t.description||"");else{d(n.staffId||null);const E=new Date,I=new Date(E);I.setDate(E.getDate()+((8-E.getDay())%7||7));const M=new Date(I);M.setDate(I.getDate()+4),h(ke(I.toISOString())),_(ke(M.toISOString())),x.current&&(x.current.value="")}m(null)}o||(w.current=!1)},[o,t,n.staffId]);const S=g.useMemo(()=>{if(!f||!p)return 0;const E=new Date(f),M=new Date(p).getTime()-E.getTime();return Math.ceil(M/(1e3*60*60*24))+1},[f,p]),N=g.useCallback(()=>{s(),m(null)},[s]),D=g.useCallback(async()=>{var I;const E=((I=x.current)==null?void 0:I.value)||"";if(!c)return m("No staff member selected"),!1;if(!f||!p)return m("Please select start and end dates"),!1;if(new Date(f)>new Date(p))return m("Start date must be before end date"),!1;u(!0),m(null);try{const M={staff_id:c,start_date:f,end_date:p,description:E||"Vacation"};l&&t?await mv(t.id,M):await hv(M);const B=await Xd();return i(B),!0}catch(M){return console.error("Failed to save vacation:",M),m(M instanceof Error?M.message:"Failed to save vacation"),!1}finally{u(!1)}},[c,f,p,l,t,i]),L=g.useCallback(async()=>{await D()&&N()},[D,N]),T=g.useCallback(()=>{var A;const E=(b==null?void 0:b.name)||"Staff",I=((A=x.current)==null?void 0:A.value)||"Vacation",M=Z4({summary:I,description:`${E} - Time Off`,startDate:new Date(f),endDate:new Date(p)}),B=new Blob([M],{type:"text/calendar;charset=utf-8"}),C=URL.createObjectURL(B),R=document.createElement("a");R.href=C,R.download=`vacation-${E.replace(/\s+/g,"-").toLowerCase()}-${f}.ics`,document.body.appendChild(R),R.click(),document.body.removeChild(R),URL.revokeObjectURL(C)},[b==null?void 0:b.name,f,p]),j=g.useCallback(async()=>{await D()&&(T(),N())},[D,T,N]),$=!!c&&!!f&&!!p,P=g.useMemo(()=>a.jsx(X4,{onCancel:N,onSaveAndExport:j,onSave:L,isSubmitting:v,canSubmit:$}),[N,j,L,v,$]);return o?a.jsx(_t,{isOpen:o,onClose:N,title:l?"Edit Vacation":"Add Vacation",size:"md",footer:P,children:a.jsxs("div",{className:Ee.content,children:[y&&a.jsx("div",{className:Ee.error,children:y}),b?a.jsxs("div",{className:Ee.staffDisplay,children:[a.jsx("div",{className:Ee.staffAvatar,children:((k=b.name)==null?void 0:k.charAt(0).toUpperCase())||"?"}),a.jsxs("div",{className:Ee.staffInfo,children:[a.jsx("div",{className:Ee.staffName,children:b.name}),b.role&&a.jsx("div",{className:Ee.staffRole,children:b.role})]})]}):a.jsxs("div",{className:Ee.noStaff,children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"8",r:"4"}),a.jsx("path",{d:"M20 21a8 8 0 1 0-16 0"})]}),a.jsx("span",{children:"No staff member selected"})]}),a.jsxs("div",{className:Ee.section,children:[a.jsx("label",{className:Ee.sectionLabel,children:"Duration"}),a.jsxs("div",{className:Ee.dateRow,children:[a.jsxs("div",{className:Ee.dateField,children:[a.jsx("label",{className:Ee.label,children:"From"}),a.jsx("input",{type:"date",className:Ee.input,value:f,onChange:E=>h(E.target.value)})]}),a.jsx("div",{className:Ee.dateSeparator,children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}),a.jsx("polyline",{points:"12 5 19 12 12 19"})]})}),a.jsxs("div",{className:Ee.dateField,children:[a.jsx("label",{className:Ee.label,children:"To"}),a.jsx("input",{type:"date",className:Ee.input,value:p,onChange:E=>_(E.target.value)})]})]}),S>0&&a.jsxs("div",{className:Ee.duration,children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),a.jsx("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),a.jsx("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),a.jsx("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),S," day",S!==1?"s":""]})]}),a.jsxs("div",{className:Ee.section,children:[a.jsxs("label",{className:Ee.sectionLabel,htmlFor:"vacation-description",children:["Description ",a.jsx("span",{className:Ee.optional,children:"(optional)"})]}),a.jsx("input",{ref:x,id:"vacation-description",type:"text",className:Ee.input,defaultValue:(t==null?void 0:t.description)||"",placeholder:"e.g., Annual Leave, Personal Day...",autoComplete:"off"})]})]})}):null}function Z4(e){const{summary:t,description:n,startDate:s,endDate:r}=e,i=(f,h)=>{const p=f.getFullYear(),_=String(f.getMonth()+1).padStart(2,"0"),v=String(f.getDate()).padStart(2,"0");if(h)return`${p}${_}${v}`;const u=String(f.getUTCHours()).padStart(2,"0"),y=String(f.getUTCMinutes()).padStart(2,"0"),m=String(f.getUTCSeconds()).padStart(2,"0");return`${p}${_}${v}T${u}${y}${m}Z`},o=new Date(r);o.setDate(o.getDate()+1);const l=`vacation-${Date.now()}-${Math.random().toString(36).substr(2,9)}@milestone`,c=i(new Date,!1);return["BEGIN:VCALENDAR","VERSION:2.0","PRODID:-//Milestone//Vacation Export//EN","CALSCALE:GREGORIAN","METHOD:PUBLISH","BEGIN:VEVENT",`UID:${l}`,`DTSTAMP:${c}`,`DTSTART;VALUE=DATE:${i(s,!0)}`,`DTEND;VALUE=DATE:${i(o,!0)}`,`SUMMARY:${rh(t)}`,`DESCRIPTION:${rh(n)}`,"STATUS:CONFIRMED","TRANSP:OPAQUE","X-MICROSOFT-CDO-BUSYSTATUS:OOF","X-MICROSOFT-CDO-ALLDAYEVENT:TRUE","END:VEVENT","END:VCALENDAR"].join(`\r
`)}function rh(e){return e.replace(/\\/g,"\\\\").replace(/;/g,"\\;").replace(/,/g,"\\,").replace(/\n/g,"\\n")}const J4="_container_18znu_3",eT="_error_18znu_10",tT="_toolbar_18znu_19",nT="_yearSelector_18znu_28",sT="_label_18znu_34",aT="_select_18znu_40",rT="_toolbarActions_18znu_55",iT="_addForm_18znu_61",oT="_addFormRow_18znu_70",lT="_input_18znu_76",cT="_addFormActions_18znu_94",dT="_holidaysList_18znu_101",uT="_loading_18znu_107",fT="_empty_18znu_108",hT="_section_18znu_118",mT="_sectionTitle_18znu_122",pT="_holidayItems_18znu_131",gT="_holidayItem_18znu_131",_T="_custom_18znu_148",yT="_holidayDate_18znu_153",vT="_holidayName_18znu_159",xT="_deleteBtn_18znu_163",wT="_footer_18znu_184",jT="_footerInfo_18znu_192",ye={container:J4,error:eT,toolbar:tT,yearSelector:nT,label:sT,select:aT,toolbarActions:rT,addForm:iT,addFormRow:oT,input:lT,addFormActions:cT,holidaysList:dT,loading:uT,empty:fT,section:hT,sectionTitle:mT,holidayItems:pT,holidayItem:gT,custom:_T,holidayDate:yT,holidayName:vT,deleteBtn:xT,footer:wT,footerInfo:jT};function ST(){const{activeModal:e,closeModal:t}=Z(),{currentSite:n,bankHolidays:s,setBankHolidays:r}=F(),i=e==="bankHoliday",[o,l]=g.useState(new Date().getFullYear()),[c,d]=g.useState(!1),[f,h]=g.useState(!1),[p,_]=g.useState(null),[v,u]=g.useState(""),[y,m]=g.useState(""),[x,w]=g.useState(""),b=g.useMemo(()=>{const I=new Date().getFullYear();return[I-1,I,I+1,I+2]},[]),S=g.useMemo(()=>s.filter(I=>new Date(I.date).getFullYear()===o).sort((I,M)=>new Date(I.date).getTime()-new Date(M.date).getTime()),[s,o]),N=S.filter(I=>I.is_custom),D=S.filter(I=>!I.is_custom);g.useEffect(()=>{i&&n&&L()},[i,n,o]);const L=async()=>{if(n){d(!0),_(null);try{const I=await ks(n.id,o);r(I,$n(I))}catch(I){console.error("Failed to load holidays:",I),_("Failed to load holidays")}finally{d(!1)}}},T=async()=>{if(n){d(!0),_(null);try{const I=await Vp(n.id);r(I,$n(I))}catch(I){console.error("Failed to refresh holidays:",I),_("Failed to refresh holidays from API")}finally{d(!1)}}},j=async I=>{if(I.preventDefault(),!(!n||!v||!x)){d(!0),_(null);try{await lv(n.id,{date:v,end_date:y||void 0,name:x});const M=await ks(n.id);r(M,$n(M)),u(""),m(""),w(""),h(!1)}catch(M){console.error("Failed to add holiday:",M),_("Failed to add custom holiday")}finally{d(!1)}}},$=async I=>{if(n&&window.confirm(`Delete "${I.name}"?`)){d(!0),_(null);try{await cv(n.id,I.id);const M=await ks(n.id);r(M,$n(M))}catch(M){console.error("Failed to delete holiday:",M),_("Failed to delete holiday")}finally{d(!1)}}},P=()=>{var R;if(S.length===0)return;const I=kT(S,(n==null?void 0:n.name)||"Site"),M=new Blob([I],{type:"text/calendar;charset=utf-8"}),B=URL.createObjectURL(M),C=document.createElement("a");C.href=B,C.download=`bank-holidays-${((R=n==null?void 0:n.name)==null?void 0:R.toLowerCase().replace(/\s+/g,"-"))||"site"}-${o}.ics`,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(B)},k=()=>{t(),h(!1),_(null)},E=I=>new Date(I).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"});return i?a.jsx(_t,{isOpen:i,onClose:k,title:`Bank Holidays - ${(n==null?void 0:n.name)||""}`,size:"md",children:a.jsxs("div",{className:ye.container,children:[p&&a.jsx("div",{className:ye.error,children:p}),a.jsxs("div",{className:ye.toolbar,children:[a.jsxs("div",{className:ye.yearSelector,children:[a.jsx("label",{className:ye.label,children:"Year:"}),a.jsx("select",{className:ye.select,value:o,onChange:I=>l(parseInt(I.target.value,10)),children:b.map(I=>a.jsx("option",{value:I,children:I},I))})]}),a.jsxs("div",{className:ye.toolbarActions,children:[a.jsx(ae,{variant:"secondary",size:"sm",onClick:T,disabled:c,title:"Refresh from Nager.Date API",children:c?"Refreshing...":"Refresh"}),a.jsx(ae,{variant:"secondary",size:"sm",onClick:P,disabled:S.length===0,title:"Export all holidays to ICS",children:"Export ICS"}),a.jsx(ae,{variant:"primary",size:"sm",onClick:()=>h(!0),disabled:f,children:"Add Custom"})]})]}),f&&a.jsxs("form",{onSubmit:j,className:ye.addForm,children:[a.jsxs("div",{className:ye.addFormRow,children:[a.jsx("input",{type:"text",className:ye.input,placeholder:"Holiday name...",value:x,onChange:I=>w(I.target.value),required:!0}),a.jsx("input",{type:"date",className:ye.input,value:v,onChange:I=>u(I.target.value),required:!0}),a.jsx("input",{type:"date",className:ye.input,value:y,onChange:I=>m(I.target.value),placeholder:"End date (optional)"})]}),a.jsxs("div",{className:ye.addFormActions,children:[a.jsx(ae,{type:"button",variant:"secondary",size:"sm",onClick:()=>h(!1),children:"Cancel"}),a.jsx(ae,{type:"submit",variant:"primary",size:"sm",disabled:c||!x||!v,children:"Add"})]})]}),a.jsx("div",{className:ye.holidaysList,children:c&&S.length===0?a.jsx("div",{className:ye.loading,children:"Loading holidays..."}):S.length===0?a.jsxs("div",{className:ye.empty,children:["No holidays for ",o]}):a.jsxs(a.Fragment,{children:[D.length>0&&a.jsxs("div",{className:ye.section,children:[a.jsxs("h3",{className:ye.sectionTitle,children:["Public Holidays (",D.length,")"]}),a.jsx("div",{className:ye.holidayItems,children:D.map(I=>a.jsxs("div",{className:ye.holidayItem,children:[a.jsxs("div",{className:ye.holidayDate,children:[E(I.date),I.end_date&&I.end_date!==I.date&&a.jsxs("span",{children:[" - ",E(I.end_date)]})]}),a.jsx("div",{className:ye.holidayName,children:I.name})]},I.id))})]}),N.length>0&&a.jsxs("div",{className:ye.section,children:[a.jsxs("h3",{className:ye.sectionTitle,children:["Custom Holidays (",N.length,")"]}),a.jsx("div",{className:ye.holidayItems,children:N.map(I=>a.jsxs("div",{className:`${ye.holidayItem} ${ye.custom}`,children:[a.jsxs("div",{className:ye.holidayDate,children:[E(I.date),I.end_date&&I.end_date!==I.date&&a.jsxs("span",{children:[" - ",E(I.end_date)]})]}),a.jsx("div",{className:ye.holidayName,children:I.name}),a.jsx("button",{className:ye.deleteBtn,onClick:()=>$(I),title:"Delete custom holiday",children:""})]},I.id))})]})]})}),a.jsxs("div",{className:ye.footer,children:[a.jsx("span",{className:ye.footerInfo,children:n!=null&&n.country_code?`Country: ${n.country_code}`:"No country configured"}),a.jsx(ae,{variant:"secondary",onClick:k,children:"Close"})]})]})}):null}function kT(e,t){const n=["BEGIN:VCALENDAR","VERSION:2.0",`PRODID:-//Milestone//${t} Holidays//EN`,"CALSCALE:GREGORIAN","METHOD:PUBLISH"];return e.forEach(s=>{const r=new Date(s.date),i=s.end_date?new Date(s.end_date):r,o=new Date(i);o.setDate(o.getDate()+1);const l=f=>{const h=f.getFullYear(),p=String(f.getMonth()+1).padStart(2,"0"),_=String(f.getDate()).padStart(2,"0");return`${h}${p}${_}`},c=`holiday-${s.id}-${Date.now()}@milestone`,d=new Date().toISOString().replace(/[-:]/g,"").replace(/\.\d{3}/,"");n.push("BEGIN:VEVENT",`UID:${c}`,`DTSTAMP:${d}`,`DTSTART;VALUE=DATE:${l(r)}`,`DTEND;VALUE=DATE:${l(o)}`,`SUMMARY:${ih(s.name)}`,`DESCRIPTION:${ih(`${t} - Bank Holiday`)}`,"STATUS:CONFIRMED","TRANSP:TRANSPARENT","END:VEVENT")}),n.push("END:VCALENDAR"),n.join(`\r
`)}function ih(e){return e.replace(/\\/g,"\\\\").replace(/;/g,"\\;").replace(/,/g,"\\,").replace(/\n/g,"\\n")}const NT="_error_17myg_3",bT="_formGroup_17myg_13",CT="_formRow_17myg_17",DT="_label_17myg_26",$T="_input_17myg_34",ET="_help_17myg_60",TT="_footer_17myg_66",At={error:NT,formGroup:bT,formRow:CT,label:DT,input:$T,help:ET,footer:TT};function PT(){const{activeModal:e,closeModal:t}=Z(),n=F(m=>m.currentSite),s=F(m=>m.setBankHolidays),r=e==="customHoliday",[i,o]=g.useState(""),[l,c]=g.useState(""),[d,f]=g.useState(""),[h,p]=g.useState(!1),[_,v]=g.useState(null);g.useEffect(()=>{r&&(o(""),c(""),f(""),v(null))},[r]);const u=async()=>{if(!n){v("No site selected");return}if(!i.trim()){v("Please enter a holiday name");return}if(!l){v("Please select a start date");return}if(d&&d<l){v("End date must be on or after start date");return}p(!0),v(null);try{await Wp(n.id,{name:i.trim(),date:l,end_date:d||void 0});const m=await ks(n.id),x=$n(m);s(m,x),t()}catch(m){v(m instanceof Error?m.message:"Failed to add custom holiday")}finally{p(!1)}},y=a.jsxs("div",{className:At.footer,children:[a.jsx(ae,{variant:"secondary",onClick:t,children:"Cancel"}),a.jsx(ae,{variant:"primary",onClick:u,disabled:h,children:h?"Adding...":"Add Holiday"})]});return a.jsxs(_t,{isOpen:r,onClose:t,title:"Add Custom Holiday",size:"sm",footer:y,children:[_&&a.jsx("div",{className:At.error,children:_}),a.jsxs("div",{className:At.formGroup,children:[a.jsx("label",{className:At.label,children:"Holiday Name"}),a.jsx("input",{type:"text",className:At.input,value:i,onChange:m=>o(m.target.value),placeholder:"e.g., Company Anniversary",autoFocus:!0})]}),a.jsxs("div",{className:At.formRow,children:[a.jsxs("div",{className:At.formGroup,children:[a.jsx("label",{className:At.label,children:"Start Date"}),a.jsx("input",{type:"date",className:At.input,value:l,onChange:m=>c(m.target.value)})]}),a.jsxs("div",{className:At.formGroup,children:[a.jsx("label",{className:At.label,children:"End Date"}),a.jsx("input",{type:"date",className:At.input,value:d,onChange:m=>f(m.target.value)})]})]}),a.jsxs("p",{className:At.help,children:["Leave end date empty for a single-day holiday. Custom holidays will be applied to ",(n==null?void 0:n.name)||"the current site"," only."]})]})}const MT="_error_6ynm4_3",IT="_section_6ynm4_13",LT="_sectionTitle_6ynm4_28",AT="_formGroup_6ynm4_44",RT="_formRow_6ynm4_48",BT="_label_6ynm4_57",FT="_input_6ynm4_65",OT="_select_6ynm4_87",HT="_help_6ynm4_120",qT="_checkbox_6ynm4_126",zT="_footer_6ynm4_146",WT="_warning_6ynm4_153",UT="_holidayStatusBox_6ynm4_177",VT="_holidayInfo_6ynm4_188",GT="_holidayCount_6ynm4_194",QT="_lastFetch_6ynm4_203",Se={error:MT,section:IT,sectionTitle:LT,formGroup:AT,formRow:RT,label:BT,input:FT,select:OT,help:HT,checkbox:qT,footer:zT,warning:WT,holidayStatusBox:UT,holidayInfo:VT,holidayCount:GT,lastFetch:QT},Li={europe:[{code:"AT",name:"Austria"},{code:"BE",name:"Belgium"},{code:"CH",name:"Switzerland"},{code:"CZ",name:"Czech Republic"},{code:"DE",name:"Germany"},{code:"DK",name:"Denmark"},{code:"ES",name:"Spain"},{code:"FI",name:"Finland"},{code:"FR",name:"France"},{code:"GB",name:"United Kingdom"},{code:"GR",name:"Greece"},{code:"HR",name:"Croatia"},{code:"HU",name:"Hungary"},{code:"IE",name:"Ireland"},{code:"IT",name:"Italy"},{code:"NL",name:"Netherlands"},{code:"NO",name:"Norway"},{code:"PL",name:"Poland"},{code:"PT",name:"Portugal"},{code:"RO",name:"Romania"},{code:"SE",name:"Sweden"}],americas:[{code:"AR",name:"Argentina"},{code:"BR",name:"Brazil"},{code:"CA",name:"Canada"},{code:"CL",name:"Chile"},{code:"CO",name:"Colombia"},{code:"MX",name:"Mexico"},{code:"US",name:"United States"}],asiaPacific:[{code:"AU",name:"Australia"},{code:"CN",name:"China"},{code:"IN",name:"India"},{code:"JP",name:"Japan"},{code:"KR",name:"South Korea"},{code:"NZ",name:"New Zealand"},{code:"SG",name:"Singapore"}],africaMiddleEast:[{code:"AE",name:"United Arab Emirates"},{code:"IL",name:"Israel"},{code:"SA",name:"Saudi Arabia"},{code:"ZA",name:"South Africa"}]};function YT(){const{activeModal:e,editingSite:t,openModal:n}=Z(),s=F(B=>B.currentSite),r=F(B=>B.bankHolidays),i=F(B=>B.setBankHolidays),o=F(B=>B.setCurrentSite),l=F(B=>B.sites),c=F(B=>B.setSites),d=e==="site",f=t||s,[h,p]=g.useState(""),[_,v]=g.useState(""),[u,y]=g.useState(""),[m,x]=g.useState(""),[w,b]=g.useState(!0),[S,N]=g.useState(!1),[D,L]=g.useState(!1),[T,j]=g.useState(null);g.useEffect(()=>{d&&f&&(p(f.name||""),v(f.city||""),y(f.country_code||""),x(f.region_code||""),b(f.active!==!1&&f.active!==0),j(null))},[d,f]);const $=r.filter(B=>f&&B.site_id===f.id).length,P=async()=>{if(f){if(!h.trim()){j("Site name is required");return}N(!0),j(null);try{const B=await ov(f.id,{name:h.trim(),city:_.trim()||void 0,country_code:u||void 0,region_code:m.trim()||void 0,active:w}),C=l.map(R=>R.id===f.id?{...R,...B}:R);c(C),(s==null?void 0:s.id)===f.id&&o({...s,...B}),n("manageSites")}catch(B){j(B instanceof Error?B.message:"Failed to save site")}finally{N(!1)}}},k=async()=>{if(f&&confirm("This will refresh bank holidays from the Nager.Date API. Continue?")){L(!0),j(null);try{const B=await Vp(f.id),C=$n(B);i(B,C);const R=l.map(A=>A.id===f.id?{...A,last_holiday_fetch:new Date().toISOString()}:A);c(R),(s==null?void 0:s.id)===f.id&&o({...s,last_holiday_fetch:new Date().toISOString()})}catch(B){j(B instanceof Error?B.message:"Failed to refresh holidays")}finally{L(!1)}}},E=()=>{n("manageSites")},I=a.jsxs("div",{className:Se.footer,children:[a.jsx(ae,{variant:"secondary",onClick:E,children:"Back"}),a.jsx(ae,{variant:"primary",onClick:P,disabled:S,children:S?"Saving...":"Save Changes"})]});if(!f)return null;const M=f.last_holiday_fetch?new Date(f.last_holiday_fetch).toLocaleDateString():"Never";return a.jsxs(_t,{isOpen:d,onClose:E,title:`Edit Site: ${f.name}`,size:"lg",footer:I,children:[T&&a.jsx("div",{className:Se.error,children:T}),a.jsxs("div",{className:Se.section,children:[a.jsx("h3",{className:Se.sectionTitle,children:"Site Details"}),a.jsxs("div",{className:Se.formGroup,children:[a.jsx("label",{className:Se.label,children:"Site Name"}),a.jsx("input",{type:"text",className:Se.input,value:h,onChange:B=>p(B.target.value),placeholder:"e.g., Winterthur HQ"})]}),a.jsxs("div",{className:Se.formGroup,children:[a.jsx("label",{className:Se.label,children:"City"}),a.jsx("input",{type:"text",className:Se.input,value:_,onChange:B=>v(B.target.value),placeholder:"e.g., Winterthur"})]}),a.jsxs("div",{className:Se.formRow,children:[a.jsxs("div",{className:Se.formGroup,children:[a.jsx("label",{className:Se.label,children:"Country"}),a.jsxs("select",{className:Se.select,value:u,onChange:B=>y(B.target.value),children:[a.jsx("option",{value:"",children:"Select country..."}),a.jsx("optgroup",{label:"Europe",children:Li.europe.map(B=>a.jsxs("option",{value:B.code,children:[B.name," (",B.code,")"]},B.code))}),a.jsx("optgroup",{label:"Americas",children:Li.americas.map(B=>a.jsxs("option",{value:B.code,children:[B.name," (",B.code,")"]},B.code))}),a.jsx("optgroup",{label:"Asia & Pacific",children:Li.asiaPacific.map(B=>a.jsxs("option",{value:B.code,children:[B.name," (",B.code,")"]},B.code))}),a.jsx("optgroup",{label:"Africa & Middle East",children:Li.africaMiddleEast.map(B=>a.jsxs("option",{value:B.code,children:[B.name," (",B.code,")"]},B.code))})]})]}),a.jsxs("div",{className:Se.formGroup,children:[a.jsx("label",{className:Se.label,children:"Region/State Code"}),a.jsx("input",{type:"text",className:Se.input,value:m,onChange:B=>x(B.target.value),placeholder:"e.g., ZH, HE, ARA"})]})]}),a.jsx("p",{className:Se.help,children:"Region codes vary by country. For Switzerland: ZH, BE, GE, etc. For Germany: BY, HE, NW, etc."}),a.jsx("div",{className:Se.checkbox,children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:w,onChange:B=>b(B.target.checked)}),a.jsx("span",{children:"Active"})]})})]}),a.jsxs("div",{className:Se.section,children:[a.jsx("h3",{className:Se.sectionTitle,children:"Bank Holidays"}),u?a.jsxs("div",{className:Se.holidayStatusBox,children:[a.jsxs("div",{className:Se.holidayInfo,children:[a.jsxs("span",{className:Se.holidayCount,children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})}),$," bank holidays"]}),a.jsxs("span",{className:Se.lastFetch,children:["Last updated: ",M]})]}),a.jsxs(ae,{variant:"secondary",size:"sm",onClick:k,disabled:D,children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginRight:4},children:[a.jsx("polyline",{points:"23 4 23 10 17 10"}),a.jsx("polyline",{points:"1 20 1 14 7 14"}),a.jsx("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"})]}),D?"Refreshing...":"Refresh"]})]}):a.jsxs("div",{className:Se.warning,children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),a.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),a.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),"Set a country code above to enable automatic bank holiday fetching"]}),a.jsx("p",{className:Se.help,children:"Bank holidays are fetched from the Nager.Date public API. Custom holidays can be added in the Staff View under the Bank Holidays section."})]})]})}const XT="_footer_nlv1i_3",KT="_error_nlv1i_8",ZT="_siteList_nlv1i_18",JT="_empty_nlv1i_24",eP="_siteRow_nlv1i_31",tP="_inactive_nlv1i_43",nP="_siteInfo_nlv1i_47",sP="_siteName_nlv1i_52",aP="_siteCountry_nlv1i_58",rP="_siteActions_nlv1i_64",iP="_inactiveBadge_nlv1i_70",oP="_editBtn_nlv1i_78",lP="_addSection_nlv1i_97",cP="_addForm_nlv1i_102",dP="_input_nlv1i_107",uP="_help_nlv1i_127",mt={footer:XT,error:KT,siteList:ZT,empty:JT,siteRow:eP,inactive:tP,siteInfo:nP,siteName:sP,siteCountry:aP,siteActions:rP,inactiveBadge:iP,editBtn:oP,addSection:lP,addForm:cP,input:dP,help:uP},fP={AT:"Austria",BE:"Belgium",CH:"Switzerland",CZ:"Czech Republic",DE:"Germany",DK:"Denmark",ES:"Spain",FI:"Finland",FR:"France",GB:"United Kingdom",GR:"Greece",HR:"Croatia",HU:"Hungary",IE:"Ireland",IT:"Italy",NL:"Netherlands",NO:"Norway",PL:"Poland",PT:"Portugal",RO:"Romania",SE:"Sweden",AR:"Argentina",BR:"Brazil",CA:"Canada",CL:"Chile",CO:"Colombia",MX:"Mexico",US:"United States",AU:"Australia",CN:"China",IN:"India",JP:"Japan",KR:"South Korea",NZ:"New Zealand",SG:"Singapore",AE:"UAE",IL:"Israel",SA:"Saudi Arabia",ZA:"South Africa"};function hP(e){return e?fP[e]||e:""}function mP(){const{activeModal:e,closeModal:t,setEditingSite:n,openModal:s}=Z(),r=F(m=>m.sites),i=F(m=>m.setSites),o=e==="manageSites"||e==="siteManagement",[l,c]=g.useState(""),[d,f]=g.useState(!1),[h,p]=g.useState(null),_=async()=>{if(!l.trim()){p("Please enter a site name");return}f(!0),p(null);try{const m=await iv({name:l.trim()});i([...r,m]),c("")}catch(m){p(m instanceof Error?m.message:"Failed to add site")}finally{f(!1)}},v=m=>{n(m),s("site")},u=()=>{c(""),p(null),t()},y=a.jsx("div",{className:mt.footer,children:a.jsx(ae,{variant:"secondary",onClick:u,children:"Close"})});return a.jsxs(_t,{isOpen:o,onClose:u,title:"Site Management",footer:y,size:"md",children:[h&&a.jsx("div",{className:mt.error,children:h}),a.jsx("div",{className:mt.siteList,children:r.length===0?a.jsx("div",{className:mt.empty,children:"No sites configured. Add one below."}):r.map(m=>a.jsxs("div",{className:`${mt.siteRow} ${!m.active&&m.active!==void 0?mt.inactive:""}`,children:[a.jsxs("div",{className:mt.siteInfo,children:[a.jsx("div",{className:mt.siteName,children:m.name}),a.jsx("div",{className:mt.siteCountry,children:hP(m.country_code)||m.country_code||""})]}),a.jsxs("div",{className:mt.siteActions,children:[!m.active&&m.active!==void 0&&a.jsx("span",{className:mt.inactiveBadge,children:"Inactive"}),a.jsx("button",{className:mt.editBtn,onClick:()=>v(m),title:"Edit site",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})})]})]},m.id))}),a.jsxs("div",{className:mt.addSection,children:[a.jsxs("div",{className:mt.addForm,children:[a.jsx("input",{type:"text",className:mt.input,placeholder:"New site name",value:l,onChange:m=>c(m.target.value),onKeyDown:m=>m.key==="Enter"&&_()}),a.jsx(ae,{variant:"primary",onClick:_,disabled:d,children:"Add"})]}),a.jsx("p",{className:mt.help,children:"After adding, click the edit button to set country and region codes for automatic bank holidays."})]})]})}const pP="_container_xf2d8_6",gP="_toolbar_xf2d8_13",_P="_checkbox_xf2d8_22",yP="_tableWrapper_xf2d8_38",vP="_table_xf2d8_38",xP="_disabled_xf2d8_77",wP="_nameCell_xf2d8_82",jP="_userName_xf2d8_88",SP="_disabledBadge_xf2d8_93",kP="_emailCell_xf2d8_104",NP="_roleBadge_xf2d8_110",bP="_sitesCell_xf2d8_119",CP="_editBtn_xf2d8_129",DP="_loading_xf2d8_150",$P="_empty_xf2d8_151",EP="_form_xf2d8_161",TP="_formHeader_xf2d8_167",PP="_backBtn_xf2d8_182",MP="_error_xf2d8_198",IP="_formGrid_xf2d8_208",LP="_field_xf2d8_221",AP="_toggleLabel_xf2d8_264",RP="_hint_xf2d8_283",BP="_sitesSection_xf2d8_290",FP="_siteCheckboxes_xf2d8_306",OP="_siteCheckbox_xf2d8_306",HP="_noSites_xf2d8_332",qP="_formActions_xf2d8_338",zP="_rightActions_xf2d8_347",ge={container:pP,toolbar:gP,checkbox:_P,tableWrapper:yP,table:vP,disabled:xP,nameCell:wP,userName:jP,disabledBadge:SP,emailCell:kP,roleBadge:NP,sitesCell:bP,editBtn:CP,loading:DP,empty:$P,form:EP,formHeader:TP,backBtn:PP,error:MP,formGrid:IP,field:LP,toggleLabel:AP,hint:RP,sitesSection:BP,siteCheckboxes:FP,siteCheckbox:OP,noSites:HP,formActions:qP,rightActions:zP},Bl={admin:{label:"Admin",color:"#ef4444"},superuser:{label:"SuperUser",color:"#f97316"},user:{label:"User",color:"#3b82f6"}};function WP(){const e=Z(T=>T.activeModal),t=Z(T=>T.closeModal),n=F(T=>T.sites),s=F(T=>T.currentUser),r=e==="userManagement",[i,o]=g.useState([]),[l,c]=g.useState(!1),[d,f]=g.useState(!1),[h,p]=g.useState(null),[_,v]=g.useState(!1),u=(s==null?void 0:s.role)==="admin",y=(s==null?void 0:s.role)==="superuser",m=u||y,x=g.useCallback(async()=>{f(!0);try{const T=await gv(l);o(T)}catch(T){console.error("Failed to load users:",T)}finally{f(!1)}},[l]);g.useEffect(()=>{r&&x()},[r,x]);const w=T=>!T||T.length===0?"":T.map(j=>{var $;return($=n.find(P=>P.id===j))==null?void 0:$.name}).filter(Boolean).join(", "),b=T=>{p(T),v(!1)},S=()=>{p(null),v(!0)},N=()=>{p(null),v(!1)},D=async()=>{await x(),N()},L=async()=>{await x(),N()};return a.jsx(_t,{isOpen:r,onClose:t,title:"User Management",size:"xl",children:a.jsx("div",{className:ge.container,children:h||_?a.jsx(UP,{user:h,sites:n,currentUser:s,onSave:D,onDelete:L,onCancel:N}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:ge.toolbar,children:[a.jsxs("label",{className:ge.checkbox,children:[a.jsx("input",{type:"checkbox",checked:l,onChange:T=>c(T.target.checked)}),a.jsx("span",{children:"Show disabled users"})]}),m&&a.jsxs(ae,{onClick:S,children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add User"]})]}),a.jsx("div",{className:ge.tableWrapper,children:d?a.jsx("div",{className:ge.loading,children:"Loading users..."}):i.length===0?a.jsx("div",{className:ge.empty,children:"No users found"}):a.jsxs("table",{className:ge.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Email"}),a.jsx("th",{children:"Role"}),a.jsx("th",{children:"Sites"}),a.jsx("th",{style:{width:60}})]})}),a.jsx("tbody",{children:i.map(T=>a.jsxs("tr",{className:T.active?"":ge.disabled,children:[a.jsx("td",{children:a.jsxs("div",{className:ge.nameCell,children:[a.jsxs("span",{className:ge.userName,children:[T.first_name," ",T.last_name]}),!T.active&&a.jsx("span",{className:ge.disabledBadge,children:"Disabled"})]})}),a.jsx("td",{className:ge.emailCell,children:T.email}),a.jsx("td",{children:a.jsx("span",{className:ge.roleBadge,style:{backgroundColor:`${Bl[T.role].color}20`,color:Bl[T.role].color},children:Bl[T.role].label})}),a.jsx("td",{className:ge.sitesCell,title:w(T.site_ids),children:w(T.site_ids)}),a.jsx("td",{children:a.jsx("button",{className:ge.editBtn,onClick:()=>b(T),title:"Edit user",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})})})]},T.id))})]})})]})})})}function UP({user:e,sites:t,currentUser:n,onSave:s,onDelete:r,onCancel:i}){const o=!!e,l=(n==null?void 0:n.role)==="admin",c=(n==null?void 0:n.role)==="superuser",[d,f]=g.useState((e==null?void 0:e.first_name)||""),[h,p]=g.useState((e==null?void 0:e.last_name)||""),[_,v]=g.useState((e==null?void 0:e.email)||""),[u,y]=g.useState(""),[m,x]=g.useState((e==null?void 0:e.role)||"user"),[w,b]=g.useState((e==null?void 0:e.active)??!0),[S,N]=g.useState((e==null?void 0:e.site_ids)||[]),[D,L]=g.useState(!1),[T,j]=g.useState(null),$=l,P=l||c,k=l,E=o&&(l&&(e==null?void 0:e.id)!==(n==null?void 0:n.id)||c&&(e==null?void 0:e.role)!=="admin"),I=C=>{N(R=>R.includes(C)?R.filter(A=>A!==C):[...R,C])},M=async C=>{if(C.preventDefault(),j(null),!d.trim()||!h.trim()||!_.trim()){j("Please fill in all required fields");return}if(!o&&!u){j("Password is required for new users");return}if(!o&&u.length<6){j("Password must be at least 6 characters");return}L(!0);try{if(o&&e){const R={first_name:d.trim(),last_name:h.trim(),email:_.trim(),role:m,active:w,site_ids:S};u&&(R.password=u),await yv(e.id,R)}else{const R={first_name:d.trim(),last_name:h.trim(),email:_.trim(),password:u,role:m,site_ids:S};await _v(R)}s()}catch(R){console.error("Failed to save user:",R);let A="Failed to save user";R instanceof Error&&(A=R.message),j(A)}finally{L(!1)}},B=async()=>{if(!(!e||!window.confirm(`Are you sure you want to delete "${e.first_name} ${e.last_name}"?

This action cannot be undone.`))){L(!0);try{await vv(e.id),r()}catch(R){console.error("Failed to delete user:",R);let A="Failed to delete user";R instanceof Error&&(A=R.message),j(A)}finally{L(!1)}}};return a.jsxs("form",{onSubmit:M,className:ge.form,children:[a.jsxs("div",{className:ge.formHeader,children:[a.jsx("h3",{children:o?"Edit User":"Add User"}),a.jsx("button",{type:"button",className:ge.backBtn,onClick:i,children:" Back to list"})]}),T&&a.jsx("div",{className:ge.error,children:T}),a.jsxs("div",{className:ge.formGrid,children:[a.jsxs("div",{className:ge.field,children:[a.jsx("label",{htmlFor:"firstName",children:"First Name *"}),a.jsx("input",{type:"text",id:"firstName",value:d,onChange:C=>f(C.target.value),placeholder:"Enter first name",required:!0})]}),a.jsxs("div",{className:ge.field,children:[a.jsx("label",{htmlFor:"lastName",children:"Last Name *"}),a.jsx("input",{type:"text",id:"lastName",value:h,onChange:C=>p(C.target.value),placeholder:"Enter last name",required:!0})]}),a.jsxs("div",{className:ge.field,children:[a.jsx("label",{htmlFor:"email",children:"Email *"}),a.jsx("input",{type:"email",id:"email",value:_,onChange:C=>v(C.target.value),placeholder:"Enter email address",required:!0})]}),a.jsxs("div",{className:ge.field,children:[a.jsxs("label",{htmlFor:"password",children:["Password ",o?"(leave blank to keep)":"*"]}),a.jsx("input",{type:"password",id:"password",value:u,onChange:C=>y(C.target.value),placeholder:o?"":"Min 6 characters",required:!o,minLength:6})]}),a.jsxs("div",{className:ge.field,children:[a.jsx("label",{htmlFor:"role",children:"Role *"}),a.jsxs("select",{id:"role",value:m,onChange:C=>x(C.target.value),children:[a.jsx("option",{value:"user",children:"User"}),a.jsx("option",{value:"superuser",disabled:!P,children:"SuperUser"}),a.jsxs("option",{value:"admin",disabled:!$,children:["Admin ",$?"":"(admin only)"]})]})]}),o&&a.jsxs("div",{className:ge.field,children:[a.jsx("label",{children:"Status"}),a.jsxs("label",{className:ge.toggleLabel,children:[a.jsx("input",{type:"checkbox",checked:w,onChange:C=>b(C.target.checked),disabled:!E}),a.jsx("span",{children:"Active"})]}),!E&&a.jsx("span",{className:ge.hint,children:(e==null?void 0:e.id)===(n==null?void 0:n.id)?"Can't disable yourself":"Insufficient permissions"})]})]}),a.jsxs("div",{className:ge.sitesSection,children:[a.jsx("label",{children:"Site Assignments"}),a.jsx("p",{className:ge.hint,children:"Select which sites this user can access."}),a.jsxs("div",{className:ge.siteCheckboxes,children:[t.map(C=>a.jsxs("label",{className:ge.siteCheckbox,children:[a.jsx("input",{type:"checkbox",checked:S.includes(C.id),onChange:()=>I(C.id)}),a.jsx("span",{children:C.name})]},C.id)),t.length===0&&a.jsx("span",{className:ge.noSites,children:"No sites available"})]})]}),a.jsxs("div",{className:ge.formActions,children:[o&&k&&a.jsx(ae,{type:"button",variant:"danger",onClick:B,disabled:D,children:"Delete User"}),a.jsxs("div",{className:ge.rightActions,children:[a.jsx(ae,{type:"button",variant:"secondary",onClick:i,disabled:D,children:"Cancel"}),a.jsx(ae,{type:"submit",disabled:D,children:D?"Saving...":o?"Save Changes":"Create User"})]})]})]})}const VP="_container_1s6nv_5",GP="_loading_1s6nv_11",QP="_error_1s6nv_17",YP="_success_1s6nv_26",XP="_toggleSection_1s6nv_36",KP="_toggle_1s6nv_36",ZP="_toggleSwitch_1s6nv_52",JP="_toggleLabel_1s6nv_81",eM="_section_1s6nv_87",tM="_field_1s6nv_103",nM="_hint_1s6nv_143",sM="_checkbox_1s6nv_150",aM="_actions_1s6nv_170",Oe={container:VP,loading:GP,error:QP,success:YP,toggleSection:XP,toggle:KP,toggleSwitch:ZP,toggleLabel:JP,section:eM,field:tM,hint:nM,checkbox:sM,actions:aM};function rM(){const e=Z(M=>M.activeModal),t=Z(M=>M.closeModal),n=F(M=>M.currentUser),s=e==="ssoConfig",r=(n==null?void 0:n.role)==="admin",[i,o]=g.useState(!1),[l,c]=g.useState(""),[d,f]=g.useState(""),[h,p]=g.useState(""),[_,v]=g.useState(""),[u,y]=g.useState(""),[m,x]=g.useState(!1),[w,b]=g.useState("user"),[S,N]=g.useState(!1),[D,L]=g.useState(!1),[T,j]=g.useState(null),[$,P]=g.useState(null),k=typeof window<"u"?`${window.location.origin}/api/auth/sso/callback`:"/api/auth/sso/callback";g.useEffect(()=>{s&&r&&E()},[s,r]);const E=async()=>{N(!0),j(null);try{const M=await Ce("/api/sso/config/full");o(M.enabled),c(M.tenant_id||""),f(M.client_id||""),v(M.client_secret_masked||"Enter client secret"),y(M.redirect_uri||k),x(M.auto_create_users),b(M.default_role||"user")}catch(M){console.error("Failed to load SSO config:",M),j(M instanceof Error?M.message:"Failed to load configuration")}finally{N(!1)}},I=async()=>{if(j(null),P(null),i&&(!l.trim()||!d.trim()||!u.trim())){j("Please fill in Tenant ID, Client ID, and Redirect URI to enable SSO");return}L(!0);try{const M={enabled:i,tenant_id:l.trim(),client_id:d.trim(),redirect_uri:u.trim(),auto_create_users:m,default_role:w};h&&(M.client_secret=h),await Xe("/api/sso/config",M),P("SSO configuration saved successfully"),p(""),await E()}catch(M){console.error("Failed to save SSO config:",M),j(M instanceof Error?M.message:"Failed to save configuration")}finally{L(!1)}};return r?a.jsx(_t,{isOpen:s,onClose:t,title:"SSO Configuration",size:"md",children:a.jsx("div",{className:Oe.container,children:S?a.jsx("div",{className:Oe.loading,children:"Loading configuration..."}):a.jsxs(a.Fragment,{children:[T&&a.jsx("div",{className:Oe.error,children:T}),$&&a.jsx("div",{className:Oe.success,children:$}),a.jsxs("div",{className:Oe.toggleSection,children:[a.jsxs("label",{className:Oe.toggle,children:[a.jsx("input",{type:"checkbox",checked:i,onChange:M=>o(M.target.checked)}),a.jsx("span",{className:Oe.toggleSwitch}),a.jsx("span",{className:Oe.toggleLabel,children:"Enable SSO"})]}),a.jsx("p",{className:Oe.hint,children:"When enabled, users can sign in using Microsoft Entra (Azure AD)."})]}),a.jsxs("div",{className:Oe.section,children:[a.jsx("h4",{children:"Microsoft Entra Settings"}),a.jsxs("div",{className:Oe.field,children:[a.jsx("label",{htmlFor:"tenantId",children:"Tenant ID *"}),a.jsx("input",{type:"text",id:"tenantId",value:l,onChange:M=>c(M.target.value),placeholder:"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",disabled:!i}),a.jsx("span",{className:Oe.hint,children:"Found in Azure Portal  Microsoft Entra ID  Overview"})]}),a.jsxs("div",{className:Oe.field,children:[a.jsx("label",{htmlFor:"clientId",children:"Client ID (Application ID) *"}),a.jsx("input",{type:"text",id:"clientId",value:d,onChange:M=>f(M.target.value),placeholder:"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",disabled:!i}),a.jsx("span",{className:Oe.hint,children:"Found in App Registration  Overview  Application (client) ID"})]}),a.jsxs("div",{className:Oe.field,children:[a.jsx("label",{htmlFor:"clientSecret",children:"Client Secret"}),a.jsx("input",{type:"password",id:"clientSecret",value:h,onChange:M=>p(M.target.value),placeholder:_||"Enter client secret",disabled:!i}),a.jsx("span",{className:Oe.hint,children:"Leave blank to keep existing secret. Create in App Registration  Certificates & secrets"})]}),a.jsxs("div",{className:Oe.field,children:[a.jsx("label",{htmlFor:"redirectUri",children:"Redirect URI *"}),a.jsx("input",{type:"text",id:"redirectUri",value:u,onChange:M=>y(M.target.value),placeholder:k,disabled:!i}),a.jsx("span",{className:Oe.hint,children:"Must be registered in App Registration  Authentication  Redirect URIs"})]})]}),a.jsxs("div",{className:Oe.section,children:[a.jsx("h4",{children:"User Management"}),a.jsxs("label",{className:Oe.checkbox,children:[a.jsx("input",{type:"checkbox",checked:m,onChange:M=>x(M.target.checked),disabled:!i}),a.jsx("span",{children:"Auto-create users on first SSO login"})]}),a.jsxs("div",{className:Oe.field,children:[a.jsx("label",{htmlFor:"defaultRole",children:"Default role for new users"}),a.jsxs("select",{id:"defaultRole",value:w,onChange:M=>b(M.target.value),disabled:!i||!m,children:[a.jsx("option",{value:"user",children:"User"}),a.jsx("option",{value:"superuser",children:"SuperUser"}),a.jsx("option",{value:"admin",children:"Admin"})]})]})]}),a.jsxs("div",{className:Oe.actions,children:[a.jsx(ae,{variant:"secondary",onClick:t,children:"Cancel"}),a.jsx(ae,{onClick:I,disabled:D,children:D?"Saving...":"Save Configuration"})]})]})})}):null}const iM="_container_1rwl1_5",oM="_toolbar_1rwl1_10",lM="_filters_1rwl1_20",cM="_filterGroup_1rwl1_26",dM="_checkbox_1rwl1_55",uM="_tableWrapper_1rwl1_72",fM="_table_1rwl1_72",hM="_inactive_1rwl1_111",mM="_nameCell_1rwl1_116",pM="_equipName_1rwl1_122",gM="_inactiveBadge_1rwl1_127",_M="_typeBadge_1rwl1_138",yM="_siteCell_1rwl1_148",vM="_editBtn_1rwl1_154",xM="_loading_1rwl1_175",wM="_empty_1rwl1_176",jM="_form_1rwl1_186",SM="_formHeader_1rwl1_192",kM="_backBtn_1rwl1_207",NM="_error_1rwl1_223",bM="_formFields_1rwl1_233",CM="_field_1rwl1_239",DM="_typeOptions_1rwl1_274",$M="_typeOption_1rwl1_274",EM="_addNew_1rwl1_296",TM="_selectedTypeDisplay_1rwl1_306",PM="_selectedTypeBadge_1rwl1_312",MM="_changeTypeBtn_1rwl1_323",IM="_newTypeInput_1rwl1_340",LM="_confirmBtn_1rwl1_360",AM="_cancelBtn_1rwl1_361",RM="_siteOptions_1rwl1_393",BM="_siteOption_1rwl1_393",FM="_selected_1rwl1_306",OM="_siteOptionLabel_1rwl1_424",HM="_toggleLabel_1rwl1_435",qM="_hint_1rwl1_449",zM="_formActions_1rwl1_455",WM="_rightActions_1rwl1_463",le={container:iM,toolbar:oM,filters:lM,filterGroup:cM,checkbox:dM,tableWrapper:uM,table:fM,inactive:hM,nameCell:mM,equipName:pM,inactiveBadge:gM,typeBadge:_M,siteCell:yM,editBtn:vM,loading:xM,empty:wM,form:jM,formHeader:SM,backBtn:kM,error:NM,formFields:bM,field:CM,typeOptions:DM,typeOption:$M,addNew:EM,selectedTypeDisplay:TM,selectedTypeBadge:PM,changeTypeBtn:MM,newTypeInput:IM,confirmBtn:LM,cancelBtn:AM,siteOptions:RM,siteOption:BM,selected:FM,siteOptionLabel:OM,toggleLabel:HM,hint:qM,formActions:zM,rightActions:WM};function UM(){const e=Z(k=>k.activeModal),t=Z(k=>k.closeModal),n=F(k=>k.sites),s=F(k=>k.currentUser),r=F(k=>k.currentSite),i=F(k=>k.setEquipment),o=e==="manageEquipment",l=(s==null?void 0:s.role)==="admin"||(s==null?void 0:s.role)==="superuser",[c,d]=g.useState([]),[f,h]=g.useState((r==null?void 0:r.id)||"all"),[p,_]=g.useState(!1),[v,u]=g.useState(!1),[y,m]=g.useState(null),[x,w]=g.useState(!1),b=g.useMemo(()=>{const k=new Set;return c.forEach(E=>{E.type&&k.add(E.type)}),Array.from(k).sort()},[c]),S=g.useCallback(async()=>{u(!0);try{const k=await Ce("/api/equipment/all");d(k)}catch(k){console.error("Failed to load equipment:",k)}finally{u(!1)}},[]);g.useEffect(()=>{o&&(S(),h((r==null?void 0:r.id)||"all"))},[o,S,r==null?void 0:r.id]);const N=c.filter(k=>!(f!=="all"&&k.site_id!==f||!p&&!k.active)),D=k=>{var E;return((E=n.find(I=>I.id===k))==null?void 0:E.name)||"Unknown"},L=k=>{m(k),w(!1)},T=()=>{m(null),w(!0)},j=()=>{m(null),w(!1)},$=async()=>{await S();const k=await Ce("/api/equipment/all");i(k),j()},P=async()=>{await S();const k=await Ce("/api/equipment/all");i(k),j()};return a.jsx(_t,{isOpen:o,onClose:t,title:"Equipment Management",size:"lg",children:a.jsx("div",{className:le.container,children:y||x?a.jsx(VM,{equipment:y,sites:n,existingTypes:b,defaultSiteId:f!=="all"?f:(r==null?void 0:r.id)||null,onSave:$,onDelete:P,onCancel:j,canDelete:(s==null?void 0:s.role)==="admin"}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:le.toolbar,children:[a.jsxs("div",{className:le.filters,children:[a.jsxs("div",{className:le.filterGroup,children:[a.jsx("label",{children:"Site"}),a.jsxs("select",{value:f,onChange:k=>h(k.target.value==="all"?"all":parseInt(k.target.value)),children:[a.jsx("option",{value:"all",children:"All Sites"}),n.map(k=>a.jsx("option",{value:k.id,children:k.name},k.id))]})]}),a.jsxs("label",{className:le.checkbox,children:[a.jsx("input",{type:"checkbox",checked:p,onChange:k=>_(k.target.checked)}),a.jsx("span",{children:"Show inactive"})]})]}),l&&a.jsxs(ae,{onClick:T,children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Equipment"]})]}),a.jsx("div",{className:le.tableWrapper,children:v?a.jsx("div",{className:le.loading,children:"Loading equipment..."}):N.length===0?a.jsx("div",{className:le.empty,children:c.length===0?"No equipment found":"No equipment matching filters"}):a.jsxs("table",{className:le.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Type"}),a.jsx("th",{children:"Site"}),a.jsx("th",{style:{width:60}})]})}),a.jsx("tbody",{children:N.map(k=>a.jsxs("tr",{className:k.active?"":le.inactive,children:[a.jsx("td",{children:a.jsxs("div",{className:le.nameCell,children:[a.jsx("span",{className:le.equipName,children:k.name}),!k.active&&a.jsx("span",{className:le.inactiveBadge,children:"Inactive"})]})}),a.jsx("td",{children:a.jsx("span",{className:le.typeBadge,children:k.type})}),a.jsx("td",{className:le.siteCell,children:D(k.site_id)}),a.jsx("td",{children:a.jsx("button",{className:le.editBtn,onClick:()=>L(k),title:"Edit equipment",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})})})]},k.id))})]})})]})})})}function VM({equipment:e,sites:t,existingTypes:n,defaultSiteId:s,onSave:r,onDelete:i,onCancel:o,canDelete:l}){const c=!!e,[d,f]=g.useState((e==null?void 0:e.name)||""),[h,p]=g.useState((e==null?void 0:e.type)||""),[_,v]=g.useState(!1),[u,y]=g.useState(""),[m,x]=g.useState((e==null?void 0:e.site_id)||s),[w,b]=g.useState((e==null?void 0:e.active)??!0),[S,N]=g.useState(!1),[D,L]=g.useState(null),T=()=>{u.trim()&&(p(u.trim()),v(!1))},j=()=>{v(!1),y("")},$=async k=>{if(k.preventDefault(),L(null),!d.trim()){L("Equipment name is required");return}if(!h.trim()){L("Equipment type is required");return}if(!m){L("Please select a site");return}N(!0);try{const E={name:d.trim(),type:h.trim(),site_id:m,active:w};c&&e?await Xe(`/api/equipment/${e.id}`,E):await De("/api/equipment",E),r()}catch(E){console.error("Failed to save equipment:",E),L(E instanceof Error?E.message:"Failed to save equipment")}finally{N(!1)}},P=async()=>{if(!(!e||!window.confirm(`Are you sure you want to delete "${e.name}"?

This will also remove all assignments for this equipment.`))){N(!0);try{await Ut(`/api/equipment/${e.id}`),i()}catch(E){console.error("Failed to delete equipment:",E),L(E instanceof Error?E.message:"Failed to delete equipment")}finally{N(!1)}}};return a.jsxs("form",{onSubmit:$,className:le.form,children:[a.jsxs("div",{className:le.formHeader,children:[a.jsx("h3",{children:c?"Edit Equipment":"Add Equipment"}),a.jsx("button",{type:"button",className:le.backBtn,onClick:o,children:" Back to list"})]}),D&&a.jsx("div",{className:le.error,children:D}),a.jsxs("div",{className:le.formFields,children:[a.jsxs("div",{className:le.field,children:[a.jsx("label",{htmlFor:"equipName",children:"Name *"}),a.jsx("input",{type:"text",id:"equipName",value:d,onChange:k=>f(k.target.value),placeholder:"e.g., Pilot Plant A, Mass Spec 1",required:!0})]}),a.jsxs("div",{className:le.field,children:[a.jsx("label",{children:"Type *"}),_?a.jsxs("div",{className:le.newTypeInput,children:[a.jsx("input",{type:"text",value:u,onChange:k=>y(k.target.value),placeholder:"Enter new equipment type",autoFocus:!0,onKeyDown:k=>{k.key==="Enter"?(k.preventDefault(),T()):k.key==="Escape"&&j()}}),a.jsx("button",{type:"button",className:le.confirmBtn,onClick:T,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})})}),a.jsx("button",{type:"button",className:le.cancelBtn,onClick:j,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}):h?a.jsxs("div",{className:le.selectedTypeDisplay,children:[a.jsx("span",{className:le.selectedTypeBadge,children:h}),a.jsx("button",{type:"button",className:le.changeTypeBtn,onClick:()=>p(""),children:"Change"})]}):a.jsxs("div",{className:le.typeOptions,children:[n.map(k=>a.jsx("button",{type:"button",className:le.typeOption,onClick:()=>p(k),children:k},k)),a.jsx("button",{type:"button",className:`${le.typeOption} ${le.addNew}`,onClick:()=>{v(!0),y("")},children:"+ New type"})]}),a.jsx("span",{className:le.hint,children:"Equipment types are shared across all sites"})]}),a.jsxs("div",{className:le.field,children:[a.jsx("label",{children:"Site *"}),a.jsx("div",{className:le.siteOptions,children:t.map(k=>a.jsxs("label",{className:`${le.siteOption} ${m===k.id?le.selected:""}`,children:[a.jsx("input",{type:"radio",name:"equipSite",value:k.id,checked:m===k.id,onChange:()=>x(k.id),required:!0}),a.jsx("span",{className:le.siteOptionLabel,children:k.name})]},k.id))})]}),c&&a.jsxs("div",{className:le.field,children:[a.jsx("label",{children:"Status"}),a.jsxs("label",{className:le.toggleLabel,children:[a.jsx("input",{type:"checkbox",checked:w,onChange:k=>b(k.target.checked)}),a.jsx("span",{children:"Active"})]}),a.jsx("span",{className:le.hint,children:"Inactive equipment won't appear in booking lists"})]})]}),a.jsxs("div",{className:le.formActions,children:[c&&l&&a.jsx(ae,{type:"button",variant:"danger",onClick:P,disabled:S,children:"Delete Equipment"}),a.jsxs("div",{className:le.rightActions,children:[a.jsx(ae,{type:"button",variant:"secondary",onClick:o,disabled:S,children:"Cancel"}),a.jsx(ae,{type:"submit",disabled:S,children:S?"Saving...":c?"Save Changes":"Create Equipment"})]})]})]})}const GM="_container_400gt_5",QM="_description_400gt_11",YM="_phaseList_400gt_19",XM="_loading_400gt_32",KM="_empty_400gt_33",ZM="_phaseItem_400gt_41",JM="_inactive_400gt_57",e3="_dragging_400gt_61",t3="_dropBefore_400gt_65",n3="_dropAfter_400gt_77",s3="_dragHandle_400gt_90",a3="_phaseName_400gt_111",r3="_editable_400gt_122",i3="_phaseActions_400gt_151",o3="_actionBtn_400gt_157",l3="_active_400gt_176",c3="_addSection_400gt_190",d3="_footer_400gt_217",Ve={container:GM,description:QM,phaseList:YM,loading:XM,empty:KM,phaseItem:ZM,inactive:JM,dragging:e3,dropBefore:t3,dropAfter:n3,dragHandle:s3,phaseName:a3,editable:r3,phaseActions:i3,actionBtn:o3,active:l3,delete:"_delete_400gt_184",addSection:c3,footer:d3};function u3(){const e=Z(C=>C.activeModal),t=Z(C=>C.closeModal),n=F(C=>C.currentUser),s=e==="predefinedPhases",r=(n==null?void 0:n.role)==="admin"||(n==null?void 0:n.role)==="superuser",[i,o]=g.useState([]),[l,c]=g.useState(!1),[d,f]=g.useState(""),[h,p]=g.useState(!1),[_,v]=g.useState(null),[u,y]=g.useState(""),[m,x]=g.useState(null),[w,b]=g.useState(null),[S,N]=g.useState(null),D=g.useCallback(async()=>{c(!0);try{const C=await Ce("/api/predefined-phases/all");o(C)}catch(C){console.error("Failed to load predefined phases:",C)}finally{c(!1)}},[]);g.useEffect(()=>{s&&D()},[s,D]);const L=async()=>{if(d.trim()){p(!0);try{await De("/api/predefined-phases",{name:d.trim()}),f(""),await D()}catch(C){console.error("Failed to add phase:",C),alert(C instanceof Error?C.message:"Failed to add phase")}finally{p(!1)}}},T=async C=>{if(!u.trim()){v(null);return}try{await Xe(`/api/predefined-phases/${C}`,{name:u.trim()}),v(null),await D()}catch(R){console.error("Failed to update phase:",R),alert(R instanceof Error?R.message:"Failed to update phase")}},j=async C=>{try{await Xe(`/api/predefined-phases/${C.id}`,{is_active:!C.is_active}),await D()}catch(R){console.error("Failed to toggle phase:",R),alert(R instanceof Error?R.message:"Failed to update phase")}},$=async C=>{if(window.confirm(`Are you sure you want to delete "${C.name}"?`))try{await Ut(`/api/predefined-phases/${C.id}`),await D()}catch(A){console.error("Failed to delete phase:",A),alert(A instanceof Error?A.message:"Failed to delete phase")}},P=C=>{v(C.id),y(C.name)},k=(C,R)=>{x(R),C.dataTransfer.effectAllowed="move"},E=(C,R)=>{if(C.preventDefault(),m===R)return;const A=C.currentTarget.getBoundingClientRect(),H=A.top+A.height/2,z=C.clientY<H?"before":"after";b(R),N(z)},I=()=>{b(null),N(null)},M=async C=>{if(C.preventDefault(),!m||!w||m===w){x(null),b(null),N(null);return}const R=i.map(z=>z.id),A=R.indexOf(m);let H=R.indexOf(w);R.splice(A,1),H=R.indexOf(w),S==="after"&&(H+=1),R.splice(H,0,m),x(null),b(null),N(null);try{await Xe("/api/predefined-phases/reorder",{phase_order:R}),await D()}catch(z){console.error("Failed to reorder phases:",z),await D()}},B=()=>{x(null),b(null),N(null)};return a.jsx(_t,{isOpen:s,onClose:t,title:"Predefined Phases",size:"md",children:a.jsxs("div",{className:Ve.container,children:[a.jsx("p",{className:Ve.description,children:"Predefined phases appear as quick-add options when creating new projects. Drag to reorder. Inactive phases won't appear in the list."}),a.jsx("div",{className:Ve.phaseList,children:l?a.jsx("div",{className:Ve.loading,children:"Loading phases..."}):i.length===0?a.jsx("div",{className:Ve.empty,children:"No predefined phases. Add one below."}):i.map(C=>a.jsxs("div",{className:`
                  ${Ve.phaseItem} 
                  ${C.is_active?"":Ve.inactive}
                  ${m===C.id?Ve.dragging:""}
                  ${w===C.id&&S==="before"?Ve.dropBefore:""}
                  ${w===C.id&&S==="after"?Ve.dropAfter:""}
                `,draggable:r,onDragStart:R=>k(R,C.id),onDragOver:R=>E(R,C.id),onDragLeave:I,onDrop:M,onDragEnd:B,children:[r&&a.jsx("div",{className:Ve.dragHandle,children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"8",y1:"6",x2:"16",y2:"6"}),a.jsx("line",{x1:"8",y1:"12",x2:"16",y2:"12"}),a.jsx("line",{x1:"8",y1:"18",x2:"16",y2:"18"})]})}),a.jsx("div",{className:Ve.phaseName,children:_===C.id?a.jsx("input",{type:"text",value:u,onChange:R=>y(R.target.value),onBlur:()=>T(C.id),onKeyDown:R=>{R.key==="Enter"&&T(C.id),R.key==="Escape"&&v(null)},autoFocus:!0}):a.jsx("span",{onClick:()=>r&&P(C),className:r?Ve.editable:"",children:C.name})}),r&&a.jsxs("div",{className:Ve.phaseActions,children:[a.jsx("button",{className:`${Ve.actionBtn} ${C.is_active?Ve.active:""}`,onClick:()=>j(C),title:C.is_active?"Deactivate":"Activate",children:C.is_active?a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}):a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("circle",{cx:"12",cy:"12",r:"10"})})}),a.jsx("button",{className:`${Ve.actionBtn} ${Ve.delete}`,onClick:()=>$(C),title:"Delete",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"3 6 5 6 21 6"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})]},C.id))}),r&&a.jsxs("div",{className:Ve.addSection,children:[a.jsx("input",{type:"text",value:d,onChange:C=>f(C.target.value),placeholder:"New phase name...",onKeyDown:C=>{C.key==="Enter"&&L()}}),a.jsx(ae,{onClick:L,disabled:h||!d.trim(),children:h?"Adding...":"Add Phase"})]}),a.jsx("div",{className:Ve.footer,children:a.jsx(ae,{variant:"secondary",onClick:t,children:"Close"})})]})})}const f3="_container_qzxfv_5",h3="_dropZone_qzxfv_12",m3="_dragging_qzxfv_31",p3="_hasFile_qzxfv_36",g3="_fileInput_qzxfv_41",_3="_dropContent_qzxfv_46",y3="_dropText_qzxfv_58",v3="_dropHint_qzxfv_64",x3="_selectedFile_qzxfv_70",w3="_fileIcon_qzxfv_77",j3="_fileName_qzxfv_81",S3="_fileSize_qzxfv_89",k3="_clearBtn_qzxfv_95",N3="_progressSection_qzxfv_112",b3="_progressBar_qzxfv_119",C3="_progressFill_qzxfv_126",D3="_progressMessage_qzxfv_133",$3="_error_qzxfv_140",E3="_success_qzxfv_150",T3="_successContent_qzxfv_166",P3="_successTitle_qzxfv_172",M3="_successDetails_qzxfv_177",I3="_actions_qzxfv_189",Le={container:f3,dropZone:h3,dragging:m3,hasFile:p3,fileInput:g3,dropContent:_3,dropText:y3,dropHint:v3,selectedFile:x3,fileIcon:w3,fileName:j3,fileSize:S3,clearBtn:k3,progressSection:N3,progressBar:b3,progressFill:C3,progressMessage:D3,error:$3,success:E3,successContent:T3,successTitle:P3,successDetails:M3,actions:I3};function L3(){const e=Z($=>$.activeModal),t=Z($=>$.closeModal),n=F($=>$.setProjects),s=F($=>$.currentSite),r=e==="importProject",[i,o]=g.useState(null),[l,c]=g.useState(!1),[d,f]=g.useState(!1),[h,p]=g.useState(null),[_,v]=g.useState(null),[u,y]=g.useState(null),m=g.useRef(null),x=$=>{const P=$.name.toLowerCase();if(!P.endsWith(".mpp")&&!P.endsWith(".csv")&&!P.endsWith(".mpt")&&!P.endsWith(".mpx")&&!P.endsWith(".xml")){v("Please select an MPP, CSV, or XML file");return}o($),v(null),y(null)},w=$=>{$.preventDefault(),c(!0)},b=$=>{$.preventDefault(),c(!1)},S=$=>{$.preventDefault(),c(!1);const P=$.dataTransfer.files[0];P&&x(P)},N=$=>{var k;const P=(k=$.target.files)==null?void 0:k[0];P&&x(P)},D=async()=>{if(i){f(!0),v(null),y(null);try{p({percent:10,message:"Uploading file..."});const $=new FormData;$.append("file",i),s!=null&&s.id&&$.append("site_id",s.id.toString()),p({percent:30,message:"Parsing and creating project..."});let P="/api/import/project";window.location.port==="3333"&&(P=`${window.location.protocol}//${window.location.hostname}:8485/api/import/project`);const k=window.location.pathname.match(/^(\/t\/[a-z0-9][a-z0-9-]*)/);k&&(P=P.replace("/api/",`${k[1]}/api/`)),console.log("Import URL:",P);const E=await fetch(P,{method:"POST",body:$,credentials:"include"}),I=await E.text();let M;try{M=I?JSON.parse(I):{success:!1,error:"Empty response from server"}}catch{throw console.error("Server response:",I),new Error(`Server error: ${E.status} ${E.statusText}. Check server logs.`)}if(!E.ok||!M.success)throw new Error(M.error||`Import failed: ${E.status}`);p({percent:90,message:"Refreshing project list..."});const B=await Ke();n(B),p({percent:100,message:"Import complete!"}),y(M)}catch($){console.error("Import error:",$),v($ instanceof Error?$.message:"Failed to import project"),p(null)}finally{f(!1)}}},L=()=>{o(null),p(null),v(null),y(null),f(!1),t()},T=()=>{o(null),v(null),y(null),m.current&&(m.current.value="")},j=$=>$.toLowerCase().split(".").pop()==="csv"?a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"8",y1:"13",x2:"16",y2:"13"}),a.jsx("line",{x1:"8",y1:"17",x2:"16",y2:"17"}),a.jsx("line",{x1:"8",y1:"9",x2:"10",y2:"9"})]}):a.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),a.jsx("polyline",{points:"10 9 9 9 8 9"})]});return a.jsx(_t,{isOpen:r,onClose:L,title:"Import Project",size:"md",children:a.jsxs("div",{className:Le.container,children:[!d&&!u&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`${Le.dropZone} ${l?Le.dragging:""} ${i?Le.hasFile:""}`,onDragOver:w,onDragLeave:b,onDrop:S,onClick:()=>{var $;return($=m.current)==null?void 0:$.click()},children:[a.jsx("input",{ref:m,type:"file",accept:".mpp,.mpt,.mpx,.xml,.csv",onChange:N,className:Le.fileInput}),i?a.jsxs("div",{className:Le.selectedFile,children:[a.jsx("div",{className:Le.fileIcon,children:j(i.name)}),a.jsx("div",{className:Le.fileName,children:i.name}),a.jsxs("div",{className:Le.fileSize,children:[(i.size/1024).toFixed(1)," KB"]})]}):a.jsxs("div",{className:Le.dropContent,children:[a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:[a.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a.jsx("polyline",{points:"17 8 12 3 7 8"}),a.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]}),a.jsx("div",{className:Le.dropText,children:"Drop file here or click to browse"}),a.jsx("div",{className:Le.dropHint,children:"Supports MPP, MPT, MPX, XML, and CSV files"})]})]}),i&&a.jsx("button",{className:Le.clearBtn,onClick:T,children:"Choose different file"})]}),d&&h&&a.jsxs("div",{className:Le.progressSection,children:[a.jsx("div",{className:Le.progressBar,children:a.jsx("div",{className:Le.progressFill,style:{width:`${h.percent}%`}})}),a.jsx("div",{className:Le.progressMessage,children:h.message})]}),_&&a.jsx("div",{className:Le.error,children:_}),u&&u.success&&a.jsxs("div",{className:Le.success,children:[a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),a.jsxs("div",{className:Le.successContent,children:[a.jsx("div",{className:Le.successTitle,children:"Import Complete!"}),a.jsxs("div",{className:Le.successDetails,children:[a.jsx("strong",{children:u.project_name}),a.jsxs("span",{children:[u.phases_created," phase",u.phases_created!==1?"s":"",u.subphases_created?`, ${u.subphases_created} subphase${u.subphases_created!==1?"s":""}`:""]})]})]})]}),a.jsxs("div",{className:Le.actions,children:[a.jsx(ae,{variant:"secondary",onClick:L,children:u?"Close":"Cancel"}),!u&&a.jsx(ae,{onClick:D,disabled:!i||d,children:d?"Importing...":"Import Project"})]})]})})}const A3="_container_qubai_3",R3="_loading_qubai_10",B3="_section_qubai_19",F3="_sectionTitle_qubai_25",O3="_field_qubai_37",H3="_label_qubai_43",q3="_hint_qubai_49",z3="_input_qubai_54",W3="_select_qubai_74",U3="_buttonGroup_qubai_92",V3="_optionButton_qubai_97",G3="_selected_qubai_116",Q3="_toggleField_qubai_123",Y3="_toggleInfo_qubai_131",X3="_toggle_qubai_123",K3="_toggleOn_qubai_153",Z3="_toggleSlider_qubai_158",J3="_error_qubai_175",eI="_success_qubai_184",tI="_actions_qubai_194",nI="_rightActions_qubai_204",ce={container:A3,loading:R3,section:B3,sectionTitle:F3,field:O3,label:H3,hint:q3,input:z3,select:W3,buttonGroup:U3,optionButton:V3,selected:G3,toggleField:Q3,toggleInfo:Y3,toggle:X3,toggleOn:K3,toggleSlider:Z3,error:J3,success:eI,actions:tI,rightActions:nI},Ai={instance_title:"",default_view:"month",week_start:"monday",date_format:"dd/mm/yyyy",show_weekends:"true",auto_expand_projects:"false"},sI=[{value:"week",label:"Week"},{value:"month",label:"Month"},{value:"quarter",label:"Quarter"},{value:"year",label:"Year"}],aI=[{value:"monday",label:"Monday"},{value:"sunday",label:"Sunday"}],rI=[{value:"dd/mm/yyyy",label:"DD/MM/YYYY (31/12/2025)"},{value:"mm/dd/yyyy",label:"MM/DD/YYYY (12/31/2025)"},{value:"yyyy-mm-dd",label:"YYYY-MM-DD (2025-12-31)"}];function iI(){const e=Z(N=>N.activeModal),t=Z(N=>N.closeModal),n=F(N=>N.instanceSettings),s=F(N=>N.setInstanceSettings),r=e==="settings",[i,o]=g.useState(Ai),[l,c]=g.useState(Ai),[d,f]=g.useState(!0),[h,p]=g.useState(!1),[_,v]=g.useState(null),[u,y]=g.useState(null);g.useEffect(()=>{r&&m()},[r]);const m=async()=>{f(!0),v(null);try{const N={...Ai};for(const D of Object.keys(Ai))try{const L=await xv(D);L.value!==null&&(N[D]=L.value)}catch{}o(N),c(N)}catch(N){v("Failed to load settings"),console.error("Load settings error:",N)}finally{f(!1)}},x=g.useMemo(()=>JSON.stringify(i)!==JSON.stringify(l),[i,l]),w=async()=>{p(!0),v(null),y(null);try{for(const L of Object.keys(i))i[L]!==l[L]&&await wv(L,i[L]);const N={...n,instance_title:i.instance_title};s(N);const D=i.instance_title||"Milestone";document.title=D,c(i),y("Settings saved successfully")}catch(N){v("Failed to save settings"),console.error("Save settings error:",N)}finally{p(!1)}},b=g.useCallback(()=>{o(l),y(null),v(null)},[l]),S=g.useCallback(()=>{x&&!confirm("You have unsaved changes. Are you sure you want to close?")||t()},[x,t]);return a.jsx(_t,{isOpen:r,onClose:S,title:"Settings",size:"md",children:a.jsx("div",{className:ce.container,children:d?a.jsx("div",{className:ce.loading,children:"Loading settings..."}):a.jsxs(a.Fragment,{children:[a.jsxs("section",{className:ce.section,children:[a.jsx("h3",{className:ce.sectionTitle,children:"Instance"}),a.jsxs("div",{className:ce.field,children:[a.jsx("label",{className:ce.label,htmlFor:"instance-title",children:"Application Title"}),a.jsx("input",{id:"instance-title",type:"text",className:ce.input,value:i.instance_title,onChange:N=>{const D=N.target.value;o(L=>({...L,instance_title:D})),y(null)},placeholder:"Milestone",autoComplete:"off"}),a.jsx("span",{className:ce.hint,children:"Displayed in the header and browser tab"})]})]}),a.jsxs("section",{className:ce.section,children:[a.jsx("h3",{className:ce.sectionTitle,children:"Display"}),a.jsxs("div",{className:ce.field,children:[a.jsx("label",{className:ce.label,children:"Default View"}),a.jsx("div",{className:ce.buttonGroup,children:sI.map(N=>a.jsx("button",{type:"button",className:`${ce.optionButton} ${i.default_view===N.value?ce.selected:""}`,onClick:()=>{o(D=>({...D,default_view:N.value})),y(null)},children:N.label},N.value))})]}),a.jsxs("div",{className:ce.field,children:[a.jsx("label",{className:ce.label,children:"Date Format"}),a.jsx("select",{className:ce.select,value:i.date_format,onChange:N=>{o(D=>({...D,date_format:N.target.value})),y(null)},children:rI.map(N=>a.jsx("option",{value:N.value,children:N.label},N.value))})]}),a.jsxs("div",{className:ce.field,children:[a.jsx("label",{className:ce.label,children:"Week Starts On"}),a.jsx("div",{className:ce.buttonGroup,children:aI.map(N=>a.jsx("button",{type:"button",className:`${ce.optionButton} ${i.week_start===N.value?ce.selected:""}`,onClick:()=>{o(D=>({...D,week_start:N.value})),y(null)},children:N.label},N.value))})]})]}),a.jsxs("section",{className:ce.section,children:[a.jsx("h3",{className:ce.sectionTitle,children:"Gantt Chart"}),a.jsxs("div",{className:ce.toggleField,children:[a.jsxs("div",{className:ce.toggleInfo,children:[a.jsx("label",{className:ce.label,children:"Show Weekends"}),a.jsx("span",{className:ce.hint,children:"Display Saturday and Sunday columns in the timeline"})]}),a.jsx("button",{type:"button",className:`${ce.toggle} ${i.show_weekends==="true"?ce.toggleOn:""}`,onClick:()=>{o(N=>({...N,show_weekends:N.show_weekends==="true"?"false":"true"})),y(null)},children:a.jsx("span",{className:ce.toggleSlider})})]}),a.jsxs("div",{className:ce.toggleField,children:[a.jsxs("div",{className:ce.toggleInfo,children:[a.jsx("label",{className:ce.label,children:"Auto-expand Projects"}),a.jsx("span",{className:ce.hint,children:"Automatically expand projects to show phases on load"})]}),a.jsx("button",{type:"button",className:`${ce.toggle} ${i.auto_expand_projects==="true"?ce.toggleOn:""}`,onClick:()=>{o(N=>({...N,auto_expand_projects:N.auto_expand_projects==="true"?"false":"true"})),y(null)},children:a.jsx("span",{className:ce.toggleSlider})})]})]}),_&&a.jsx("div",{className:ce.error,children:_}),u&&a.jsx("div",{className:ce.success,children:u}),a.jsxs("div",{className:ce.actions,children:[a.jsx(ae,{variant:"secondary",onClick:S,children:"Cancel"}),a.jsxs("div",{className:ce.rightActions,children:[x&&a.jsx(ae,{variant:"ghost",onClick:b,children:"Reset"}),a.jsx(ae,{onClick:w,disabled:!x||h,children:h?"Saving...":"Save Changes"})]})]})]})})})}function oI(){return a.jsxs(a.Fragment,{children:[a.jsx(UE,{}),a.jsx(c4,{}),a.jsx(p4,{}),a.jsx($4,{}),a.jsx(E4,{}),a.jsx(K4,{}),a.jsx(ST,{}),a.jsx(PT,{}),a.jsx(YT,{}),a.jsx(mP,{}),a.jsx(WP,{}),a.jsx(rM,{}),a.jsx(UM,{}),a.jsx(u3,{}),a.jsx(L3,{}),a.jsx(iI,{})]})}const lI="_wrapper_10yst_1",cI="_fullWidth_10yst_7",dI="_label_10yst_11",uI="_inputWrapper_10yst_17",fI="_input_10yst_17",hI="_error_10yst_55",mI="_hasLeftIcon_10yst_63",pI="_hasRightIcon_10yst_67",gI="_leftIcon_10yst_71",_I="_rightIcon_10yst_72",yI="_errorText_10yst_97",vI="_hint_10yst_102",Xt={wrapper:lI,fullWidth:cI,label:dI,inputWrapper:uI,input:fI,error:hI,hasLeftIcon:mI,hasRightIcon:pI,leftIcon:gI,rightIcon:_I,errorText:yI,hint:vI},xI=g.forwardRef(({label:e,error:t,hint:n,leftIcon:s,rightIcon:r,fullWidth:i=!1,className:o,id:l,...c},d)=>{const f=l||`input-${Math.random().toString(36).substr(2,9)}`,h=[Xt.wrapper,i&&Xt.fullWidth,o].filter(Boolean).join(" "),p=[Xt.input,t&&Xt.error,s&&Xt.hasLeftIcon,r&&Xt.hasRightIcon].filter(Boolean).join(" ");return a.jsxs("div",{className:h,children:[e&&a.jsx("label",{htmlFor:f,className:Xt.label,children:e}),a.jsxs("div",{className:Xt.inputWrapper,children:[s&&a.jsx("span",{className:Xt.leftIcon,children:s}),a.jsx("input",{ref:d,id:f,className:p,...c}),r&&a.jsx("span",{className:Xt.rightIcon,children:r})]}),t&&a.jsx("span",{className:Xt.errorText,children:t}),n&&!t&&a.jsx("span",{className:Xt.hint,children:n})]})});xI.displayName="Input";const wI="_wrapper_1tq09_1",jI="_fullWidth_1tq09_7",SI="_label_1tq09_11",kI="_selectWrapper_1tq09_17",NI="_select_1tq09_17",bI="_error_1tq09_53",CI="_hasIcon_1tq09_61",DI="_icon_1tq09_65",$I="_chevron_1tq09_82",EI="_errorText_1tq09_91",TI="_hint_1tq09_96",cn={wrapper:wI,fullWidth:jI,label:SI,selectWrapper:kI,select:NI,error:bI,hasIcon:CI,icon:DI,chevron:$I,errorText:EI,hint:TI},PI=g.forwardRef(({label:e,error:t,hint:n,options:s,placeholder:r,fullWidth:i=!1,icon:o,className:l,id:c,...d},f)=>{const h=c||`select-${Math.random().toString(36).substr(2,9)}`,p=[cn.wrapper,i&&cn.fullWidth,l].filter(Boolean).join(" "),_=[cn.select,t&&cn.error,o&&cn.hasIcon].filter(Boolean).join(" ");return a.jsxs("div",{className:p,children:[e&&a.jsx("label",{htmlFor:h,className:cn.label,children:e}),a.jsxs("div",{className:cn.selectWrapper,children:[o&&a.jsx("span",{className:cn.icon,children:o}),a.jsxs("select",{ref:f,id:h,className:_,...d,children:[r&&a.jsx("option",{value:"",disabled:!0,children:r}),s.map(v=>a.jsx("option",{value:v.value,disabled:v.disabled,children:v.label},v.value))]}),a.jsx("span",{className:cn.chevron,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})})]}),t&&a.jsx("span",{className:cn.errorText,children:t}),n&&!t&&a.jsx("span",{className:cn.hint,children:n})]})});PI.displayName="Select";const MI="_wrapper_1mmpa_1",II="_label_1mmpa_7",LI="_input_1mmpa_14",AI="_checkbox_1mmpa_21",RI="_checkIcon_1mmpa_34",BI="_indeterminateIcon_1mmpa_35",FI="_labelText_1mmpa_75",OI="_error_1mmpa_85",es={wrapper:MI,label:II,input:LI,checkbox:AI,checkIcon:RI,indeterminateIcon:BI,labelText:FI,error:OI},HI=g.forwardRef(({label:e,error:t,indeterminate:n,className:s,id:r,...i},o)=>{const l=r||`checkbox-${Math.random().toString(36).substr(2,9)}`,c=[es.wrapper,s].filter(Boolean).join(" ");return a.jsxs("div",{className:c,children:[a.jsxs("label",{htmlFor:l,className:es.label,children:[a.jsx("input",{ref:d=>{d&&(d.indeterminate=n||!1),typeof o=="function"?o(d):o&&(o.current=d)},type:"checkbox",id:l,className:es.input,...i}),a.jsxs("span",{className:es.checkbox,children:[a.jsx("svg",{className:es.checkIcon,width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})}),a.jsx("svg",{className:es.indeterminateIcon,width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})})]}),e&&a.jsx("span",{className:es.labelText,children:e})]}),t&&a.jsx("span",{className:es.error,children:t})]})});HI.displayName="Checkbox";const qI="_menu_1rdk0_1",zI="_item_1rdk0_25",WI="_disabled_1rdk0_41",UI="_danger_1rdk0_45",VI="_icon_1rdk0_58",GI="_label_1rdk0_71",QI="_divider_1rdk0_75",Rs={menu:qI,item:zI,disabled:WI,danger:UI,icon:VI,label:GI,divider:QI};function YI({x:e,y:t,items:n,onClose:s}){const r=g.useRef(null);return g.useEffect(()=>{const i=l=>{r.current&&!r.current.contains(l.target)&&s()},o=l=>{l.key==="Escape"&&s()};return document.addEventListener("mousedown",i),document.addEventListener("keydown",o),()=>{document.removeEventListener("mousedown",i),document.removeEventListener("keydown",o)}},[s]),g.useEffect(()=>{if(r.current){const i=r.current.getBoundingClientRect(),o=window.innerWidth,l=window.innerHeight;let c=e,d=t;e+i.width>o&&(c=o-i.width-8),t+i.height>l&&(d=l-i.height-8),r.current.style.left=`${c}px`,r.current.style.top=`${d}px`}},[e,t]),a.jsx("div",{ref:r,className:Rs.menu,style:{left:e,top:t},children:n.map((i,o)=>i.divider?a.jsx("div",{className:Rs.divider},o):a.jsxs("button",{className:`${Rs.item} ${i.danger?Rs.danger:""} ${i.disabled?Rs.disabled:""}`,onClick:()=>{i.disabled||(i.onClick(),s())},disabled:i.disabled,children:[i.icon&&a.jsx("span",{className:Rs.icon,children:i.icon}),a.jsx("span",{className:Rs.label,children:i.label})]},o))})}function XI(){const e=Z(p=>p.contextMenu),t=Z(p=>p.hideContextMenu),n=Z(p=>p.openProjectModal),s=Z(p=>p.openPhaseModal),r=Z(p=>p.openSubphaseModal),i=Z(p=>p.openModal),o=F(p=>p.projects),l=F(p=>p.currentUser),{loadAllData:c}=Qp(),d=(l==null?void 0:l.role)==="admin"||(l==null?void 0:l.role)==="superuser",f=g.useCallback(()=>{var p,_,v;if(!e.targetId||!e.type)return null;if(e.type==="project")return o.find(u=>u.id===e.targetId);if(e.type==="phase"&&e.projectId){const u=o.find(y=>y.id===e.projectId);return(p=u==null?void 0:u.phases)==null?void 0:p.find(y=>y.id===e.targetId)}if(e.type==="subphase"&&e.projectId&&e.phaseId){const u=o.find(m=>m.id===e.projectId),y=(_=u==null?void 0:u.phases)==null?void 0:_.find(m=>m.id===e.phaseId);return(v=y==null?void 0:y.children)==null?void 0:v.find(m=>m.id===e.targetId)}return null},[e,o]),h=g.useCallback(()=>{const{type:p,targetId:_,projectId:v,phaseId:u}=e,y=f();if(!p||!_)return[];if(p==="project"){const m=y;return[{label:"Edit Project",icon:a.jsx(Fl,{}),onClick:()=>{m&&n(m)},disabled:!d},{label:"Add Phase",icon:a.jsx(Ol,{}),onClick:()=>{s(void 0,_)},disabled:!d},{label:"Assign Staff",icon:a.jsx(ql,{}),onClick:()=>{i("staffAssignment",{projectId:_})},disabled:!d},{label:"Assign Equipment",icon:a.jsx(zl,{}),onClick:()=>{i("equipmentAssignment",{projectId:_})},disabled:!d},{label:"",divider:!0,onClick:()=>{}},{label:"Delete Project",icon:a.jsx(Hl,{}),danger:!0,onClick:async()=>{confirm(`Delete project "${m==null?void 0:m.name}"? This cannot be undone.`)&&(await G1(_),c())},disabled:!d}]}if(p==="phase"){const m=y;return[{label:"Edit Phase",icon:a.jsx(Fl,{}),onClick:()=>{m&&v&&s(m,v)},disabled:!d},{label:"Add Subphase",icon:a.jsx(Ol,{}),onClick:()=>{r(void 0,_,v)},disabled:!d},{label:"Assign Staff",icon:a.jsx(ql,{}),onClick:()=>{i("staffAssignment",{phaseId:_,projectId:v})},disabled:!d},{label:"Assign Equipment",icon:a.jsx(zl,{}),onClick:()=>{i("equipmentAssignment",{phaseId:_,projectId:v})},disabled:!d},{label:"",divider:!0,onClick:()=>{}},{label:"Delete Phase",icon:a.jsx(Hl,{}),danger:!0,onClick:async()=>{confirm(`Delete phase "${m==null?void 0:m.name}"? This cannot be undone.`)&&(await Hp(_),c())},disabled:!d}]}if(p==="subphase"){const m=y;return[{label:"Edit Subphase",icon:a.jsx(Fl,{}),onClick:()=>{m&&u&&v&&r(m,u,v)},disabled:!d},{label:"Add Child Subphase",icon:a.jsx(Ol,{}),onClick:()=>{r(void 0,u,v,_)},disabled:!d},{label:"Assign Staff",icon:a.jsx(ql,{}),onClick:()=>{i("staffAssignment",{subphaseId:_,phaseId:u,projectId:v})},disabled:!d},{label:"Assign Equipment",icon:a.jsx(zl,{}),onClick:()=>{i("equipmentAssignment",{subphaseId:_,phaseId:u,projectId:v})},disabled:!d},{label:"",divider:!0,onClick:()=>{}},{label:"Delete Subphase",icon:a.jsx(Hl,{}),danger:!0,onClick:async()=>{confirm(`Delete subphase "${m==null?void 0:m.name}"? This cannot be undone.`)&&(await qp(_),c())},disabled:!d}]}return[]},[e,f,d,n,s,r,i,c]);return e.visible?a.jsx(YI,{x:e.x,y:e.y,items:h(),onClose:t}):null}const Fl=()=>a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"})]}),Ol=()=>a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),Hl=()=>a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"3 6 5 6 21 6"}),a.jsx("path",{d:"M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})]}),ql=()=>a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),zl=()=>a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"2",y:"7",width:"20",height:"14",rx:"2",ry:"2"}),a.jsx("path",{d:"M16 21V5a2 2 0 00-2-2h-4a2 2 0 00-2 2v16"})]}),oh={adminUser:null,isAuthenticated:!1,isLoading:!0,tenants:[],systemStats:null,adminUsers:[],activeTab:"tenants",selectedTenantId:null},ze=Go(e=>({...oh,setAdminUser:t=>e({adminUser:t}),setIsAuthenticated:t=>e({isAuthenticated:t}),setIsLoading:t=>e({isLoading:t}),setTenants:t=>e({tenants:t}),setSystemStats:t=>e({systemStats:t}),setAdminUsers:t=>e({adminUsers:t}),setActiveTab:t=>e({activeTab:t}),setSelectedTenantId:t=>e({selectedTenantId:t}),updateTenantInList:(t,n)=>e(s=>({tenants:s.tenants.map(r=>r.id===t?{...r,...n}:r)})),removeTenantFromList:t=>e(n=>({tenants:n.tenants.filter(s=>s.id!==t)})),addTenantToList:t=>e(n=>({tenants:[t,...n.tenants]})),updateAdminUserInList:(t,n)=>e(s=>({adminUsers:s.adminUsers.map(r=>r.id===t?{...r,...n}:r)})),removeAdminUserFromList:t=>e(n=>({adminUsers:n.adminUsers.filter(s=>s.id!==t)})),addAdminUserToList:t=>e(n=>({adminUsers:[t,...n.adminUsers]})),reset:()=>e(oh)})),KI="_container_1g5x6_3",ZI="_card_1g5x6_12",JI="_header_1g5x6_22",eL="_logo_1g5x6_27",tL="_title_1g5x6_33",nL="_subtitle_1g5x6_40",sL="_form_1g5x6_46",aL="_formGroup_1g5x6_52",rL="_label_1g5x6_58",iL="_input_1g5x6_64",oL="_error_1g5x6_89",lL="_submitBtn_1g5x6_97",cL="_footer_1g5x6_118",dL="_backLink_1g5x6_125",rt={container:KI,card:ZI,header:JI,logo:eL,title:tL,subtitle:nL,form:sL,formGroup:aL,label:rL,input:iL,error:oL,submitBtn:lL,footer:cL,backLink:dL};function uL(){const[e,t]=g.useState(""),[n,s]=g.useState(""),[r,i]=g.useState(null),[o,l]=g.useState(!1),[c,d]=g.useState(()=>oa()),f=ze(u=>u.setAdminUser),h=ze(u=>u.setIsAuthenticated),p=ze(u=>u.setIsLoading);g.useEffect(()=>{const u=new MutationObserver(()=>{const y=document.documentElement.dataset.theme;y&&y!==c&&d(y)});return u.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>u.disconnect()},[c]);const _=async u=>{u.preventDefault(),i(null),l(!0);try{const y=await kv(e,n);y.success&&y.user&&(f(y.user),h(!0))}catch(y){i(y instanceof Error?y.message:"Invalid credentials")}finally{l(!1),p(!1)}},v=c==="dark"?"/img/milestone_logo_dark_theme.svg":"/img/milestone_logo_light_theme.svg";return a.jsx("div",{className:rt.container,children:a.jsxs("div",{className:rt.card,children:[a.jsxs("div",{className:rt.header,children:[a.jsx("img",{src:v,alt:"Milestone",className:rt.logo}),a.jsx("h1",{className:rt.title,children:"Admin Portal"}),a.jsx("p",{className:rt.subtitle,children:"Multi-tenant Management"})]}),a.jsxs("form",{onSubmit:_,className:rt.form,children:[a.jsxs("div",{className:rt.formGroup,children:[a.jsx("label",{htmlFor:"email",className:rt.label,children:"Email"}),a.jsx("input",{type:"email",id:"email",className:rt.input,value:e,onChange:u=>t(u.target.value),placeholder:"admin@example.com",required:!0,autoFocus:!0,disabled:o})]}),a.jsxs("div",{className:rt.formGroup,children:[a.jsx("label",{htmlFor:"password",className:rt.label,children:"Password"}),a.jsx("input",{type:"password",id:"password",className:rt.input,value:n,onChange:u=>s(u.target.value),placeholder:"",required:!0,disabled:o})]}),r&&a.jsx("div",{className:rt.error,children:r}),a.jsx("button",{type:"submit",className:rt.submitBtn,disabled:o,children:o?"Signing in...":"Sign In"})]}),a.jsx("div",{className:rt.footer,children:a.jsx("a",{href:"/",className:rt.backLink,children:" Back to Application"})})]})})}const fL="_container_1d2fr_3",hL="_statsGrid_1d2fr_10",mL="_statCard_1d2fr_16",pL="_statValue_1d2fr_31",gL="_success_1d2fr_37",_L="_warning_1d2fr_38",yL="_danger_1d2fr_39",vL="_panel_1d2fr_42",xL="_panelHeader_1d2fr_49",wL="_tableWrapper_1d2fr_65",jL="_table_1d2fr_65",SL="_emptyMessage_1d2fr_93",kL="_tenantName_1d2fr_99",NL="_companyName_1d2fr_113",bL="_slug_1d2fr_119",CL="_badge_1d2fr_127",DL="_badgeSuccess_1d2fr_136",$L="_badgeWarning_1d2fr_141",EL="_badgeDanger_1d2fr_146",TL="_badgeInfo_1d2fr_151",PL="_btnPrimary_1d2fr_157",ML="_actions_1d2fr_177",IL="_btnSmall_1d2fr_182",LL="_btnSuccess_1d2fr_202",AL="_btnWarning_1d2fr_210",RL="_btnDanger_1d2fr_218",BL="_loading_1d2fr_226",te={container:fL,statsGrid:hL,statCard:mL,statValue:pL,success:gL,warning:_L,danger:yL,panel:vL,panelHeader:xL,tableWrapper:wL,table:jL,emptyMessage:SL,tenantName:kL,companyName:NL,slug:bL,badge:CL,badgeSuccess:DL,badgeWarning:$L,badgeDanger:EL,badgeInfo:TL,btnPrimary:PL,actions:ML,btnSmall:IL,btnSuccess:LL,btnWarning:AL,btnDanger:RL,loading:BL};function FL({onCreateNew:e,onViewDetails:t,onShowCredentials:n,onRefresh:s}){const r=ze(u=>u.tenants),i=ze(u=>u.systemStats),[o,l]=g.useState(null),c=async u=>{if(confirm("This will create the database for this tenant. Continue?")){l(u.id);try{const y=await Pv(u.id);n("Database Provisioned!",y.adminEmail,y.adminPassword),s()}catch(y){alert("Error: "+(y instanceof Error?y.message:"Unknown error"))}finally{l(null)}}},d=async u=>{if(confirm("This will generate a new password for the tenant admin. Continue?")){l(u.id);try{const y=await Mv(u.id);n("Password Reset!",y.email,y.password)}catch(y){alert("Error: "+(y instanceof Error?y.message:"Unknown error"))}finally{l(null)}}},f=async(u,y)=>{if(confirm(`Change tenant status to ${y}?`)){l(u.id);try{await Ev(u.id,y),s()}catch(m){alert("Error: "+(m instanceof Error?m.message:"Unknown error"))}finally{l(null)}}},h=async u=>{if(confirm(`Delete tenant "${u.name}"? This action cannot be undone.`)){l(u.id);try{await Tv(u.id),s()}catch(y){alert("Error: "+(y instanceof Error?y.message:"Unknown error"))}finally{l(null)}}},p=u=>{const y={active:te.badgeSuccess,pending:te.badgeWarning,suspended:te.badgeDanger,archived:te.badgeInfo};return a.jsx("span",{className:`${te.badge} ${y[u]||""}`,children:u})},_=u=>u?u.accessible?a.jsx("span",{className:`${te.badge} ${te.badgeSuccess}`,children:"Connected"}):u.exists?a.jsx("span",{className:`${te.badge} ${te.badgeWarning}`,children:"Exists"}):a.jsx("span",{className:`${te.badge} ${te.badgeDanger}`,children:"Not provisioned"}):a.jsx("span",{className:te.badge,children:"Unknown"}),v=u=>new Date(u).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return a.jsxs("div",{className:te.container,children:[i&&a.jsxs("div",{className:te.statsGrid,children:[a.jsxs("div",{className:te.statCard,children:[a.jsx("h3",{children:"Total Tenants"}),a.jsx("div",{className:te.statValue,children:i.tenants.total})]}),a.jsxs("div",{className:`${te.statCard} ${te.success}`,children:[a.jsx("h3",{children:"Active"}),a.jsx("div",{className:te.statValue,children:i.tenants.active})]}),a.jsxs("div",{className:`${te.statCard} ${te.warning}`,children:[a.jsx("h3",{children:"Pending"}),a.jsx("div",{className:te.statValue,children:i.tenants.pending})]}),a.jsxs("div",{className:`${te.statCard} ${te.danger}`,children:[a.jsx("h3",{children:"Suspended"}),a.jsx("div",{className:te.statValue,children:i.tenants.suspended})]})]}),a.jsxs("div",{className:te.panel,children:[a.jsxs("div",{className:te.panelHeader,children:[a.jsx("h2",{children:"Tenants"}),a.jsxs("button",{className:te.btnPrimary,onClick:e,children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Create Tenant"]})]}),a.jsx("div",{className:te.tableWrapper,children:a.jsxs("table",{className:te.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Slug"}),a.jsx("th",{children:"Status"}),a.jsx("th",{children:"Database"}),a.jsx("th",{children:"Admin Email"}),a.jsx("th",{children:"Plan"}),a.jsx("th",{children:"Created"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:r.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:te.emptyMessage,children:"No tenants found. Create your first tenant to get started."})}):r.map(u=>{var y,m;return a.jsxs("tr",{children:[a.jsxs("td",{children:[a.jsx("button",{className:te.tenantName,onClick:()=>t(u.id),children:u.name}),u.company_name&&a.jsx("div",{className:te.companyName,children:u.company_name})]}),a.jsx("td",{children:a.jsx("code",{className:te.slug,children:u.slug})}),a.jsx("td",{children:p(u.status)}),a.jsx("td",{children:_(u.database_status)}),a.jsx("td",{children:u.admin_email}),a.jsx("td",{children:u.plan}),a.jsx("td",{children:v(u.created_at)}),a.jsx("td",{children:a.jsx("div",{className:te.actions,children:o===u.id?a.jsx("span",{className:te.loading,children:"Loading..."}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:te.btnSmall,onClick:()=>t(u.id),title:"View Details",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),a.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}),!((y=u.database_status)!=null&&y.accessible)&&a.jsx("button",{className:`${te.btnSmall} ${te.btnSuccess}`,onClick:()=>c(u),title:"Provision Database",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("ellipse",{cx:"12",cy:"5",rx:"9",ry:"3"}),a.jsx("path",{d:"M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"}),a.jsx("path",{d:"M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"})]})}),((m=u.database_status)==null?void 0:m.accessible)&&a.jsx("button",{className:te.btnSmall,onClick:()=>d(u),title:"Reset Admin Password",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),u.status==="active"&&a.jsx("button",{className:`${te.btnSmall} ${te.btnWarning}`,onClick:()=>f(u,"suspended"),title:"Suspend",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"6",y:"4",width:"4",height:"16"}),a.jsx("rect",{x:"14",y:"4",width:"4",height:"16"})]})}),u.status==="suspended"&&a.jsx("button",{className:`${te.btnSmall} ${te.btnSuccess}`,onClick:()=>f(u,"active"),title:"Activate",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polygon",{points:"5 3 19 12 5 21 5 3"})})}),a.jsx("button",{className:`${te.btnSmall} ${te.btnDanger}`,onClick:()=>h(u),title:"Delete Tenant",children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"3 6 5 6 21 6"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})})})]},u.id)})})]})})]})]})}function OL({onCreateNew:e,onRefresh:t}){const n=ze(d=>d.adminUsers),s=ze(d=>d.adminUser),[r,i]=g.useState(null),o=async(d,f)=>{i(d);try{await Bv(d,{active:!f}),t()}catch(h){alert("Error: "+(h instanceof Error?h.message:"Unknown error"))}finally{i(null)}},l=async(d,f)=>{if(d===(s==null?void 0:s.id)){alert("You cannot delete yourself.");return}if(confirm(`Delete admin user "${f}"?`)){i(d);try{await Fv(d),t()}catch(h){alert("Error: "+(h instanceof Error?h.message:"Unknown error"))}finally{i(null)}}},c=d=>d?new Date(d).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-";return a.jsx("div",{className:te.container,children:a.jsxs("div",{className:te.panel,children:[a.jsxs("div",{className:te.panelHeader,children:[a.jsx("h2",{children:"Admin Users"}),a.jsxs("button",{className:te.btnPrimary,onClick:e,children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Admin"]})]}),a.jsx("div",{className:te.tableWrapper,children:a.jsxs("table",{className:te.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Email"}),a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Role"}),a.jsx("th",{children:"Status"}),a.jsx("th",{children:"Created"}),a.jsx("th",{children:"Last Login"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:n.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:te.emptyMessage,children:"No admin users found."})}):n.map(d=>a.jsxs("tr",{children:[a.jsxs("td",{children:[a.jsx("strong",{children:d.email}),d.id===(s==null?void 0:s.id)&&a.jsx("span",{style:{marginLeft:8,fontSize:"0.75rem",color:"var(--text-muted)"},children:"(you)"})]}),a.jsx("td",{children:d.name}),a.jsx("td",{children:a.jsx("span",{className:`${te.badge} ${d.role==="superadmin"?te.badgeInfo:""}`,children:d.role})}),a.jsx("td",{children:a.jsx("span",{className:`${te.badge} ${d.active?te.badgeSuccess:te.badgeDanger}`,children:d.active?"Active":"Disabled"})}),a.jsx("td",{children:c(d.created_at)}),a.jsx("td",{children:c(d.last_login)}),a.jsx("td",{children:a.jsx("div",{className:te.actions,children:r===d.id?a.jsx("span",{className:te.loading,children:"Loading..."}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:`${te.btnSmall} ${d.active?te.btnWarning:te.btnSuccess}`,onClick:()=>o(d.id,d.active),title:d.active?"Disable":"Enable",disabled:d.id===(s==null?void 0:s.id),children:d.active?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"10"}),a.jsx("line",{x1:"4.93",y1:"4.93",x2:"19.07",y2:"19.07"})]}):a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})})}),a.jsx("button",{className:`${te.btnSmall} ${te.btnDanger}`,onClick:()=>l(d.id,d.email),title:"Delete",disabled:d.id===(s==null?void 0:s.id),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"3 6 5 6 21 6"}),a.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})})]})})})]},d.id))})]})})]})})}const HL="_container_1fjtr_3",qL="_loading_1fjtr_9",zL="_header_1fjtr_15",WL="_refreshBtn_1fjtr_28",UL="_grid_1fjtr_48",VL="_section_1fjtr_53",GL="_statsRow_1fjtr_68",QL="_stat_1fjtr_68",YL="_statLabel_1fjtr_80",XL="_statValue_1fjtr_85",KL="_success_1fjtr_91",ZL="_warning_1fjtr_92",JL="_danger_1fjtr_93",eA="_info_1fjtr_95",tA="_infoLabel_1fjtr_104",nA="_infoValue_1fjtr_109",oe={container:HL,loading:qL,header:zL,refreshBtn:WL,grid:UL,section:VL,statsRow:GL,stat:QL,statLabel:YL,statValue:XL,success:KL,warning:ZL,danger:JL,info:eA,infoLabel:tA,infoValue:nA};function sA({onRefresh:e}){const t=ze(s=>s.systemStats),n=s=>{const r=Math.floor(s/86400),i=Math.floor(s%86400/3600),o=Math.floor(s%3600/60);return r>0?`${r}d ${i}h ${o}m`:i>0?`${i}h ${o}m`:`${o}m`};return t?a.jsxs("div",{className:oe.container,children:[a.jsxs("div",{className:oe.header,children:[a.jsx("h2",{children:"System Statistics"}),a.jsxs("button",{className:oe.refreshBtn,onClick:e,children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"23 4 23 10 17 10"}),a.jsx("polyline",{points:"1 20 1 14 7 14"}),a.jsx("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"})]}),"Refresh"]})]}),a.jsxs("div",{className:oe.grid,children:[a.jsxs("div",{className:oe.section,children:[a.jsx("h3",{children:"Tenants"}),a.jsxs("div",{className:oe.statsRow,children:[a.jsxs("div",{className:oe.stat,children:[a.jsx("span",{className:oe.statLabel,children:"Total"}),a.jsx("span",{className:oe.statValue,children:t.tenants.total})]}),a.jsxs("div",{className:oe.stat,children:[a.jsx("span",{className:oe.statLabel,children:"Active"}),a.jsx("span",{className:`${oe.statValue} ${oe.success}`,children:t.tenants.active})]}),a.jsxs("div",{className:oe.stat,children:[a.jsx("span",{className:oe.statLabel,children:"Pending"}),a.jsx("span",{className:`${oe.statValue} ${oe.warning}`,children:t.tenants.pending})]}),a.jsxs("div",{className:oe.stat,children:[a.jsx("span",{className:oe.statLabel,children:"Suspended"}),a.jsx("span",{className:`${oe.statValue} ${oe.danger}`,children:t.tenants.suspended})]}),a.jsxs("div",{className:oe.stat,children:[a.jsx("span",{className:oe.statLabel,children:"Archived"}),a.jsx("span",{className:oe.statValue,children:t.tenants.archived})]})]})]}),a.jsxs("div",{className:oe.section,children:[a.jsx("h3",{children:"Database Connections"}),a.jsxs("div",{className:oe.statsRow,children:[a.jsxs("div",{className:oe.stat,children:[a.jsx("span",{className:oe.statLabel,children:"Active Pools"}),a.jsx("span",{className:oe.statValue,children:t.connections.active_pools})]}),a.jsxs("div",{className:oe.stat,children:[a.jsx("span",{className:oe.statLabel,children:"Total Connections"}),a.jsx("span",{className:oe.statValue,children:t.connections.total_connections})]})]})]}),a.jsxs("div",{className:oe.section,children:[a.jsx("h3",{children:"Server"}),a.jsxs("div",{className:oe.statsRow,children:[a.jsxs("div",{className:oe.stat,children:[a.jsx("span",{className:oe.statLabel,children:"Uptime"}),a.jsx("span",{className:oe.statValue,children:n(t.system.uptime)})]}),a.jsxs("div",{className:oe.stat,children:[a.jsx("span",{className:oe.statLabel,children:"Memory"}),a.jsxs("span",{className:oe.statValue,children:[Math.round(t.system.memory_mb)," MB"]})]})]}),a.jsxs("div",{className:oe.info,children:[a.jsx("span",{className:oe.infoLabel,children:"Python Version:"}),a.jsx("code",{className:oe.infoValue,children:t.system.python_version.split(" ")[0]})]})]})]})]}):a.jsx("div",{className:oe.container,children:a.jsx("div",{className:oe.loading,children:"Loading statistics..."})})}const aA="_overlay_18v3p_3",rA="_modal_18v3p_14",iA="_wide_18v3p_27",oA="_header_18v3p_31",lA="_title_18v3p_39",cA="_closeBtn_18v3p_46",dA="_body_18v3p_66",uA="_footer_18v3p_72",fA="_form_18v3p_82",hA="_formGroup_18v3p_88",mA="_formRow_18v3p_94",pA="_label_18v3p_100",gA="_input_18v3p_106",_A="_select_18v3p_107",yA="_error_18v3p_133",vA="_btn_18v3p_142",xA="_btnPrimary_18v3p_157",wA="_btnSecondary_18v3p_166",jA="_infoGrid_18v3p_178",SA="_infoRow_18v3p_183",kA="_infoLabel_18v3p_190",NA="_infoValue_18v3p_196",bA="_codeBlock_18v3p_202",CA="_credentialsField_18v3p_212",DA="_credentialsInput_18v3p_218",$A="_badge_18v3p_250",EA="_badgeSuccess_18v3p_259",TA="_badgeWarning_18v3p_264",PA="_badgeDanger_18v3p_269",MA="_badgeInfo_18v3p_274",IA="_auditLog_18v3p_280",LA="_auditEntry_18v3p_286",AA="_auditAction_18v3p_296",RA="_auditMeta_18v3p_306",BA="_sectionTitle_18v3p_312",q={overlay:aA,modal:rA,wide:iA,header:oA,title:lA,closeBtn:cA,body:dA,footer:uA,form:fA,formGroup:hA,formRow:mA,label:pA,input:gA,select:_A,error:yA,btn:vA,btnPrimary:xA,btnSecondary:wA,infoGrid:jA,infoRow:SA,infoLabel:kA,infoValue:NA,codeBlock:bA,credentialsField:CA,credentialsInput:DA,badge:$A,badgeSuccess:EA,badgeWarning:TA,badgeDanger:PA,badgeInfo:MA,auditLog:IA,auditEntry:LA,auditAction:AA,auditMeta:RA,sectionTitle:BA};function FA({onClose:e,onCreated:t}){const[n,s]=g.useState({name:"",slug:"",company_name:"",admin_email:"",plan:"standard",max_users:10,max_projects:50}),[r,i]=g.useState(!1),[o,l]=g.useState(null),c=p=>{const{name:_,value:v,type:u}=p.target;s(y=>({...y,[_]:u==="number"?parseInt(v,10):v}))},d=p=>{const _=p.target.value,v=_.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"");s(u=>({...u,name:_,slug:v}))},f=async p=>{p.preventDefault(),l(null),i(!0);try{const _=await $v(n);t(_)}catch(_){l(_ instanceof Error?_.message:"Failed to create tenant")}finally{i(!1)}},h=p=>{p.target===p.currentTarget&&e()};return a.jsx("div",{className:q.overlay,onClick:h,children:a.jsxs("div",{className:q.modal,children:[a.jsxs("div",{className:q.header,children:[a.jsx("h2",{className:q.title,children:"Create Tenant"}),a.jsx("button",{className:q.closeBtn,onClick:e,children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsxs("form",{onSubmit:f,children:[a.jsx("div",{className:q.body,children:a.jsxs("div",{className:q.form,children:[a.jsxs("div",{className:q.formGroup,children:[a.jsx("label",{className:q.label,children:"Tenant Name *"}),a.jsx("input",{type:"text",name:"name",className:q.input,value:n.name,onChange:d,placeholder:"Acme Corporation",required:!0,disabled:r})]}),a.jsxs("div",{className:q.formGroup,children:[a.jsx("label",{className:q.label,children:"URL Slug *"}),a.jsx("input",{type:"text",name:"slug",className:q.input,value:n.slug,onChange:c,placeholder:"acme-corp",pattern:"[a-z0-9-]+",required:!0,disabled:r}),a.jsxs("small",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:["Access URL: /t/",n.slug||"slug","/"]})]}),a.jsxs("div",{className:q.formGroup,children:[a.jsx("label",{className:q.label,children:"Company Name"}),a.jsx("input",{type:"text",name:"company_name",className:q.input,value:n.company_name,onChange:c,placeholder:"Acme Corporation Inc.",disabled:r})]}),a.jsxs("div",{className:q.formGroup,children:[a.jsx("label",{className:q.label,children:"Admin Email *"}),a.jsx("input",{type:"email",name:"admin_email",className:q.input,value:n.admin_email,onChange:c,placeholder:"admin@acme.com",required:!0,disabled:r})]}),a.jsxs("div",{className:q.formRow,children:[a.jsxs("div",{className:q.formGroup,children:[a.jsx("label",{className:q.label,children:"Plan"}),a.jsxs("select",{name:"plan",className:q.select,value:n.plan,onChange:c,disabled:r,children:[a.jsx("option",{value:"trial",children:"Trial"}),a.jsx("option",{value:"standard",children:"Standard"}),a.jsx("option",{value:"professional",children:"Professional"}),a.jsx("option",{value:"enterprise",children:"Enterprise"})]})]}),a.jsxs("div",{className:q.formGroup,children:[a.jsx("label",{className:q.label,children:"Max Users"}),a.jsx("input",{type:"number",name:"max_users",className:q.input,value:n.max_users,onChange:c,min:"1",disabled:r})]})]}),a.jsxs("div",{className:q.formGroup,children:[a.jsx("label",{className:q.label,children:"Max Projects"}),a.jsx("input",{type:"number",name:"max_projects",className:q.input,value:n.max_projects,onChange:c,min:"1",disabled:r})]}),o&&a.jsx("div",{className:q.error,children:o})]})}),a.jsxs("div",{className:q.footer,children:[a.jsx("button",{type:"button",className:`${q.btn} ${q.btnSecondary}`,onClick:e,disabled:r,children:"Cancel"}),a.jsx("button",{type:"submit",className:`${q.btn} ${q.btnPrimary}`,disabled:r,children:r?"Creating...":"Create Tenant"})]})]})]})})}function OA({onClose:e,onCreated:t}){const[n,s]=g.useState({email:"",password:"",name:"",role:"admin"}),[r,i]=g.useState(!1),[o,l]=g.useState(null),c=h=>{const{name:p,value:_}=h.target;s(v=>({...v,[p]:_}))},d=async h=>{h.preventDefault(),l(null),i(!0);try{await Rv(n),t()}catch(p){l(p instanceof Error?p.message:"Failed to create admin user")}finally{i(!1)}},f=h=>{h.target===h.currentTarget&&e()};return a.jsx("div",{className:q.overlay,onClick:f,children:a.jsxs("div",{className:q.modal,children:[a.jsxs("div",{className:q.header,children:[a.jsx("h2",{className:q.title,children:"Create Admin User"}),a.jsx("button",{className:q.closeBtn,onClick:e,children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsxs("form",{onSubmit:d,children:[a.jsx("div",{className:q.body,children:a.jsxs("div",{className:q.form,children:[a.jsxs("div",{className:q.formGroup,children:[a.jsx("label",{className:q.label,children:"Email *"}),a.jsx("input",{type:"email",name:"email",className:q.input,value:n.email,onChange:c,placeholder:"admin@example.com",required:!0,disabled:r})]}),a.jsxs("div",{className:q.formGroup,children:[a.jsx("label",{className:q.label,children:"Password *"}),a.jsx("input",{type:"password",name:"password",className:q.input,value:n.password,onChange:c,placeholder:"",minLength:8,required:!0,disabled:r})]}),a.jsxs("div",{className:q.formGroup,children:[a.jsx("label",{className:q.label,children:"Name *"}),a.jsx("input",{type:"text",name:"name",className:q.input,value:n.name,onChange:c,placeholder:"John Doe",required:!0,disabled:r})]}),a.jsxs("div",{className:q.formGroup,children:[a.jsx("label",{className:q.label,children:"Role"}),a.jsxs("select",{name:"role",className:q.select,value:n.role,onChange:c,disabled:r,children:[a.jsx("option",{value:"admin",children:"Admin"}),a.jsx("option",{value:"superadmin",children:"Superadmin"})]})]}),o&&a.jsx("div",{className:q.error,children:o})]})}),a.jsxs("div",{className:q.footer,children:[a.jsx("button",{type:"button",className:`${q.btn} ${q.btnSecondary}`,onClick:e,disabled:r,children:"Cancel"}),a.jsx("button",{type:"submit",className:`${q.btn} ${q.btnPrimary}`,disabled:r,children:r?"Creating...":"Create Admin"})]})]})]})})}function HA({tenantId:e,onClose:t}){const[n,s]=g.useState(null),[r,i]=g.useState([]),[o,l]=g.useState(!0),[c,d]=g.useState(null);g.useEffect(()=>{f()},[e]);const f=async()=>{l(!0),d(null);try{const[u,y]=await Promise.all([Dv(e),Iv(e,10)]);s(u),i(y)}catch(u){d(u instanceof Error?u.message:"Failed to load tenant details")}finally{l(!1)}},h=u=>{u.target===u.currentTarget&&t()},p=u=>{const y={active:q.badgeSuccess,pending:q.badgeWarning,suspended:q.badgeDanger,archived:q.badgeInfo};return a.jsx("span",{className:`${q.badge} ${y[u]||""}`,children:u})},_=u=>u?u.accessible?a.jsx("span",{className:`${q.badge} ${q.badgeSuccess}`,children:"Connected"}):u.exists?a.jsx("span",{className:`${q.badge} ${q.badgeWarning}`,children:"Exists"}):a.jsx("span",{className:`${q.badge} ${q.badgeDanger}`,children:"Not provisioned"}):a.jsx("span",{className:q.badge,children:"Unknown"}),v=u=>new Date(u).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return a.jsx("div",{className:q.overlay,onClick:h,children:a.jsxs("div",{className:`${q.modal} ${q.wide}`,children:[a.jsxs("div",{className:q.header,children:[a.jsx("h2",{className:q.title,children:"Tenant Details"}),a.jsx("button",{className:q.closeBtn,onClick:t,children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsx("div",{className:q.body,children:o?a.jsx("div",{style:{textAlign:"center",padding:"2rem",color:"var(--text-muted)"},children:"Loading..."}):c?a.jsx("div",{className:q.error,children:c}):n?a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{marginBottom:"1.5rem"},children:[a.jsx("h3",{style:{margin:0,color:"var(--text-primary)"},children:n.name}),n.company_name&&a.jsx("p",{style:{margin:"0.25rem 0 0",color:"var(--text-muted)"},children:n.company_name})]}),a.jsxs("div",{className:q.infoGrid,children:[a.jsxs("div",{className:q.infoRow,children:[a.jsx("span",{className:q.infoLabel,children:"Slug"}),a.jsx("code",{className:q.infoValue,children:n.slug})]}),a.jsxs("div",{className:q.infoRow,children:[a.jsx("span",{className:q.infoLabel,children:"Status"}),a.jsx("span",{className:q.infoValue,children:p(n.status)})]}),a.jsxs("div",{className:q.infoRow,children:[a.jsx("span",{className:q.infoLabel,children:"Database"}),a.jsx("span",{className:q.infoValue,children:_(n.database_status)})]}),a.jsxs("div",{className:q.infoRow,children:[a.jsx("span",{className:q.infoLabel,children:"DB Name"}),a.jsx("code",{className:q.infoValue,children:n.database_name})]}),a.jsxs("div",{className:q.infoRow,children:[a.jsx("span",{className:q.infoLabel,children:"DB User"}),a.jsx("code",{className:q.infoValue,children:n.database_user})]}),a.jsxs("div",{className:q.infoRow,children:[a.jsx("span",{className:q.infoLabel,children:"Admin Email"}),a.jsx("span",{className:q.infoValue,children:n.admin_email})]}),a.jsxs("div",{className:q.infoRow,children:[a.jsx("span",{className:q.infoLabel,children:"Plan"}),a.jsx("span",{className:q.infoValue,children:n.plan})]}),a.jsxs("div",{className:q.infoRow,children:[a.jsx("span",{className:q.infoLabel,children:"Max Users"}),a.jsx("span",{className:q.infoValue,children:n.max_users})]}),a.jsxs("div",{className:q.infoRow,children:[a.jsx("span",{className:q.infoLabel,children:"Max Projects"}),a.jsx("span",{className:q.infoValue,children:n.max_projects})]}),a.jsxs("div",{className:q.infoRow,children:[a.jsx("span",{className:q.infoLabel,children:"Created"}),a.jsx("span",{className:q.infoValue,children:v(n.created_at)})]})]}),a.jsx("h4",{className:q.sectionTitle,children:"Access URL"}),a.jsxs("div",{className:q.codeBlock,children:[window.location.origin,"/t/",n.slug,"/"]}),r.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("h4",{className:q.sectionTitle,children:"Recent Activity"}),a.jsx("div",{className:q.auditLog,children:r.map(u=>a.jsxs("div",{className:q.auditEntry,children:[a.jsx("span",{className:q.auditAction,children:u.action}),a.jsxs("span",{className:q.auditMeta,children:[v(u.created_at),u.actor&&` by ${u.actor}`]})]},u.id))})]})]}):null}),a.jsx("div",{className:q.footer,children:a.jsx("button",{className:`${q.btn} ${q.btnSecondary}`,onClick:t,children:"Close"})})]})})}function qA({title:e,email:t,password:n,onClose:s}){const[r,i]=g.useState(!1),o=async()=>{const c=`Email: ${t}
Password: ${n}`;try{await navigator.clipboard.writeText(c),i(!0),setTimeout(()=>i(!1),2e3)}catch(d){console.error("Failed to copy:",d)}},l=c=>{c.target===c.currentTarget&&s()};return a.jsx("div",{className:q.overlay,onClick:l,children:a.jsxs("div",{className:q.modal,children:[a.jsxs("div",{className:q.header,children:[a.jsx("h2",{className:q.title,children:e}),a.jsx("button",{className:q.closeBtn,onClick:s,children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsxs("div",{className:q.body,children:[a.jsx("p",{style:{marginBottom:"1.5rem",color:"var(--text-secondary)"},children:"Please save these credentials securely. The password will not be shown again."}),a.jsxs("div",{className:q.form,children:[a.jsxs("div",{className:q.formGroup,children:[a.jsx("label",{className:q.label,children:"Email"}),a.jsx("div",{className:q.credentialsField,children:a.jsx("input",{type:"text",className:q.credentialsInput,value:t,readOnly:!0})})]}),a.jsxs("div",{className:q.formGroup,children:[a.jsx("label",{className:q.label,children:"Password"}),a.jsx("div",{className:q.credentialsField,children:a.jsx("input",{type:"text",className:q.credentialsInput,value:n,readOnly:!0})})]})]})]}),a.jsxs("div",{className:q.footer,children:[a.jsx("button",{className:`${q.btn} ${q.btnSecondary}`,onClick:s,children:"Close"}),a.jsx("button",{className:`${q.btn} ${q.btnPrimary}`,onClick:o,children:r?"Copied!":"Copy Credentials"})]})]})})}const zA="_container_1by4n_3",WA="_header_1by4n_12",UA="_headerLeft_1by4n_21",VA="_logo_1by4n_27",GA="_title_1by4n_32",QA="_headerRight_1by4n_39",YA="_userInfo_1by4n_45",XA="_roleBadge_1by4n_53",KA="_logoutBtn_1by4n_63",ZA="_tabs_1by4n_81",JA="_tab_1by4n_81",e6="_active_1by4n_109",t6="_main_1by4n_119",it={container:zA,header:WA,headerLeft:UA,logo:VA,title:GA,headerRight:QA,userInfo:YA,roleBadge:XA,logoutBtn:KA,tabs:ZA,tab:JA,active:e6,main:t6};function n6(){const e=ze(j=>j.adminUser),t=ze(j=>j.activeTab),n=ze(j=>j.setActiveTab),s=ze(j=>j.setTenants),r=ze(j=>j.setSystemStats),i=ze(j=>j.setAdminUsers),o=ze(j=>j.setIsAuthenticated),l=ze(j=>j.setAdminUser),c=ze(j=>j.reset),[d,f]=g.useState(()=>oa()),[h,p]=g.useState(!1),[_,v]=g.useState(!1),[u,y]=g.useState(null),[m,x]=g.useState(null);g.useEffect(()=>{const j=new MutationObserver(()=>{const $=document.documentElement.dataset.theme;$&&$!==d&&f($)});return j.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>j.disconnect()},[d]),g.useEffect(()=>{w(),b()},[]),g.useEffect(()=>{t==="admins"&&S()},[t]);const w=async()=>{try{const j=await Cv();s(j)}catch(j){console.error("Failed to load tenants:",j)}},b=async()=>{try{const j=await Lv();r(j)}catch(j){console.error("Failed to load stats:",j)}},S=async()=>{try{const j=await Av();i(j)}catch(j){console.error("Failed to load admin users:",j)}},N=async()=>{try{await Nv()}catch(j){console.error("Logout error:",j)}finally{c(),o(!1),l(null)}},D=(j,$,P)=>{x({title:j,email:$,password:P})},L=d==="dark"?"/img/milestone_logo_dark_theme.svg":"/img/milestone_logo_light_theme.svg",T=(e==null?void 0:e.role)==="superadmin";return a.jsxs("div",{className:it.container,children:[a.jsxs("header",{className:it.header,children:[a.jsxs("div",{className:it.headerLeft,children:[a.jsx("img",{src:L,alt:"Milestone",className:it.logo}),a.jsx("h1",{className:it.title,children:"Admin Portal"})]}),a.jsxs("div",{className:it.headerRight,children:[a.jsxs("span",{className:it.userInfo,children:[e==null?void 0:e.email,(e==null?void 0:e.role)==="superadmin"&&a.jsx("span",{className:it.roleBadge,children:"Superadmin"})]}),a.jsx("button",{className:it.logoutBtn,onClick:N,children:"Logout"})]})]}),a.jsxs("nav",{className:it.tabs,children:[a.jsxs("button",{className:`${it.tab} ${t==="tenants"?it.active:""}`,onClick:()=>n("tenants"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]}),"Tenants"]}),T&&a.jsxs("button",{className:`${it.tab} ${t==="admins"?it.active:""}`,onClick:()=>n("admins"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"9",cy:"7",r:"4"}),a.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),a.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),"Admin Users"]}),a.jsxs("button",{className:`${it.tab} ${t==="stats"?it.active:""}`,onClick:()=>n("stats"),children:[a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"18",y1:"20",x2:"18",y2:"10"}),a.jsx("line",{x1:"12",y1:"20",x2:"12",y2:"4"}),a.jsx("line",{x1:"6",y1:"20",x2:"6",y2:"14"})]}),"System Stats"]})]}),a.jsxs("main",{className:it.main,children:[t==="tenants"&&a.jsx(FL,{onCreateNew:()=>p(!0),onViewDetails:j=>y(j),onShowCredentials:D,onRefresh:w}),t==="admins"&&T&&a.jsx(OL,{onCreateNew:()=>v(!0),onRefresh:S}),t==="stats"&&a.jsx(sA,{onRefresh:b})]}),h&&a.jsx(FA,{onClose:()=>p(!1),onCreated:()=>{w(),p(!1)}}),_&&a.jsx(OA,{onClose:()=>v(!1),onCreated:()=>{S(),v(!1)}}),u&&a.jsx(HA,{tenantId:u,onClose:()=>y(null),onShowCredentials:D,onRefresh:w}),m&&a.jsx(qA,{title:m.title,email:m.email,password:m.password,onClose:()=>x(null)})]})}function s6(){const e=ze(i=>i.isAuthenticated),t=ze(i=>i.isLoading),n=ze(i=>i.setAdminUser),s=ze(i=>i.setIsAuthenticated),r=ze(i=>i.setIsLoading);return g.useEffect(()=>{(async()=>{try{const o=await bv();o.user&&(n(o.user),s(!0))}catch{console.log("Admin not authenticated")}finally{r(!1)}})()},[n,s,r]),t?a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",background:"var(--bg-primary)",color:"var(--text-muted)"},children:"Loading..."}):e?a.jsx(n6,{}):a.jsx(uL,{})}function a6(){const{isLoading:e,isAuthenticated:t}=Gp(),{loadAllData:n,isLoading:s}=Qp(),r=F(c=>c.whatIfMode),i=F(c=>c.instanceSettings),[o,l]=g.useState(!1);return g.useEffect(()=>{const c=window.location.pathname,d=c==="/admin"||c==="/admin/"||c.startsWith("/admin/");l(d)},[]),g.useEffect(()=>{t&&!o&&n()},[t,n,o]),g.useEffect(()=>{if(o)document.title="Milestone Admin";else{const c=(i==null?void 0:i.instance_title)||"Milestone";document.title=c}},[i,o]),g.useEffect(()=>(r?document.body.classList.add("what-if-mode"):document.body.classList.remove("what-if-mode"),()=>{document.body.classList.remove("what-if-mode")}),[r]),o?a.jsx(s6,{}):e?a.jsx(Ef,{}):t?s?a.jsx(Ef,{message:"Loading data..."}):a.jsxs(a.Fragment,{children:[a.jsx(K$,{}),a.jsx(oI,{}),a.jsx(XI,{})]}):a.jsx(lx,{})}Qv();Uv();Fp({isWhatIfMode:()=>F.getState().whatIfMode,queueWhatIfOperation:e=>F.getState().queueWhatIfOperation(e)});const r6=new b1({defaultOptions:{queries:{staleTime:1e3*60*5,gcTime:1e3*60*30,retry:1,refetchOnWindowFocus:!1},mutations:{retry:0}}});$p(document.getElementById("root")).render(a.jsx(g.StrictMode,{children:a.jsx(D1,{client:r6,children:a.jsx(a6,{})})}));
//# sourceMappingURL=index-DMGZ347g.js.map
